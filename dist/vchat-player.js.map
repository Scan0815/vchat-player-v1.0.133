{"version":3,"sources":["webpack://vchatPlayer/webpack/universalModuleDefinition","webpack://vchatPlayer/webpack/bootstrap","webpack://vchatPlayer/../node_modules/core-js/internals/global.js","webpack://vchatPlayer/../node_modules/core-js/internals/has.js","webpack://vchatPlayer/../node_modules/core-js/internals/descriptors.js","webpack://vchatPlayer/../node_modules/core-js/internals/fails.js","webpack://vchatPlayer/../node_modules/core-js/internals/is-object.js","webpack://vchatPlayer/../node_modules/core-js/internals/create-non-enumerable-property.js","webpack://vchatPlayer/../node_modules/core-js/internals/object-define-property.js","webpack://vchatPlayer/../node_modules/core-js/internals/an-object.js","webpack://vchatPlayer/external {\"commonjs\":\"vchat-core\",\"commonjs2\":\"vchat-core\",\"amd\":\"vchat-core\",\"umd\":\"vchat-core\",\"root\":\"vchat-core\"}","webpack://vchatPlayer/../node_modules/core-js/internals/well-known-symbol.js","webpack://vchatPlayer/./src/utils.ts","webpack://vchatPlayer/../node_modules/core-js/internals/to-indexed-object.js","webpack://vchatPlayer/../node_modules/core-js/internals/set-global.js","webpack://vchatPlayer/../node_modules/core-js/internals/shared-key.js","webpack://vchatPlayer/../node_modules/core-js/internals/uid.js","webpack://vchatPlayer/../node_modules/core-js/internals/hidden-keys.js","webpack://vchatPlayer/../node_modules/core-js/internals/array-includes.js","webpack://vchatPlayer/../node_modules/core-js/internals/enum-bug-keys.js","webpack://vchatPlayer/./src/camera-position.ts","webpack://vchatPlayer/./src/player.ts","webpack://vchatPlayer/../node_modules/webpack/buildin/global.js","webpack://vchatPlayer/../node_modules/core-js/internals/object-get-own-property-descriptor.js","webpack://vchatPlayer/../node_modules/core-js/internals/create-property-descriptor.js","webpack://vchatPlayer/../node_modules/core-js/internals/classof-raw.js","webpack://vchatPlayer/../node_modules/core-js/internals/require-object-coercible.js","webpack://vchatPlayer/../node_modules/core-js/internals/to-primitive.js","webpack://vchatPlayer/../node_modules/core-js/internals/ie8-dom-define.js","webpack://vchatPlayer/../node_modules/core-js/internals/document-create-element.js","webpack://vchatPlayer/../node_modules/core-js/internals/redefine.js","webpack://vchatPlayer/../node_modules/core-js/internals/inspect-source.js","webpack://vchatPlayer/../node_modules/core-js/internals/shared-store.js","webpack://vchatPlayer/../node_modules/core-js/internals/shared.js","webpack://vchatPlayer/../node_modules/core-js/internals/get-built-in.js","webpack://vchatPlayer/../node_modules/core-js/internals/object-keys-internal.js","webpack://vchatPlayer/../node_modules/core-js/internals/to-integer.js","webpack://vchatPlayer/../node_modules/core-js/internals/native-symbol.js","webpack://vchatPlayer/./src/errorlevel.ts","webpack://vchatPlayer/./src/version.ts","webpack://vchatPlayer/./src/vchat-player.ts","webpack://vchatPlayer/./src/polyfills/polyfills.ts","webpack://vchatPlayer/../node_modules/ts-polyfill/lib/es2016-array-include.js","webpack://vchatPlayer/../node_modules/core-js/es/array/includes.js","webpack://vchatPlayer/../node_modules/core-js/modules/es.array.includes.js","webpack://vchatPlayer/../node_modules/core-js/internals/export.js","webpack://vchatPlayer/../node_modules/core-js/internals/object-property-is-enumerable.js","webpack://vchatPlayer/../node_modules/core-js/internals/indexed-object.js","webpack://vchatPlayer/../node_modules/core-js/internals/internal-state.js","webpack://vchatPlayer/../node_modules/core-js/internals/native-weak-map.js","webpack://vchatPlayer/../node_modules/core-js/internals/is-pure.js","webpack://vchatPlayer/../node_modules/core-js/internals/copy-constructor-properties.js","webpack://vchatPlayer/../node_modules/core-js/internals/own-keys.js","webpack://vchatPlayer/../node_modules/core-js/internals/path.js","webpack://vchatPlayer/../node_modules/core-js/internals/object-get-own-property-names.js","webpack://vchatPlayer/../node_modules/core-js/internals/to-length.js","webpack://vchatPlayer/../node_modules/core-js/internals/to-absolute-index.js","webpack://vchatPlayer/../node_modules/core-js/internals/object-get-own-property-symbols.js","webpack://vchatPlayer/../node_modules/core-js/internals/is-forced.js","webpack://vchatPlayer/../node_modules/core-js/internals/add-to-unscopables.js","webpack://vchatPlayer/../node_modules/core-js/internals/use-symbol-as-uid.js","webpack://vchatPlayer/../node_modules/core-js/internals/object-create.js","webpack://vchatPlayer/../node_modules/core-js/internals/object-define-properties.js","webpack://vchatPlayer/../node_modules/core-js/internals/object-keys.js","webpack://vchatPlayer/../node_modules/core-js/internals/html.js","webpack://vchatPlayer/../node_modules/core-js/internals/array-method-uses-to-length.js","webpack://vchatPlayer/../node_modules/core-js/internals/entry-unbind.js","webpack://vchatPlayer/../node_modules/core-js/internals/function-bind-context.js","webpack://vchatPlayer/../node_modules/core-js/internals/a-function.js","webpack://vchatPlayer/../node_modules/core-js/es/typed-array/includes.js","webpack://vchatPlayer/../node_modules/core-js/modules/es.typed-array.includes.js","webpack://vchatPlayer/../node_modules/core-js/internals/array-buffer-view-core.js","webpack://vchatPlayer/../node_modules/core-js/internals/array-buffer-native.js","webpack://vchatPlayer/../node_modules/core-js/internals/classof.js","webpack://vchatPlayer/../node_modules/core-js/internals/to-string-tag-support.js","webpack://vchatPlayer/../node_modules/core-js/internals/object-get-prototype-of.js","webpack://vchatPlayer/../node_modules/core-js/internals/to-object.js","webpack://vchatPlayer/../node_modules/core-js/internals/correct-prototype-getter.js","webpack://vchatPlayer/../node_modules/core-js/internals/object-set-prototype-of.js","webpack://vchatPlayer/../node_modules/core-js/internals/a-possible-prototype.js","webpack://vchatPlayer/./src/polyfills/append.ts","webpack://vchatPlayer/./src/polyfills/remove.ts","webpack://vchatPlayer/./src/polyfills/to-blob.ts","webpack://vchatPlayer/./src/players/dummy-player.ts","webpack://vchatPlayer/./src/players/hlsjs/hlsjs-player.ts","webpack://vchatPlayer/external {\"commonjs\":\"platform\",\"commonjs2\":\"platform\",\"amd\":\"platform\",\"root\":\"platform\"}","webpack://vchatPlayer/./src/video-element-frame-provider.ts","webpack://vchatPlayer/external {\"commonjs\":\"hls.js\",\"commonjs2\":\"hls.js\",\"amd\":\"hls.js\",\"root\":\"hls.js\"}","webpack://vchatPlayer/./src/players/hls-player.ts","webpack://vchatPlayer/./src/players/jpeg-player.ts","webpack://vchatPlayer/./src/player-factory-loader.ts","webpack://vchatPlayer/./src/players/rtmp/rtmp-player-factory.ts","webpack://vchatPlayer/./src/players/rtmp/rtmp-player.ts","webpack://vchatPlayer/./src/players/webrtc/webrtc-player-factory.ts","webpack://vchatPlayer/./src/players/webrtc/webrtc-player.ts","webpack://vchatPlayer/../node_modules/detectrtc/DetectRTC.js","webpack://vchatPlayer/../node_modules/process/browser.js"],"names":["root","factory","exports","module","require","define","amd","window","__WEBPACK_EXTERNAL_MODULE__8__","__WEBPACK_EXTERNAL_MODULE__83__","__WEBPACK_EXTERNAL_MODULE__85__","installedModules","__webpack_require__","moduleId","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","it","Math","check","globalThis","self","global","Function","fails","exec","error","DESCRIPTORS","definePropertyModule","createPropertyDescriptor","f","IE8_DOM_DEFINE","anObject","toPrimitive","nativeDefineProperty","O","P","Attributes","TypeError","isObject","String","shared","has","uid","NATIVE_SYMBOL","USE_SYMBOL_AS_UID","WellKnownSymbolsStore","createWellKnownSymbol","withoutSetter","BrowserName","ALL","CHROME","FIREFOX","SAFARI","BrowserOS","ANDROID","IOS","tagName","style","el","document","createElement","version","os","versionTo","toLowerCase","platformName","platformOS","platform","length","slice","family","isOS","isName","isVersion","parseInt","isVersionTo","IndexedObject","requireObjectCoercible","createNonEnumerableProperty","keys","id","postfix","random","undefined","toString","toIndexedObject","toLength","toAbsoluteIndex","createMethod","IS_INCLUDES","$this","fromIndex","index","includes","indexOf","CameraPosition","PlayerEvent","Error","Init","Load","Pause","Play","Playing","QualityChange","Reload","Waiting","PlayModes","PROMISE_PLAY_BUTTON","PROMISE_PLAY_MUTED","PROMISE_PLAY_UNMUTED","AUTO_PLAY_BUTTON","AUTO_PLAY_MUTED","AUTO_PLAY_UNMUTED","defaultConstraints","audio","video","facingMode","width","height","dummy","invalidateCallbacks","cb","config","_playing","_publishing","_volume","_queue","_player","_factory","_failedFact","_factoryQueue","_allowRearrange","handler","position","container","append","this","_container","_video","_playerContainer","_camContainer","backgroundColor","display","_handler","_factoryMap","_defOrder","factories","forEach","format","push","splice","preferExistingPlayer","logger","log","volume","onVolumeChange","initPlayer","formats","filter","filtered","fact","_createFactoryQueue","_createPlayer","_format","play","sourceSet","_sourceSet","preferredOrder","stop","publish","targetSet","_targetSet","canPublish","jpeg","jpegTarget","_camStream","_camPublisher","_createCamPublisher","stream","fps","onPublishStart","unpublish","onPublishStop","hasCamera","navigator","mediaDevices","enumerateDevices","some","kind","startCamera","_camConfig","_camVideo","_updateCameraPosition","_updateCameraSize","onCameraOn","_getUserMedia","mediaStream","_createCamVideo","startsWith","onCameraDenied","onCameraOff","stopCamera","getVideoTracks","track","removeChild","srcObject","src","removeEventListener","min","max","setVolume","playNext","_destroyPlayer","destroy","parent","parentNode","handleEvent","event","type","map","factoryQueueEntry","shift","Promise","resolve","isSupported","onPlayerSwitch","callbacks","_createCallbacks","created","stillValid","_installPlayer","warn","constraints","getUserMedia","reject","e","player","playerElement","onPlayerSwitchComplete","_callbacks","onSendMetrics","onError","info","metrics","playerEvent","playerFormat","playerType","connection","networkInfo","onPlayStart","source","onPlayStop","onPlayInfo","onPlayError","level","remove","border","muted","autoplay","setAttribute","URL","createObjectURL","onloadedmetadata","videoWidth","addEventListener","prop","removeProperty","FullScreen","top","left","BottomRight","bottom","margin","right","BottomLeft","TopRight","TopLeft","computeCam2CamVideoSize","camConfig","aspectRation","w","h","cw","clientWidth","ch","clientHeight","round","wRatio","widthRatio","hRatio","heightRatio","floor","videoHeight","jpegUploadSettings","quality","provider","VideoElementFrameProvider","PicUpStream","VERSION","Player","g","propertyIsEnumerableModule","nativeGetOwnPropertyDescriptor","getOwnPropertyDescriptor","bitmap","configurable","writable","input","PREFERRED_STRING","fn","val","valueOf","a","EXISTS","setGlobal","inspectSource","InternalStateModule","getInternalState","enforceInternalState","enforce","TEMPLATE","split","options","unsafe","simple","noTargetGet","join","store","functionToString","IS_PURE","copyright","path","aFunction","variable","namespace","method","arguments","hiddenKeys","names","result","ceil","argument","isNaN","getOwnPropertySymbols","ErrorLevel","DummyPlayerFactory","HlsJsPlayerFactory","HlsPlayerFactory","JpegPlayerFactory","PlayerFactoryLoader","RtmpPlayerFactory","WebRTCPlayerFactory","entryUnbind","$","$includes","addToUnscopables","target","proto","forced","arrayMethodUsesToLength","ACCESSORS","1","redefine","copyConstructorProperties","isForced","targetProperty","sourceProperty","descriptor","TARGET","GLOBAL","STATIC","stat","sham","nativePropertyIsEnumerable","propertyIsEnumerable","NASHORN_BUG","V","classof","set","NATIVE_WEAK_MAP","objectHas","sharedKey","WeakMap","wmget","wmhas","wmset","metadata","STATE","getterFor","TYPE","state","test","ownKeys","getOwnPropertyDescriptorModule","getBuiltIn","getOwnPropertyNamesModule","getOwnPropertySymbolsModule","concat","internalObjectKeys","getOwnPropertyNames","toInteger","integer","replacement","feature","detection","data","normalize","POLYFILL","NATIVE","string","replace","wellKnownSymbol","UNSCOPABLES","ArrayPrototype","Array","iterator","activeXDocument","defineProperties","enumBugKeys","html","documentCreateElement","IE_PROTO","EmptyConstructor","scriptTag","content","LT","NullProtoObject","domain","ActiveXObject","iframeDocument","iframe","write","close","temp","parentWindow","NullProtoObjectViaActiveX","appendChild","contentWindow","open","F","Properties","objectKeys","cache","thrower","METHOD_NAME","argument0","argument1","CONSTRUCTOR","METHOD","that","b","apply","ArrayBufferViewCore","aTypedArray","exportTypedArrayMethod","searchElement","NAME","NATIVE_ARRAY_BUFFER","getPrototypeOf","setPrototypeOf","Int8Array","Int8ArrayPrototype","Uint8ClampedArray","Uint8ClampedArrayPrototype","TypedArray","TypedArrayPrototype","ObjectPrototype","isPrototypeOf","TO_STRING_TAG","TYPED_ARRAY_TAG","NATIVE_ARRAY_BUFFER_VIEWS","opera","TYPED_ARRAY_TAG_REQIRED","TypedArrayConstructorsList","Uint8Array","Int16Array","Uint16Array","Int32Array","Uint32Array","Float32Array","Float64Array","isTypedArray","aTypedArrayConstructor","C","ARRAY","TypedArrayConstructor","KEY","exportTypedArrayStaticMethod","isView","klass","ArrayBuffer","DataView","TO_STRING_TAG_SUPPORT","classofRaw","CORRECT_ARGUMENTS","tag","tryGet","callee","toObject","CORRECT_PROTOTYPE_GETTER","constructor","aPossiblePrototype","setter","CORRECT_SETTER","__proto__","Element","Document","DocumentFragment","item","argArr","args","docFrag","createDocumentFragment","argItem","isNode","Node","createTextNode","CharacterData","DocumentType","HTMLCanvasElement","callback","setTimeout","binStr","atob","toDataURL","len","arr","charCodeAt","Blob","logName","supported","cont","sources","raiseErrorAfter","message","charAt","optionalParams","defaultQualityBoundaries","low","medium","good","Hls","isBrowserVersion","supportsPlayPromise","dummyVideo","promise","catch","playMode","crossOrigin","controls","poster","hlsConfig","debug","maxBufferLength","maxMaxBufferLength","capLevelToPlayerSize","canvas","useCanvasPoster","currentSource","currentVideoWidth","hls","hlsIsLoading","streamPaused","hlsAbortErrorRetry","playTriggeredByUserInteraction","playerVolume","canvasHideInterval","autoPlayTimeout","waitingTimeout","sendPlayInfo","paused","videoResolutionChange","newQuality","boundaries","qualityBoundaries","setQuality","initHlsJs","attachMedia","on","Events","LEVEL_SWITCHED","LEVEL_LOADED","ERROR","errorData","fatal","details","Info","ErrorDetails","FRAG_LOAD_ERROR","ErrorTypes","NETWORK_ERROR","startLoad","MEDIA_ERROR","recoverMediaError","loadSource","onCanPlay","logPlay","errorCode","errorMessage","errorExt","code","MediaError","MEDIA_ERR_DECODE","MEDIA_ERR_NETWORK","resumePlay","onPause","stopLoad","userInteractionCallback","resumeByButton","onPlaying","clearTimeout","clearInterval","setInterval","canvasHide","onTimeUpdate","canvasUpdate","onWaiting","onWindowResize","requestAnimationFrame","canvasUpdateDo","readyState","getContext","drawImage","videoData","playerInfo","success","videoElement","errorMsg","playLogger","mute","button","then","playByButton","cancelable","preventDefault","stopPropagation","pause","removeAttribute","errorCallback","_canvas","_errorCallback","_videoElement","_jpegUploadSettings","videoTrackSettings","getSettings","aspectRatio","getSnapshot","res","toBlob","isPlaying","isStopped","lastTimeUpdate","preFirstFrameCounter","controlsShown","onEnded","onHeartBeat","recoverTimeout","performance","now","fromButton","reload","load","heartBeatInterval","NOT_ALLOWED_ERROR","removeSources","srcElement","preload","reloadCallback","children","audioElement","supports","canPlayType","canAudio","withAudio","noAudio","dataEventSend","picStream","PicStream","image","naturalWidth","naturalHeight","dw","dh","offsetX","offsetY","sourceType","mp3","vorbis","firstChild","playPromise","initCallback","loader","mver","flashInfo","major","swfFails","minor","devicePixelRatio","onPreInit","useUpstream","RtmpPlayer","swfPath","timeout","onInit","flashInfoData","param","updateFails","cookie","Date","ua","userAgent","oldIEMode","appName","pluginMode","plugins","flash","v","description","win","mac","ax","GetVariable","cameraState","publishState","queue","querySelector","findUniqueName","initTimeout","entry","onFail","onLog","unshift","cmd","onConnect","onPlay","onStop","onPublish","onUnpublish","onVideoSize","onCameraStatus","flashvars","swf","wmode","params","allowfullscreen","allowscriptaccess","bgcolor","browserzoom","obj","classid","buildFlashObject","rtmp","eorq","_resolve","app","getVolume","isWebRTCSupported","browser","console","WebRTCPlayer","webRtcSource","webrtc","_openSignalingConnection","_closeDataConnection","_closeSignalingConnection","_socket","_openDataConnection","peerConnection","RTCPeerConnection","iceServers","urls","ontrack","_attachStreamToVideo","onconnectionstatechange","_peerConnectionStateChanged","onicecandidate","_iceCandidate","_peerConnection","streams","_ev","ev","candidate","_sendWebRtcIceCandidate","_sendWebRtcNoMoreCandidates","_dispatchCommand","ice_candidate","ice_candidate_sdpMLineIndex","sdpMLineIndex","ice_candidate_sdpMid","sdpMid","_changeStreamQuality","substream","signalingUrl","socket","WebSocket","onopen","_onopen","onmessage","_onmessage","onerror","_onerror","onclose","_onclose","_requestChat","action","jsonData","JSON","stringify","send","parse","_handleWebRtcOffer","jsepSdp","sdp","setRemoteDescription","RTCSessionDescription","createAnswer","answer","setLocalDescription","answerForServer","localDescription","_sendWebRtcAnswer","jsepType","_event","browserFakeUserAgent","isNodejs","process","versions","node","location","protocol","href","hash","screen","webkitGetUserMedia","mozGetUserMedia","isMobileDevice","isEdge","msSaveOrOpenBlob","msSaveBlob","isOpera","isFirefox","InstallTrigger","isSafari","isChrome","chrome","isIE","documentMode","retry","isDone","next","currentTrial","isTimeout","isMobile","Android","match","BlackBerry","iOS","Opera","Windows","any","getOsName","osName","osVersion","osInfo","cs","nVer","appVersion","nAgt","clientStrings","detectDesktopOS","isCanvasSupportsStreamCapturing","isVideoSupportsStreamCapturing","regexIpv4Local","regexIpv4","regexIpv6","MediaDevices","audioInputDevices","audioOutputDevices","videoInputDevices","canEnumerate","MediaStreamTrack","hasMicrophone","hasSpeakers","hasWebcam","isWebsiteHasMicrophonePermissions","isWebsiteHasWebcamPermissions","checkDeviceSupport","getSources","alreadyUsedDevices","devices","_device","device","deviceId","label","isCustomLabel","DetectRTC","search","nameOffset","verOffset","ix","browserName","fullVersion","parseFloat","majorVersion","substring","lastIndexOf","toUpperCase","isPrivateBrowsing","getBrowserInfo","isPrivate","webkitRequestFileSystem","TEMPORARY","indexedDB","db","isIE10OrLater","localStorage","setItem","removeItem","detectPrivateMode","isORTCSupported","RTCIceGatherer","isScreenCapturingSupported","webAudio","isCreateMediaStreamSourceSupported","isAudioContextSupported","isRtpDataChannelsSupported","isSCTPSupportd","isSctpDataChannelsSupported","isGetUserMediaSupported","displayResolution","displayAspectRatio","gcd","toFixed","DetectLocalIPAddress","isPublic","isIpv4","getElementById","ipDuplicates","mozRTCPeerConnection","webkitRTCPeerConnection","peerConfig","optional","RtpDataChannels","pc","addStream","addTrack","getTracks","handleCandidate","ipAddress","createDataChannel","isPromisesSupported","createOffer","afterCreateOffer","line","getIPs","ip","isWebSocketsSupported","CLOSING","isWebSocketsBlocked","checkWebSocketsSupport","starttime","websocket","getTime","WebsocketLatency","isSetSinkIdSupported","isRTPSenderReplaceTracksSupported","isRemoteStreamProcessingSupported","isApplyConstraintsSupported","isMultiMonitorScreenCapturingSupported","MediaStream","webkitMediaStream","cachedSetTimeout","cachedClearTimeout","defaultSetTimout","defaultClearTimeout","runTimeout","fun","currentQueue","draining","queueIndex","cleanUpNextTick","drainQueue","run","marker","runClearTimeout","Item","array","noop","nextTick","title","env","argv","addListener","once","off","removeListener","removeAllListeners","emit","prependListener","prependOnceListener","listeners","binding","cwd","chdir","dir","umask"],"mappings":"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","file":"vchat-player.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory(require(\"vchat-core\"), require(\"platform\"), require(\"hls.js\"));\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([\"vchat-core\", \"platform\", \"hls.js\"], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"vchatPlayer\"] = factory(require(\"vchat-core\"), require(\"platform\"), require(\"hls.js\"));\n\telse\n\t\troot[\"vchatPlayer\"] = factory(root[\"vchat-core\"], root[\"platform\"], root[\"hls.js\"]);\n})(window, function(__WEBPACK_EXTERNAL_MODULE__8__, __WEBPACK_EXTERNAL_MODULE__83__, __WEBPACK_EXTERNAL_MODULE__85__) {\nreturn "," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 38);\n","var check = function (it) {\n  return it && it.Math == Math && it;\n};\n\n// https://github.com/zloirock/core-js/issues/86#issuecomment-115759028\nmodule.exports =\n  // eslint-disable-next-line no-undef\n  check(typeof globalThis == 'object' && globalThis) ||\n  check(typeof window == 'object' && window) ||\n  check(typeof self == 'object' && self) ||\n  check(typeof global == 'object' && global) ||\n  // eslint-disable-next-line no-new-func\n  Function('return this')();\n","var hasOwnProperty = {}.hasOwnProperty;\n\nmodule.exports = function (it, key) {\n  return hasOwnProperty.call(it, key);\n};\n","var fails = require('../internals/fails');\n\n// Thank's IE8 for his funny defineProperty\nmodule.exports = !fails(function () {\n  return Object.defineProperty({}, 1, { get: function () { return 7; } })[1] != 7;\n});\n","module.exports = function (exec) {\n  try {\n    return !!exec();\n  } catch (error) {\n    return true;\n  }\n};\n","module.exports = function (it) {\n  return typeof it === 'object' ? it !== null : typeof it === 'function';\n};\n","var DESCRIPTORS = require('../internals/descriptors');\nvar definePropertyModule = require('../internals/object-define-property');\nvar createPropertyDescriptor = require('../internals/create-property-descriptor');\n\nmodule.exports = DESCRIPTORS ? function (object, key, value) {\n  return definePropertyModule.f(object, key, createPropertyDescriptor(1, value));\n} : function (object, key, value) {\n  object[key] = value;\n  return object;\n};\n","var DESCRIPTORS = require('../internals/descriptors');\nvar IE8_DOM_DEFINE = require('../internals/ie8-dom-define');\nvar anObject = require('../internals/an-object');\nvar toPrimitive = require('../internals/to-primitive');\n\nvar nativeDefineProperty = Object.defineProperty;\n\n// `Object.defineProperty` method\n// https://tc39.github.io/ecma262/#sec-object.defineproperty\nexports.f = DESCRIPTORS ? nativeDefineProperty : function defineProperty(O, P, Attributes) {\n  anObject(O);\n  P = toPrimitive(P, true);\n  anObject(Attributes);\n  if (IE8_DOM_DEFINE) try {\n    return nativeDefineProperty(O, P, Attributes);\n  } catch (error) { /* empty */ }\n  if ('get' in Attributes || 'set' in Attributes) throw TypeError('Accessors not supported');\n  if ('value' in Attributes) O[P] = Attributes.value;\n  return O;\n};\n","var isObject = require('../internals/is-object');\n\nmodule.exports = function (it) {\n  if (!isObject(it)) {\n    throw TypeError(String(it) + ' is not an object');\n  } return it;\n};\n","module.exports = __WEBPACK_EXTERNAL_MODULE__8__;","var global = require('../internals/global');\nvar shared = require('../internals/shared');\nvar has = require('../internals/has');\nvar uid = require('../internals/uid');\nvar NATIVE_SYMBOL = require('../internals/native-symbol');\nvar USE_SYMBOL_AS_UID = require('../internals/use-symbol-as-uid');\n\nvar WellKnownSymbolsStore = shared('wks');\nvar Symbol = global.Symbol;\nvar createWellKnownSymbol = USE_SYMBOL_AS_UID ? Symbol : Symbol && Symbol.withoutSetter || uid;\n\nmodule.exports = function (name) {\n  if (!has(WellKnownSymbolsStore, name)) {\n    if (NATIVE_SYMBOL && has(Symbol, name)) WellKnownSymbolsStore[name] = Symbol[name];\n    else WellKnownSymbolsStore[name] = createWellKnownSymbol('Symbol.' + name);\n  } return WellKnownSymbolsStore[name];\n};\n","import * as platform from 'platform';\r\n\r\nexport const BrowserName = {\r\n    ALL: 'All',\r\n    CHROME: 'Chrome',\r\n    FIREFOX: 'Firefox',\r\n    SAFARI: 'Safari'\r\n};\r\n\r\nexport const BrowserOS = {\r\n    ANDROID: 'Android',\r\n    IOS: 'iOS'\r\n};\r\n\r\nexport function createElement<K extends keyof HTMLElementTagNameMap>(\r\n    tagName: K,\r\n    style?: CSSStyleDeclaration | object\r\n): HTMLElementTagNameMap[K] {\r\n    const el = document.createElement(tagName);\r\n    if (style) {\r\n        for (const n in style) {\r\n            el.style[n] = style[n];\r\n        }\r\n    }\r\n    return el;\r\n}\r\n\r\nexport function isBrowserVersion(\r\n    name: string,\r\n    version?: number,\r\n    os?: string | null,\r\n    versionTo?: number\r\n): boolean {\r\n    os = os || null;\r\n    version = version || 0;\r\n    versionTo = versionTo || 0;\r\n\r\n    if (os) {\r\n        os = os.toLowerCase();\r\n    }\r\n\r\n    if (name === BrowserName.ALL) {\r\n        name = null;\r\n    } else {\r\n        name = name.toLowerCase();\r\n    }\r\n\r\n    let platformName = null;\r\n    let platformOS = null;\r\n\r\n    // platform.name could be null (e.g. for T-Online Browser)\r\n    if (name && platform.name) {\r\n        platformName = platform.name.toLowerCase();\r\n\r\n        if (platformName.length > name.length) {\r\n            platformName = platformName.slice(0, name.length);\r\n        }\r\n    }\r\n\r\n    if (os && platform.os && platform.os.family) {\r\n        platformOS = platform.os.family.toLowerCase();\r\n\r\n        if (platformOS.length > os.length) {\r\n            platformOS = platformOS.slice(0, os.length);\r\n        }\r\n    }\r\n\r\n    const isOS = os === null || platformOS === os;\r\n    const isName = name === null || platformName === name;\r\n    const isVersion = parseInt(platform.version, 10) >= version;\r\n    const isVersionTo =\r\n        versionTo === 0 || parseInt(platform.version, 10) < versionTo;\r\n\r\n    return isOS && isName && isVersion && isVersionTo;\r\n}\r\n","// toObject with fallback for non-array-like ES3 strings\nvar IndexedObject = require('../internals/indexed-object');\nvar requireObjectCoercible = require('../internals/require-object-coercible');\n\nmodule.exports = function (it) {\n  return IndexedObject(requireObjectCoercible(it));\n};\n","var global = require('../internals/global');\nvar createNonEnumerableProperty = require('../internals/create-non-enumerable-property');\n\nmodule.exports = function (key, value) {\n  try {\n    createNonEnumerableProperty(global, key, value);\n  } catch (error) {\n    global[key] = value;\n  } return value;\n};\n","var shared = require('../internals/shared');\nvar uid = require('../internals/uid');\n\nvar keys = shared('keys');\n\nmodule.exports = function (key) {\n  return keys[key] || (keys[key] = uid(key));\n};\n","var id = 0;\nvar postfix = Math.random();\n\nmodule.exports = function (key) {\n  return 'Symbol(' + String(key === undefined ? '' : key) + ')_' + (++id + postfix).toString(36);\n};\n","module.exports = {};\n","var toIndexedObject = require('../internals/to-indexed-object');\nvar toLength = require('../internals/to-length');\nvar toAbsoluteIndex = require('../internals/to-absolute-index');\n\n// `Array.prototype.{ indexOf, includes }` methods implementation\nvar createMethod = function (IS_INCLUDES) {\n  return function ($this, el, fromIndex) {\n    var O = toIndexedObject($this);\n    var length = toLength(O.length);\n    var index = toAbsoluteIndex(fromIndex, length);\n    var value;\n    // Array#includes uses SameValueZero equality algorithm\n    // eslint-disable-next-line no-self-compare\n    if (IS_INCLUDES && el != el) while (length > index) {\n      value = O[index++];\n      // eslint-disable-next-line no-self-compare\n      if (value != value) return true;\n    // Array#indexOf ignores holes, Array#includes - not\n    } else for (;length > index; index++) {\n      if ((IS_INCLUDES || index in O) && O[index] === el) return IS_INCLUDES || index || 0;\n    } return !IS_INCLUDES && -1;\n  };\n};\n\nmodule.exports = {\n  // `Array.prototype.includes` method\n  // https://tc39.github.io/ecma262/#sec-array.prototype.includes\n  includes: createMethod(true),\n  // `Array.prototype.indexOf` method\n  // https://tc39.github.io/ecma262/#sec-array.prototype.indexof\n  indexOf: createMethod(false)\n};\n","// IE8- don't enum bug keys\nmodule.exports = [\n  'constructor',\n  'hasOwnProperty',\n  'isPrototypeOf',\n  'propertyIsEnumerable',\n  'toLocaleString',\n  'toString',\n  'valueOf'\n];\n","export enum CameraPosition {\r\n    TopLeft,\r\n    TopRight,\r\n    BottomLeft,\r\n    BottomRight,\r\n    FullScreen\r\n}\r\n","/*\r\n * Copyright (c) 2016-2017. campoint AG.\r\n * This file is licensed under the MIT License (https://opensource.org/licenses/MIT).\r\n */\r\n\r\nimport { logger, PicUpStream, SourceSet, TargetSet } from 'vchat-core';\r\n\r\nimport { JpegTarget } from 'vchat-core';\r\nimport { Callbacks } from './callbacks';\r\nimport { CameraConfig } from './camera-config';\r\nimport { CameraPosition } from './camera-position';\r\nimport { FactoryQueueEntry } from './factory-queue-entry';\r\nimport { IPlayer } from './iplayer';\r\nimport { JpegUploadSettings } from './jpeg-upload-settings';\r\n// import { MediaStreamFrameProvider } from './media-stream-frame-provider';\r\nimport { PlayerConfig } from './player-config';\r\nimport { PlayerFactory } from './player-factory';\r\nimport { PlayerHandler } from './player-handler';\r\nimport { createElement } from './utils';\r\nimport { VERSION } from './version';\r\nimport { VideoElementFrameProvider } from './video-element-frame-provider';\r\n\r\nexport const PlayerEvent = {\r\n    Error: 'error',\r\n    Init: 'init',\r\n    Load: 'load',\r\n    Pause: 'pause',\r\n    Play: 'play',\r\n    Playing: 'playing',\r\n    QualityChange: 'qualityChange',\r\n    Reload: 'reload',\r\n    Waiting: 'waiting'\r\n};\r\n\r\nexport const PlayModes = {\r\n    /** promise play via button; the browser supports the newer promise return value of the play() function; the promise did not execute properly - neither unmuted nor muted; hence the play() call was triggered via user interaction */\r\n    PROMISE_PLAY_BUTTON: 'uip',\r\n    /** muted promise play; the browser supports the newer promise return value of the play() function; the promise could be executed successfully but only with the video element being muted (autplay started muted) */\r\n    PROMISE_PLAY_MUTED: 'mpp',\r\n    /** unmuted promise play; the browser supports the newer promise return value of the play() function; the promise could be executed successfully without muting the element (autoplay started with sound) */\r\n    PROMISE_PLAY_UNMUTED: 'upp',\r\n    /** user interaction; the browser only supports the older standard; the video element does not start automatically - neither unmuted nor muted; the play() call was triggered via user interaction */\r\n    AUTO_PLAY_BUTTON: 'ui',\r\n    /** muted autoplay; the browser only supports the older standard; the video could only be started muted */\r\n    AUTO_PLAY_MUTED: 'map',\r\n    /** unmuted autoplay; the browser only supports the older standard; the video could be started automatically with sound */\r\n    AUTO_PLAY_UNMUTED: 'uap'\r\n};\r\n\r\nconst defaultConstraints = {\r\n    audio: false,\r\n    video: {\r\n        facingMode: 'user',\r\n        width: 1920, // iOS Safari does not support ideal setting\r\n        // tslint:disable-next-line: object-literal-sort-keys\r\n        height: 1080\r\n    }\r\n};\r\n\r\nconst dummy = (): void => {\r\n    /** noop */\r\n};\r\n\r\nfunction invalidateCallbacks(cb: Callbacks): void {\r\n    for (const n in cb) {\r\n        cb[n] = dummy;\r\n    }\r\n}\r\n\r\nexport class Player {\r\n    public static readonly VERSION = VERSION;\r\n\r\n    private _container: HTMLElement;\r\n    private _playerContainer: HTMLDivElement;\r\n    private _camContainer: HTMLDivElement;\r\n    private _camVideo: HTMLVideoElement;\r\n    private _camStream: MediaStream;\r\n    private _camConfig: CameraConfig;\r\n    private _camPublisher: PicUpStream;\r\n\r\n    private _playing = false;\r\n\r\n    private _publishing = false;\r\n\r\n    private _sourceSet: SourceSet;\r\n    private _targetSet: TargetSet;\r\n    private _volume = 1;\r\n\r\n    private _queue: string[] = [];\r\n    private _defOrder: string[];\r\n\r\n    private _player: IPlayer = null;\r\n    // The currently selected stream format.\r\n    private _format: string;\r\n    private _handler: PlayerHandler;\r\n    private _factory: PlayerFactory = null;\r\n    private _callbacks: Callbacks;\r\n\r\n    private _factoryMap: { [key: string]: PlayerFactory[] };\r\n    private _failedFact: PlayerFactory[] = [];\r\n    private _factoryQueue: FactoryQueueEntry[] = [];\r\n\r\n    private _video: HTMLVideoElement;\r\n    private _allowRearrange = false;\r\n\r\n    constructor(config: PlayerConfig) {\r\n        if (!config.handler) {\r\n            throw new Error('handler must not be undefined.');\r\n        }\r\n\r\n        const c: HTMLDivElement = createElement('div', {\r\n            width: '100%',\r\n            // tslint:disable-next-line: object-literal-sort-keys\r\n            height: '100%',\r\n            position: 'relative'\r\n        });\r\n\r\n        config.container.append(c);\r\n        this._container = c;\r\n        this._video = config.video;\r\n\r\n        this._playerContainer = createElement('div', {\r\n            width: '100%',\r\n            // tslint:disable-next-line: object-literal-sort-keys\r\n            height: '100%'\r\n        });\r\n        this._camContainer = createElement('div', {\r\n            backgroundColor: 'black',\r\n            display: 'none',\r\n            position: 'absolute'\r\n        });\r\n\r\n        c.append(this._playerContainer);\r\n        c.append(this._camContainer);\r\n\r\n        this._handler = config.handler;\r\n\r\n        this._factoryMap = {};\r\n        this._defOrder = [];\r\n        config.factories.forEach((factory) => {\r\n            const formats =\r\n                typeof factory.format === 'string'\r\n                    ? [factory.format]\r\n                    : factory.format;\r\n            formats.forEach((format) => {\r\n                if (this._factoryMap[format] === undefined) {\r\n                    this._factoryMap[format] = [];\r\n                }\r\n\r\n                this._factoryMap[format].push(factory);\r\n                const index = this._defOrder.indexOf(format);\r\n                if (index >= 0) {\r\n                    this._defOrder.splice(index, 1);\r\n                }\r\n                this._defOrder.push(format);\r\n            });\r\n        });\r\n\r\n        this._allowRearrange = config.preferExistingPlayer || false;\r\n        logger.log(\r\n            'Player.constructor complete',\r\n            this._defOrder,\r\n            this._factoryMap\r\n        );\r\n\r\n        if (config.video && config.video.volume !== this._volume) {\r\n            this._volume = config.video.volume;\r\n            this._handler.onVolumeChange(this._volume);\r\n        }\r\n    }\r\n\r\n    public async initPlayer(format: string | string[]): Promise<void> {\r\n        if (!this._player && this._queue.length === 0) {\r\n            const formats =\r\n                typeof format === 'string' ? [format] : format.slice();\r\n            this._queue = formats.filter((value) => {\r\n                let filtered = Object.prototype.hasOwnProperty.call(\r\n                    this._factoryMap,\r\n                    value\r\n                );\r\n\r\n                if (filtered) {\r\n                    filtered =\r\n                        this._factoryMap[value].filter(\r\n                            (fact) => !this._failedFact.includes(fact)\r\n                        ).length > 0;\r\n                }\r\n\r\n                return filtered;\r\n            });\r\n\r\n            this._createFactoryQueue();\r\n            await this._createPlayer();\r\n        }\r\n    }\r\n\r\n    get format(): string {\r\n        return this._format;\r\n    }\r\n\r\n    /**\r\n     * This function takes the source set and creates the best fitting player and starts playing the selected source.\r\n     *\r\n     * @param sourceSet - The sourceset describing all available streams. Usually retrieved using chat.startStream()\r\n     */\r\n    public async play(sourceSet: SourceSet): Promise<void> {\r\n        this._sourceSet = sourceSet;\r\n\r\n        if (sourceSet.preferredOrder && sourceSet.preferredOrder.length > 0) {\r\n            this._queue = sourceSet.preferredOrder.slice();\r\n        } else {\r\n            this._queue = this._defOrder.slice();\r\n        }\r\n\r\n        this._queue = this._queue.filter((value) => {\r\n            let filtered = Object.prototype.hasOwnProperty.call(\r\n                this._factoryMap,\r\n                value\r\n            );\r\n\r\n            if (filtered) {\r\n                filtered =\r\n                    this._factoryMap[value].filter(\r\n                        (fact) => !this._failedFact.includes(fact)\r\n                    ).length > 0;\r\n            }\r\n\r\n            return filtered && sourceSet[value] && sourceSet[value].length;\r\n        });\r\n\r\n        logger.log('Player.play', sourceSet, this._queue);\r\n\r\n        if (this._player && this._format) {\r\n            const index = this._queue.indexOf(this._format);\r\n            if (index === 0 || (this._allowRearrange && index > 0)) {\r\n                this._queue.splice(index, 1);\r\n                this._player.play(sourceSet, this._format);\r\n                return;\r\n            }\r\n        }\r\n\r\n        this._createFactoryQueue();\r\n        await this._createPlayer();\r\n    }\r\n\r\n    /**\r\n     * Stops (pauses) the player, e.g. to be used when the vhcat-core calls an onChatPause() or when a Live Preview ends. The player will only stop pulling the streams but won't be destroyed - hence the latest frame will still be shown.\r\n     */\r\n    public stop(): void {\r\n        if (this._player) {\r\n            this._player.stop();\r\n        }\r\n    }\r\n\r\n    /**  */\r\n    get playing(): boolean {\r\n        return this._playing;\r\n    }\r\n\r\n    /** Status of cam2cam */\r\n    get publishing(): boolean {\r\n        return this._publishing;\r\n    }\r\n\r\n    /**\r\n     * This function takes the targetSet and starts the actual upstream.\r\n     *\r\n     * @param targetSet - information where the stream can be published to, usually retrieved by calling chat.startUpstream()\r\n     *\r\n     * @returns true on success, else false\r\n     */\r\n    public publish(targetSet: TargetSet): boolean {\r\n        if (this._publishing === true) {\r\n            if (this._targetSet !== targetSet) {\r\n                throw new Error(\r\n                    'cannot publish when still publishing to a different target set. Unpublish first'\r\n                );\r\n            } else {\r\n                return true;\r\n            }\r\n        }\r\n\r\n        this._targetSet = targetSet;\r\n\r\n        if (this._player && this._player.publish && this._player.canPublish) {\r\n            this._player.publish(targetSet);\r\n        } else if (targetSet.jpeg && targetSet.jpeg.length > 0) {\r\n            const jpegTarget = targetSet.jpeg[0] as JpegTarget;\r\n            if (!this._camStream) {\r\n                throw new Error(\r\n                    'camera must be started first in order to publish the camera stream'\r\n                );\r\n            }\r\n\r\n            if (!this._camPublisher) {\r\n                this._camPublisher = this._createCamPublisher(jpegTarget);\r\n            }\r\n\r\n            this._camPublisher.publish(jpegTarget.stream, jpegTarget.fps);\r\n            this._publishing = true;\r\n            if (this._handler.onPublishStart) {\r\n                this._handler.onPublishStart();\r\n            }\r\n        } else {\r\n            return false;\r\n        }\r\n\r\n        return true;\r\n    }\r\n\r\n    /**\r\n     * Stops sending the frames taken from the browser's camera.\r\n     */\r\n    public unpublish(): void {\r\n        this._publishing = false;\r\n        this._targetSet = null;\r\n        if (this._camPublisher) {\r\n            this._camPublisher.stop();\r\n            this._camPublisher = null;\r\n            if (this._handler.onPublishStop) {\r\n                this._handler.onPublishStop();\r\n            }\r\n        }\r\n        if (this._player && this._player.unpublish && this._player.canPublish) {\r\n            this._player.unpublish();\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Determines whether the browser has access to a camera.\r\n     */\r\n    public async hasCamera(): Promise<true | false | undefined> {\r\n        if (this._player && this._player.hasCamera && this._player.canPublish) {\r\n            return await this._player.hasCamera();\r\n        } else if (\r\n            navigator.mediaDevices &&\r\n            navigator.mediaDevices.enumerateDevices\r\n        ) {\r\n            const devices = await navigator.mediaDevices.enumerateDevices();\r\n            return devices.some((d) => d.kind === 'videoinput');\r\n        } else {\r\n            return false;\r\n        }\r\n    }\r\n\r\n    /**\r\n     * This function starts the browser's camera and shows the cam 2 cam overlay. Based on this function call you can retrieve the targetSet via chat.startUpstream(). Once you received the targetSet you can start publishing via player.publish(targetSet).\r\n     * @param config - configuration params for the camera, see [CameraConfig] for more info.\r\n     */\r\n    public async startCamera(config?: CameraConfig): Promise<void> {\r\n        this._camConfig = config || {};\r\n        if (\r\n            this._player &&\r\n            this._player.startCamera &&\r\n            this._player.canPublish\r\n        ) {\r\n            this._player.startCamera(config);\r\n        } else {\r\n            if (this._camVideo) {\r\n                this._updateCameraPosition();\r\n                this._updateCameraSize();\r\n\r\n                if (this._handler.onCameraOn) {\r\n                    this._handler.onCameraOn();\r\n                }\r\n            } else {\r\n                try {\r\n                    const mediaStream = await this._getUserMedia(\r\n                        defaultConstraints\r\n                    );\r\n\r\n                    this._createCamVideo(mediaStream);\r\n                } catch (error) {\r\n                    if (\r\n                        error.name &&\r\n                        (error.name.startsWith('Permission') ||\r\n                            error.name === 'NotAllowedError')\r\n                    ) {\r\n                        if (this._handler.onCameraDenied) {\r\n                            this._handler.onCameraDenied();\r\n                        }\r\n                    } else {\r\n                        if (this._handler.onCameraOff) {\r\n                            this._handler.onCameraOff();\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Stops the use of the browser's camera.\r\n     */\r\n    public stopCamera(): void {\r\n        this._camConfig = null;\r\n        if (this._camVideo) {\r\n            // http://stackoverflow.com/questions/11642926/stop-close-webcam-which-is-opened-by-navigator-getusermedia\r\n            if (this._camStream) {\r\n                if (\r\n                    this._camStream.getVideoTracks &&\r\n                    this._camStream.getVideoTracks()\r\n                ) {\r\n                    this._camStream\r\n                        .getVideoTracks()\r\n                        .forEach((track) => track.stop());\r\n                } else if (this._camStream.stop) {\r\n                    this._camStream.stop();\r\n                }\r\n\r\n                this._camStream = null;\r\n            }\r\n\r\n            this._camContainer.style.display = 'none';\r\n            this._camContainer.removeChild(this._camVideo);\r\n\r\n            if (this._camVideo !== undefined) {\r\n                this._camVideo.srcObject = null;\r\n            } else {\r\n                this._camVideo.src = '';\r\n            }\r\n\r\n            this._camVideo = null;\r\n            if (this._handler.onCameraOff) {\r\n                this._handler.onCameraOff();\r\n            }\r\n        }\r\n        window.removeEventListener('resize', this);\r\n\r\n        if (\r\n            this._player &&\r\n            this._player.stopCamera &&\r\n            this._player.canPublish\r\n        ) {\r\n            this._player.stopCamera();\r\n        }\r\n    }\r\n\r\n    /** sets the volume of the player */\r\n    set volume(value: number) {\r\n        value = Math.min(Math.max(value, 0), 1);\r\n        if (this._player) {\r\n            this._player.setVolume(value);\r\n        }\r\n        if (this._volume !== value) {\r\n            this._volume = value;\r\n            if (this._handler.onVolumeChange) {\r\n                this._handler.onVolumeChange(value);\r\n            }\r\n        }\r\n    }\r\n\r\n    /** gets the volume of the player\r\n     *\r\n     * @returns The volume in the range [0.0, 1.0]\r\n     */\r\n    get volume(): number {\r\n        return this._volume;\r\n    }\r\n\r\n    /** Forces the player to switch to the next best player. */\r\n    public async playNext(): Promise<void> {\r\n        this._destroyPlayer();\r\n        await this._createPlayer();\r\n    }\r\n\r\n    /** Destroys the player.\r\n     * @returns HTML5 video element if set (HLS.js Player / HLS native Player only) for future use (on next player instantiation).\r\n     */\r\n    public destroy(): HTMLVideoElement {\r\n        logger.log('Player.destroy');\r\n        this.unpublish();\r\n        this.stopCamera();\r\n        this._destroyPlayer();\r\n\r\n        const parent = this._container.parentNode;\r\n        if (parent) {\r\n            parent.removeChild(this._container);\r\n        }\r\n\r\n        return this._video;\r\n    }\r\n\r\n    public handleEvent(event: Event): void {\r\n        if (event.type === 'resize') {\r\n            this._updateCameraSize();\r\n        }\r\n    }\r\n\r\n    private _createFactoryQueue(): void {\r\n        this._queue.map((format) => {\r\n            if (this._factoryMap[format] !== undefined) {\r\n                this._factoryMap[format].map((fact) => {\r\n                    this._factoryQueue.push({\r\n                        format,\r\n                        factory: fact\r\n                    } as FactoryQueueEntry);\r\n                });\r\n            }\r\n        });\r\n    }\r\n\r\n    private async _createPlayer(): Promise<void> {\r\n        let format: string = null;\r\n        let factoryQueueEntry = this._factoryQueue.shift();\r\n\r\n        while (factoryQueueEntry) {\r\n            format = factoryQueueEntry.format;\r\n\r\n            if (this._player) {\r\n                if (this._format === format) {\r\n                    return Promise.resolve();\r\n                } else {\r\n                    this._destroyPlayer();\r\n                }\r\n            }\r\n\r\n            const factory = factoryQueueEntry.factory;\r\n            this._factory = factory;\r\n\r\n            if (\r\n                factory &&\r\n                !this._failedFact.includes(factory) &&\r\n                factory.isSupported()\r\n            ) {\r\n                this._format = format;\r\n\r\n                if (this._handler.onPlayerSwitch) {\r\n                    this._handler.onPlayerSwitch(format);\r\n                }\r\n\r\n                try {\r\n                    const callbacks = this._createCallbacks(factory);\r\n                    const created = factory.create(callbacks, this._video);\r\n\r\n                    const stillValid = (): boolean =>\r\n                        this._factory === factory && this._format === format;\r\n\r\n                    try {\r\n                        const p = await created;\r\n\r\n                        if (stillValid()) {\r\n                            this._installPlayer(p);\r\n                            return Promise.resolve();\r\n                        } else {\r\n                            invalidateCallbacks(callbacks);\r\n                        }\r\n                    } catch (error) {\r\n                        logger.warn(\r\n                            'Player._createPlayer Promise.catch',\r\n                            error\r\n                        );\r\n\r\n                        this._failedFact.push(factory);\r\n                        invalidateCallbacks(callbacks);\r\n\r\n                        if (stillValid()) {\r\n                            this._destroyPlayer();\r\n                            return this._createPlayer();\r\n                        } else {\r\n                            return Promise.resolve();\r\n                        }\r\n                    }\r\n                } catch (error) {\r\n                    logger.warn('Player._createPlayer error', error);\r\n                }\r\n            }\r\n\r\n            factoryQueueEntry = this._factoryQueue.shift();\r\n        }\r\n    }\r\n\r\n    private _getUserMedia(\r\n        constraints?: MediaStreamConstraints\r\n    ): Promise<MediaStream> {\r\n        if (navigator.mediaDevices && navigator.mediaDevices.getUserMedia) {\r\n            return navigator.mediaDevices.getUserMedia(constraints);\r\n        } else if (navigator.getUserMedia) {\r\n            return new Promise<MediaStream>((resolve, reject) => {\r\n                navigator.getUserMedia(\r\n                    constraints,\r\n                    (mediaStream: MediaStream) => {\r\n                        resolve(mediaStream);\r\n                    },\r\n                    (e: Error) => {\r\n                        reject(e);\r\n                    }\r\n                );\r\n            });\r\n        } else if (navigator['webkitGetUserMedia']) {\r\n            return new Promise<MediaStream>((resolve, reject) => {\r\n                navigator['webkitGetUserMedia'](\r\n                    constraints,\r\n                    (mediaStream: MediaStream) => {\r\n                        resolve(mediaStream);\r\n                    },\r\n                    (e: Error) => {\r\n                        reject(e);\r\n                    }\r\n                );\r\n            });\r\n        } else {\r\n            return Promise.reject(new Error('No GetUserMedia API available'));\r\n        }\r\n    }\r\n\r\n    private _installPlayer(player: IPlayer): void {\r\n        // assert player != null\r\n        this._player = player;\r\n\r\n        for (const playerElement of player.el) {\r\n            // to avoid adding optional elements which can be null\r\n            if (playerElement) {\r\n                this._playerContainer.append(playerElement);\r\n            }\r\n        }\r\n\r\n        if (this._handler.onPlayerSwitchComplete) {\r\n            this._handler.onPlayerSwitchComplete(this._format);\r\n        }\r\n\r\n        this._callbacks.onSendMetrics(PlayerEvent.Init);\r\n\r\n        player.setVolume(this._volume);\r\n        if (this._sourceSet) {\r\n            player.play(this._sourceSet, this._format);\r\n        }\r\n    }\r\n\r\n    private _createCallbacks(factory: PlayerFactory): Callbacks {\r\n        return (this._callbacks = {\r\n            onVolumeChange: (value: number): void => {\r\n                if (this._volume !== value && this._handler.onVolumeChange) {\r\n                    this._volume = value;\r\n                    this._handler.onVolumeChange(value);\r\n                }\r\n            },\r\n            onError: (error): void => {\r\n                this._callbacks.onSendMetrics(PlayerEvent.Error, { error });\r\n\r\n                logger.warn('Player.onPlayerError', error);\r\n                this._playing = false;\r\n                this._failedFact.push(factory);\r\n                this.playNext();\r\n            },\r\n\r\n            onSendMetrics: (event, info = null): void => {\r\n                if (info === null) {\r\n                    info = {};\r\n                }\r\n\r\n                const metrics = {\r\n                    playerEvent: event,\r\n                    playerFormat: this._format,\r\n                    playerType: this._player ? this._player.name : '',\r\n                    ...info\r\n                };\r\n\r\n                const connection =\r\n                    navigator['connection'] ||\r\n                    navigator['mozConnection'] ||\r\n                    navigator['webkitConnection'] ||\r\n                    navigator['msConnection'] ||\r\n                    {};\r\n\r\n                if (connection) {\r\n                    const networkInfo = {};\r\n                    const networkKeys = [\r\n                        'downlink',\r\n                        'downlinkMax',\r\n                        'effectiveType',\r\n                        'rtt',\r\n                        'type'\r\n                    ];\r\n\r\n                    for (const n of networkKeys) {\r\n                        if (connection[n]) {\r\n                            networkInfo[n] = connection[n];\r\n                        }\r\n                    }\r\n\r\n                    metrics['networkInfo'] = networkInfo;\r\n                }\r\n\r\n                // TODO: in first iteration send data only via handler so it can be sent via chatInstance\r\n                // in a second step: create an external interface to connect to via a trackingID (e.g. userId, ChatId)\r\n                if (this._handler.onSendMetrics) {\r\n                    this._handler.onSendMetrics(metrics);\r\n                }\r\n            },\r\n\r\n            onPlayStart: (source): void => {\r\n                // when event is .Play -> play() has been executed\r\n                this._callbacks.onSendMetrics(PlayerEvent.Play);\r\n\r\n                if (this._handler.onPlayStart) {\r\n                    this._handler.onPlayStart(source);\r\n                }\r\n            },\r\n            onPlayStop: (): void => {\r\n                this._callbacks.onSendMetrics(PlayerEvent.Pause);\r\n\r\n                this._playing = false;\r\n                if (this._handler.onPlayStop) {\r\n                    this._handler.onPlayStop();\r\n                }\r\n            },\r\n            onPlayInfo: (info): void => {\r\n                if (this._handler.onPlayInfo) {\r\n                    this._handler.onPlayInfo(info);\r\n                }\r\n            },\r\n\r\n            onPlayError: (level, error): void => {\r\n                this._callbacks.onSendMetrics(PlayerEvent.Error, {\r\n                    error: error\r\n                });\r\n\r\n                if (this._handler.onPlayError) {\r\n                    this._handler.onPlayError(level);\r\n                }\r\n            },\r\n            onCameraOn: (): void => {\r\n                if (this._handler.onCameraOn) {\r\n                    this._handler.onCameraOn();\r\n                }\r\n            },\r\n            onCameraOff: (): void => {\r\n                if (this._handler.onCameraOff) {\r\n                    this._handler.onCameraOff();\r\n                }\r\n            },\r\n            onCameraDenied: (): void => {\r\n                if (this._handler.onCameraDenied) {\r\n                    this._handler.onCameraDenied();\r\n                }\r\n            },\r\n\r\n            onPublishStart: (): void => {\r\n                if (this._handler.onPublishStart) {\r\n                    this._handler.onPublishStart();\r\n                }\r\n            },\r\n            onPublishStop: (): void => {\r\n                if (this._handler.onPublishStop) {\r\n                    this._handler.onPublishStop();\r\n                }\r\n            }\r\n        });\r\n    }\r\n\r\n    private _destroyPlayer(): void {\r\n        logger.log('Player._destroyPlayer', this._player, this._format);\r\n\r\n        const player = this._player;\r\n        if (player) {\r\n            const video = player.destroy();\r\n\r\n            if (video) {\r\n                this._video = video;\r\n            }\r\n\r\n            for (const playerElement of player.el) {\r\n                if (\r\n                    playerElement &&\r\n                    playerElement.parentNode === this._playerContainer\r\n                ) {\r\n                    playerElement.remove();\r\n                }\r\n            }\r\n        }\r\n\r\n        if (this._callbacks) {\r\n            invalidateCallbacks(this._callbacks);\r\n        }\r\n\r\n        this._player = null;\r\n        this._callbacks = null;\r\n        this._factory = null;\r\n        this._format = null;\r\n        this._playing = false;\r\n    }\r\n\r\n    private _createCamVideo(mediaStream: MediaStream): void {\r\n        logger.log('Player.getUserMedia success getCapabilities', mediaStream);\r\n\r\n        this._camStream = mediaStream;\r\n\r\n        let video: HTMLVideoElement = this._camVideo;\r\n\r\n        if (!video) {\r\n            video = createElement('video', {\r\n                width: '100%',\r\n                height: '100%',\r\n                border: 'none'\r\n            });\r\n            video.muted = true;\r\n            video.volume = 0;\r\n            video.autoplay = true;\r\n\r\n            // special to allow autoplay in iOS\r\n            video.setAttribute('playsinline', 'true');\r\n\r\n            this._camContainer.append(video);\r\n        }\r\n\r\n        this._camVideo = video;\r\n\r\n        if (video.srcObject !== undefined) {\r\n            video.srcObject = mediaStream;\r\n        } else {\r\n            video.src = URL.createObjectURL(mediaStream);\r\n        }\r\n\r\n        video.onloadedmetadata = (): void => {\r\n            if (video.videoWidth) {\r\n                this._camContainer.style.display = 'block';\r\n                this._updateCameraPosition();\r\n                this._updateCameraSize();\r\n\r\n                window.addEventListener('resize', this);\r\n\r\n                if (this._handler.onCameraOn) {\r\n                    this._handler.onCameraOn();\r\n                }\r\n            } else {\r\n                // setTimeout()\r\n            }\r\n        };\r\n    }\r\n\r\n    private _updateCameraPosition(): void {\r\n        const s = this._camContainer.style;\r\n        const p = ['top', 'left', 'right', 'bottom'];\r\n        p.forEach((prop) => s.removeProperty(prop));\r\n\r\n        const margin = 10;\r\n\r\n        switch (this._camConfig.position) {\r\n            case CameraPosition.FullScreen: {\r\n                s.top = '0px';\r\n                s.left = '0px';\r\n                break;\r\n            }\r\n\r\n            case CameraPosition.BottomRight: {\r\n                s.bottom = margin + 'px';\r\n                s.right = margin + 'px';\r\n                break;\r\n            }\r\n\r\n            case CameraPosition.BottomLeft: {\r\n                s.bottom = margin + 'px';\r\n                s.left = margin + 'px';\r\n                break;\r\n            }\r\n\r\n            case CameraPosition.TopRight: {\r\n                s.top = margin + 'px';\r\n                s.right = margin + 'px';\r\n                break;\r\n            }\r\n\r\n            case CameraPosition.TopLeft:\r\n            default: {\r\n                s.top = margin + 'px';\r\n                s.left = margin + 'px';\r\n                break;\r\n            }\r\n        }\r\n    }\r\n\r\n    private static computeCam2CamVideoSize(\r\n        camConfig: CameraConfig,\r\n        aspectRation: number,\r\n        container: HTMLElement\r\n    ): [number, number] {\r\n        let w = 0;\r\n        let h = 0;\r\n\r\n        const cw = container.clientWidth;\r\n        const ch = container.clientHeight;\r\n\r\n        if (camConfig.position === CameraPosition.FullScreen) {\r\n            return [cw, ch];\r\n        }\r\n\r\n        if (camConfig.width) {\r\n            w = camConfig.width;\r\n            h = Math.round(w / aspectRation);\r\n        } else if (camConfig.height) {\r\n            h = camConfig.height;\r\n            w = Math.round(h * aspectRation);\r\n        } else {\r\n            const wRatio = camConfig.widthRatio || 3.5;\r\n            const hRatio = camConfig.heightRatio || 2; // 2.5\r\n            const i: number = Math.floor(\r\n                Math.min(cw / wRatio / 80, ch / hRatio / (80 / aspectRation))\r\n            );\r\n            w = i > 2 ? i * 80 : 160;\r\n            h = Math.round(w / aspectRation);\r\n        }\r\n\r\n        return [w, h];\r\n    }\r\n\r\n    private _updateCameraSize(): void {\r\n        if (!this._camVideo) {\r\n            return;\r\n        }\r\n\r\n        const aspectRation: number =\r\n            this._camVideo.videoWidth / this._camVideo.videoHeight;\r\n\r\n        const [w, h] = Player.computeCam2CamVideoSize(\r\n            this._camConfig,\r\n            aspectRation,\r\n            this._container\r\n        );\r\n\r\n        const s = this._camContainer.style;\r\n        s.width = w + 'px';\r\n        s.height = h + 'px';\r\n    }\r\n\r\n    private _createCamPublisher(jpegTarget: JpegTarget): PicUpStream {\r\n        const jpegUploadSettings: JpegUploadSettings = {\r\n            width: jpegTarget.width,\r\n            height: jpegTarget.height,\r\n            quality: jpegTarget.quality\r\n        };\r\n        const provider = new VideoElementFrameProvider(\r\n            this._camVideo,\r\n            jpegUploadSettings,\r\n            (error: Error) => {\r\n                logger.warn('Player.PicUpStream.onError', error);\r\n                this.unpublish();\r\n            }\r\n        );\r\n\r\n        return new PicUpStream(provider);\r\n    }\r\n}\r\n","var g;\n\n// This works in non-strict mode\ng = (function() {\n\treturn this;\n})();\n\ntry {\n\t// This works if eval is allowed (see CSP)\n\tg = g || new Function(\"return this\")();\n} catch (e) {\n\t// This works if the window reference is available\n\tif (typeof window === \"object\") g = window;\n}\n\n// g can still be undefined, but nothing to do about it...\n// We return undefined, instead of nothing here, so it's\n// easier to handle this case. if(!global) { ...}\n\nmodule.exports = g;\n","var DESCRIPTORS = require('../internals/descriptors');\nvar propertyIsEnumerableModule = require('../internals/object-property-is-enumerable');\nvar createPropertyDescriptor = require('../internals/create-property-descriptor');\nvar toIndexedObject = require('../internals/to-indexed-object');\nvar toPrimitive = require('../internals/to-primitive');\nvar has = require('../internals/has');\nvar IE8_DOM_DEFINE = require('../internals/ie8-dom-define');\n\nvar nativeGetOwnPropertyDescriptor = Object.getOwnPropertyDescriptor;\n\n// `Object.getOwnPropertyDescriptor` method\n// https://tc39.github.io/ecma262/#sec-object.getownpropertydescriptor\nexports.f = DESCRIPTORS ? nativeGetOwnPropertyDescriptor : function getOwnPropertyDescriptor(O, P) {\n  O = toIndexedObject(O);\n  P = toPrimitive(P, true);\n  if (IE8_DOM_DEFINE) try {\n    return nativeGetOwnPropertyDescriptor(O, P);\n  } catch (error) { /* empty */ }\n  if (has(O, P)) return createPropertyDescriptor(!propertyIsEnumerableModule.f.call(O, P), O[P]);\n};\n","module.exports = function (bitmap, value) {\n  return {\n    enumerable: !(bitmap & 1),\n    configurable: !(bitmap & 2),\n    writable: !(bitmap & 4),\n    value: value\n  };\n};\n","var toString = {}.toString;\n\nmodule.exports = function (it) {\n  return toString.call(it).slice(8, -1);\n};\n","// `RequireObjectCoercible` abstract operation\n// https://tc39.github.io/ecma262/#sec-requireobjectcoercible\nmodule.exports = function (it) {\n  if (it == undefined) throw TypeError(\"Can't call method on \" + it);\n  return it;\n};\n","var isObject = require('../internals/is-object');\n\n// `ToPrimitive` abstract operation\n// https://tc39.github.io/ecma262/#sec-toprimitive\n// instead of the ES6 spec version, we didn't implement @@toPrimitive case\n// and the second argument - flag - preferred type is a string\nmodule.exports = function (input, PREFERRED_STRING) {\n  if (!isObject(input)) return input;\n  var fn, val;\n  if (PREFERRED_STRING && typeof (fn = input.toString) == 'function' && !isObject(val = fn.call(input))) return val;\n  if (typeof (fn = input.valueOf) == 'function' && !isObject(val = fn.call(input))) return val;\n  if (!PREFERRED_STRING && typeof (fn = input.toString) == 'function' && !isObject(val = fn.call(input))) return val;\n  throw TypeError(\"Can't convert object to primitive value\");\n};\n","var DESCRIPTORS = require('../internals/descriptors');\nvar fails = require('../internals/fails');\nvar createElement = require('../internals/document-create-element');\n\n// Thank's IE8 for his funny defineProperty\nmodule.exports = !DESCRIPTORS && !fails(function () {\n  return Object.defineProperty(createElement('div'), 'a', {\n    get: function () { return 7; }\n  }).a != 7;\n});\n","var global = require('../internals/global');\nvar isObject = require('../internals/is-object');\n\nvar document = global.document;\n// typeof document.createElement is 'object' in old IE\nvar EXISTS = isObject(document) && isObject(document.createElement);\n\nmodule.exports = function (it) {\n  return EXISTS ? document.createElement(it) : {};\n};\n","var global = require('../internals/global');\nvar createNonEnumerableProperty = require('../internals/create-non-enumerable-property');\nvar has = require('../internals/has');\nvar setGlobal = require('../internals/set-global');\nvar inspectSource = require('../internals/inspect-source');\nvar InternalStateModule = require('../internals/internal-state');\n\nvar getInternalState = InternalStateModule.get;\nvar enforceInternalState = InternalStateModule.enforce;\nvar TEMPLATE = String(String).split('String');\n\n(module.exports = function (O, key, value, options) {\n  var unsafe = options ? !!options.unsafe : false;\n  var simple = options ? !!options.enumerable : false;\n  var noTargetGet = options ? !!options.noTargetGet : false;\n  if (typeof value == 'function') {\n    if (typeof key == 'string' && !has(value, 'name')) createNonEnumerableProperty(value, 'name', key);\n    enforceInternalState(value).source = TEMPLATE.join(typeof key == 'string' ? key : '');\n  }\n  if (O === global) {\n    if (simple) O[key] = value;\n    else setGlobal(key, value);\n    return;\n  } else if (!unsafe) {\n    delete O[key];\n  } else if (!noTargetGet && O[key]) {\n    simple = true;\n  }\n  if (simple) O[key] = value;\n  else createNonEnumerableProperty(O, key, value);\n// add fake Function#toString for correct work wrapped methods / constructors with methods like LoDash isNative\n})(Function.prototype, 'toString', function toString() {\n  return typeof this == 'function' && getInternalState(this).source || inspectSource(this);\n});\n","var store = require('../internals/shared-store');\n\nvar functionToString = Function.toString;\n\n// this helper broken in `3.4.1-3.4.4`, so we can't use `shared` helper\nif (typeof store.inspectSource != 'function') {\n  store.inspectSource = function (it) {\n    return functionToString.call(it);\n  };\n}\n\nmodule.exports = store.inspectSource;\n","var global = require('../internals/global');\nvar setGlobal = require('../internals/set-global');\n\nvar SHARED = '__core-js_shared__';\nvar store = global[SHARED] || setGlobal(SHARED, {});\n\nmodule.exports = store;\n","var IS_PURE = require('../internals/is-pure');\nvar store = require('../internals/shared-store');\n\n(module.exports = function (key, value) {\n  return store[key] || (store[key] = value !== undefined ? value : {});\n})('versions', []).push({\n  version: '3.6.4',\n  mode: IS_PURE ? 'pure' : 'global',\n  copyright: ' 2020 Denis Pushkarev (zloirock.ru)'\n});\n","var path = require('../internals/path');\nvar global = require('../internals/global');\n\nvar aFunction = function (variable) {\n  return typeof variable == 'function' ? variable : undefined;\n};\n\nmodule.exports = function (namespace, method) {\n  return arguments.length < 2 ? aFunction(path[namespace]) || aFunction(global[namespace])\n    : path[namespace] && path[namespace][method] || global[namespace] && global[namespace][method];\n};\n","var has = require('../internals/has');\nvar toIndexedObject = require('../internals/to-indexed-object');\nvar indexOf = require('../internals/array-includes').indexOf;\nvar hiddenKeys = require('../internals/hidden-keys');\n\nmodule.exports = function (object, names) {\n  var O = toIndexedObject(object);\n  var i = 0;\n  var result = [];\n  var key;\n  for (key in O) !has(hiddenKeys, key) && has(O, key) && result.push(key);\n  // Don't enum bug & hidden keys\n  while (names.length > i) if (has(O, key = names[i++])) {\n    ~indexOf(result, key) || result.push(key);\n  }\n  return result;\n};\n","var ceil = Math.ceil;\nvar floor = Math.floor;\n\n// `ToInteger` abstract operation\n// https://tc39.github.io/ecma262/#sec-tointeger\nmodule.exports = function (argument) {\n  return isNaN(argument = +argument) ? 0 : (argument > 0 ? floor : ceil)(argument);\n};\n","var fails = require('../internals/fails');\n\nmodule.exports = !!Object.getOwnPropertySymbols && !fails(function () {\n  // Chrome 38 Symbol has incorrect toString conversion\n  // eslint-disable-next-line no-undef\n  return !String(Symbol());\n});\n","export enum ErrorLevel {\n    Info = 0,\n    Critical = 10\n}\n","export const VERSION = '__VERSION__';\r\n","import './polyfills/polyfills';\r\n\r\nexport { Callbacks } from './callbacks';\r\nexport { CameraConfig } from './camera-config';\r\nexport { CameraEvent } from './camera-event';\r\nexport { CameraPosition } from './camera-position';\r\nexport { DummyPlayerFactory } from './players/dummy-player';\r\nexport { HlsJsPlayerConfig } from './players/hlsjs/hlsjs-player-config';\r\nexport { HlsJsPlayerFactory } from './players/hlsjs/hlsjs-player';\r\nexport { HlsPlayerFactory, HlsPlayerConfig } from './players/hls-player';\r\nexport { IPlayer } from './iplayer';\r\nexport { JpegPlayerFactory, JpegPlayerConfig } from './players/jpeg-player';\r\nexport { Player } from './player';\r\nexport { PlayerFactory } from './player-factory';\r\nexport { PlayerFactoryLoader } from './player-factory-loader';\r\nexport { PlayerHandler } from './player-handler';\r\nexport { PlayInfo } from './play-info';\r\nexport { QualityBoundaries } from './quality-boundaries';\r\nexport { RtmpPlayerFactory } from './players/rtmp/rtmp-player-factory';\r\nexport { RtmpPlayerConfig } from './players/rtmp/rtmp-player-config';\r\nexport { VERSION } from './version';\r\nexport { WebRTCPlayerFactory } from './players/webrtc/webrtc-player-factory';\r\n","import 'ts-polyfill/lib/es2016-array-include';\r\n\r\nimport './append';\r\nimport './remove';\r\nimport './to-blob';\r\n","\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nrequire(\"core-js/es/array/includes\");\r\nrequire(\"core-js/es/typed-array/includes\");\r\n","require('../../modules/es.array.includes');\nvar entryUnbind = require('../../internals/entry-unbind');\n\nmodule.exports = entryUnbind('Array', 'includes');\n","'use strict';\nvar $ = require('../internals/export');\nvar $includes = require('../internals/array-includes').includes;\nvar addToUnscopables = require('../internals/add-to-unscopables');\nvar arrayMethodUsesToLength = require('../internals/array-method-uses-to-length');\n\nvar USES_TO_LENGTH = arrayMethodUsesToLength('indexOf', { ACCESSORS: true, 1: 0 });\n\n// `Array.prototype.includes` method\n// https://tc39.github.io/ecma262/#sec-array.prototype.includes\n$({ target: 'Array', proto: true, forced: !USES_TO_LENGTH }, {\n  includes: function includes(el /* , fromIndex = 0 */) {\n    return $includes(this, el, arguments.length > 1 ? arguments[1] : undefined);\n  }\n});\n\n// https://tc39.github.io/ecma262/#sec-array.prototype-@@unscopables\naddToUnscopables('includes');\n","var global = require('../internals/global');\nvar getOwnPropertyDescriptor = require('../internals/object-get-own-property-descriptor').f;\nvar createNonEnumerableProperty = require('../internals/create-non-enumerable-property');\nvar redefine = require('../internals/redefine');\nvar setGlobal = require('../internals/set-global');\nvar copyConstructorProperties = require('../internals/copy-constructor-properties');\nvar isForced = require('../internals/is-forced');\n\n/*\n  options.target      - name of the target object\n  options.global      - target is the global object\n  options.stat        - export as static methods of target\n  options.proto       - export as prototype methods of target\n  options.real        - real prototype method for the `pure` version\n  options.forced      - export even if the native feature is available\n  options.bind        - bind methods to the target, required for the `pure` version\n  options.wrap        - wrap constructors to preventing global pollution, required for the `pure` version\n  options.unsafe      - use the simple assignment of property instead of delete + defineProperty\n  options.sham        - add a flag to not completely full polyfills\n  options.enumerable  - export as enumerable property\n  options.noTargetGet - prevent calling a getter on target\n*/\nmodule.exports = function (options, source) {\n  var TARGET = options.target;\n  var GLOBAL = options.global;\n  var STATIC = options.stat;\n  var FORCED, target, key, targetProperty, sourceProperty, descriptor;\n  if (GLOBAL) {\n    target = global;\n  } else if (STATIC) {\n    target = global[TARGET] || setGlobal(TARGET, {});\n  } else {\n    target = (global[TARGET] || {}).prototype;\n  }\n  if (target) for (key in source) {\n    sourceProperty = source[key];\n    if (options.noTargetGet) {\n      descriptor = getOwnPropertyDescriptor(target, key);\n      targetProperty = descriptor && descriptor.value;\n    } else targetProperty = target[key];\n    FORCED = isForced(GLOBAL ? key : TARGET + (STATIC ? '.' : '#') + key, options.forced);\n    // contained in target\n    if (!FORCED && targetProperty !== undefined) {\n      if (typeof sourceProperty === typeof targetProperty) continue;\n      copyConstructorProperties(sourceProperty, targetProperty);\n    }\n    // add a flag to not completely full polyfills\n    if (options.sham || (targetProperty && targetProperty.sham)) {\n      createNonEnumerableProperty(sourceProperty, 'sham', true);\n    }\n    // extend global\n    redefine(target, key, sourceProperty, options);\n  }\n};\n","'use strict';\nvar nativePropertyIsEnumerable = {}.propertyIsEnumerable;\nvar getOwnPropertyDescriptor = Object.getOwnPropertyDescriptor;\n\n// Nashorn ~ JDK8 bug\nvar NASHORN_BUG = getOwnPropertyDescriptor && !nativePropertyIsEnumerable.call({ 1: 2 }, 1);\n\n// `Object.prototype.propertyIsEnumerable` method implementation\n// https://tc39.github.io/ecma262/#sec-object.prototype.propertyisenumerable\nexports.f = NASHORN_BUG ? function propertyIsEnumerable(V) {\n  var descriptor = getOwnPropertyDescriptor(this, V);\n  return !!descriptor && descriptor.enumerable;\n} : nativePropertyIsEnumerable;\n","var fails = require('../internals/fails');\nvar classof = require('../internals/classof-raw');\n\nvar split = ''.split;\n\n// fallback for non-array-like ES3 and non-enumerable old V8 strings\nmodule.exports = fails(function () {\n  // throws an error in rhino, see https://github.com/mozilla/rhino/issues/346\n  // eslint-disable-next-line no-prototype-builtins\n  return !Object('z').propertyIsEnumerable(0);\n}) ? function (it) {\n  return classof(it) == 'String' ? split.call(it, '') : Object(it);\n} : Object;\n","var NATIVE_WEAK_MAP = require('../internals/native-weak-map');\nvar global = require('../internals/global');\nvar isObject = require('../internals/is-object');\nvar createNonEnumerableProperty = require('../internals/create-non-enumerable-property');\nvar objectHas = require('../internals/has');\nvar sharedKey = require('../internals/shared-key');\nvar hiddenKeys = require('../internals/hidden-keys');\n\nvar WeakMap = global.WeakMap;\nvar set, get, has;\n\nvar enforce = function (it) {\n  return has(it) ? get(it) : set(it, {});\n};\n\nvar getterFor = function (TYPE) {\n  return function (it) {\n    var state;\n    if (!isObject(it) || (state = get(it)).type !== TYPE) {\n      throw TypeError('Incompatible receiver, ' + TYPE + ' required');\n    } return state;\n  };\n};\n\nif (NATIVE_WEAK_MAP) {\n  var store = new WeakMap();\n  var wmget = store.get;\n  var wmhas = store.has;\n  var wmset = store.set;\n  set = function (it, metadata) {\n    wmset.call(store, it, metadata);\n    return metadata;\n  };\n  get = function (it) {\n    return wmget.call(store, it) || {};\n  };\n  has = function (it) {\n    return wmhas.call(store, it);\n  };\n} else {\n  var STATE = sharedKey('state');\n  hiddenKeys[STATE] = true;\n  set = function (it, metadata) {\n    createNonEnumerableProperty(it, STATE, metadata);\n    return metadata;\n  };\n  get = function (it) {\n    return objectHas(it, STATE) ? it[STATE] : {};\n  };\n  has = function (it) {\n    return objectHas(it, STATE);\n  };\n}\n\nmodule.exports = {\n  set: set,\n  get: get,\n  has: has,\n  enforce: enforce,\n  getterFor: getterFor\n};\n","var global = require('../internals/global');\nvar inspectSource = require('../internals/inspect-source');\n\nvar WeakMap = global.WeakMap;\n\nmodule.exports = typeof WeakMap === 'function' && /native code/.test(inspectSource(WeakMap));\n","module.exports = false;\n","var has = require('../internals/has');\nvar ownKeys = require('../internals/own-keys');\nvar getOwnPropertyDescriptorModule = require('../internals/object-get-own-property-descriptor');\nvar definePropertyModule = require('../internals/object-define-property');\n\nmodule.exports = function (target, source) {\n  var keys = ownKeys(source);\n  var defineProperty = definePropertyModule.f;\n  var getOwnPropertyDescriptor = getOwnPropertyDescriptorModule.f;\n  for (var i = 0; i < keys.length; i++) {\n    var key = keys[i];\n    if (!has(target, key)) defineProperty(target, key, getOwnPropertyDescriptor(source, key));\n  }\n};\n","var getBuiltIn = require('../internals/get-built-in');\nvar getOwnPropertyNamesModule = require('../internals/object-get-own-property-names');\nvar getOwnPropertySymbolsModule = require('../internals/object-get-own-property-symbols');\nvar anObject = require('../internals/an-object');\n\n// all object keys, includes non-enumerable and symbols\nmodule.exports = getBuiltIn('Reflect', 'ownKeys') || function ownKeys(it) {\n  var keys = getOwnPropertyNamesModule.f(anObject(it));\n  var getOwnPropertySymbols = getOwnPropertySymbolsModule.f;\n  return getOwnPropertySymbols ? keys.concat(getOwnPropertySymbols(it)) : keys;\n};\n","var global = require('../internals/global');\n\nmodule.exports = global;\n","var internalObjectKeys = require('../internals/object-keys-internal');\nvar enumBugKeys = require('../internals/enum-bug-keys');\n\nvar hiddenKeys = enumBugKeys.concat('length', 'prototype');\n\n// `Object.getOwnPropertyNames` method\n// https://tc39.github.io/ecma262/#sec-object.getownpropertynames\nexports.f = Object.getOwnPropertyNames || function getOwnPropertyNames(O) {\n  return internalObjectKeys(O, hiddenKeys);\n};\n","var toInteger = require('../internals/to-integer');\n\nvar min = Math.min;\n\n// `ToLength` abstract operation\n// https://tc39.github.io/ecma262/#sec-tolength\nmodule.exports = function (argument) {\n  return argument > 0 ? min(toInteger(argument), 0x1FFFFFFFFFFFFF) : 0; // 2 ** 53 - 1 == 9007199254740991\n};\n","var toInteger = require('../internals/to-integer');\n\nvar max = Math.max;\nvar min = Math.min;\n\n// Helper for a popular repeating case of the spec:\n// Let integer be ? ToInteger(index).\n// If integer < 0, let result be max((length + integer), 0); else let result be min(integer, length).\nmodule.exports = function (index, length) {\n  var integer = toInteger(index);\n  return integer < 0 ? max(integer + length, 0) : min(integer, length);\n};\n","exports.f = Object.getOwnPropertySymbols;\n","var fails = require('../internals/fails');\n\nvar replacement = /#|\\.prototype\\./;\n\nvar isForced = function (feature, detection) {\n  var value = data[normalize(feature)];\n  return value == POLYFILL ? true\n    : value == NATIVE ? false\n    : typeof detection == 'function' ? fails(detection)\n    : !!detection;\n};\n\nvar normalize = isForced.normalize = function (string) {\n  return String(string).replace(replacement, '.').toLowerCase();\n};\n\nvar data = isForced.data = {};\nvar NATIVE = isForced.NATIVE = 'N';\nvar POLYFILL = isForced.POLYFILL = 'P';\n\nmodule.exports = isForced;\n","var wellKnownSymbol = require('../internals/well-known-symbol');\nvar create = require('../internals/object-create');\nvar definePropertyModule = require('../internals/object-define-property');\n\nvar UNSCOPABLES = wellKnownSymbol('unscopables');\nvar ArrayPrototype = Array.prototype;\n\n// Array.prototype[@@unscopables]\n// https://tc39.github.io/ecma262/#sec-array.prototype-@@unscopables\nif (ArrayPrototype[UNSCOPABLES] == undefined) {\n  definePropertyModule.f(ArrayPrototype, UNSCOPABLES, {\n    configurable: true,\n    value: create(null)\n  });\n}\n\n// add a key to Array.prototype[@@unscopables]\nmodule.exports = function (key) {\n  ArrayPrototype[UNSCOPABLES][key] = true;\n};\n","var NATIVE_SYMBOL = require('../internals/native-symbol');\n\nmodule.exports = NATIVE_SYMBOL\n  // eslint-disable-next-line no-undef\n  && !Symbol.sham\n  // eslint-disable-next-line no-undef\n  && typeof Symbol.iterator == 'symbol';\n","var anObject = require('../internals/an-object');\nvar defineProperties = require('../internals/object-define-properties');\nvar enumBugKeys = require('../internals/enum-bug-keys');\nvar hiddenKeys = require('../internals/hidden-keys');\nvar html = require('../internals/html');\nvar documentCreateElement = require('../internals/document-create-element');\nvar sharedKey = require('../internals/shared-key');\n\nvar GT = '>';\nvar LT = '<';\nvar PROTOTYPE = 'prototype';\nvar SCRIPT = 'script';\nvar IE_PROTO = sharedKey('IE_PROTO');\n\nvar EmptyConstructor = function () { /* empty */ };\n\nvar scriptTag = function (content) {\n  return LT + SCRIPT + GT + content + LT + '/' + SCRIPT + GT;\n};\n\n// Create object with fake `null` prototype: use ActiveX Object with cleared prototype\nvar NullProtoObjectViaActiveX = function (activeXDocument) {\n  activeXDocument.write(scriptTag(''));\n  activeXDocument.close();\n  var temp = activeXDocument.parentWindow.Object;\n  activeXDocument = null; // avoid memory leak\n  return temp;\n};\n\n// Create object with fake `null` prototype: use iframe Object with cleared prototype\nvar NullProtoObjectViaIFrame = function () {\n  // Thrash, waste and sodomy: IE GC bug\n  var iframe = documentCreateElement('iframe');\n  var JS = 'java' + SCRIPT + ':';\n  var iframeDocument;\n  iframe.style.display = 'none';\n  html.appendChild(iframe);\n  // https://github.com/zloirock/core-js/issues/475\n  iframe.src = String(JS);\n  iframeDocument = iframe.contentWindow.document;\n  iframeDocument.open();\n  iframeDocument.write(scriptTag('document.F=Object'));\n  iframeDocument.close();\n  return iframeDocument.F;\n};\n\n// Check for document.domain and active x support\n// No need to use active x approach when document.domain is not set\n// see https://github.com/es-shims/es5-shim/issues/150\n// variation of https://github.com/kitcambridge/es5-shim/commit/4f738ac066346\n// avoid IE GC bug\nvar activeXDocument;\nvar NullProtoObject = function () {\n  try {\n    /* global ActiveXObject */\n    activeXDocument = document.domain && new ActiveXObject('htmlfile');\n  } catch (error) { /* ignore */ }\n  NullProtoObject = activeXDocument ? NullProtoObjectViaActiveX(activeXDocument) : NullProtoObjectViaIFrame();\n  var length = enumBugKeys.length;\n  while (length--) delete NullProtoObject[PROTOTYPE][enumBugKeys[length]];\n  return NullProtoObject();\n};\n\nhiddenKeys[IE_PROTO] = true;\n\n// `Object.create` method\n// https://tc39.github.io/ecma262/#sec-object.create\nmodule.exports = Object.create || function create(O, Properties) {\n  var result;\n  if (O !== null) {\n    EmptyConstructor[PROTOTYPE] = anObject(O);\n    result = new EmptyConstructor();\n    EmptyConstructor[PROTOTYPE] = null;\n    // add \"__proto__\" for Object.getPrototypeOf polyfill\n    result[IE_PROTO] = O;\n  } else result = NullProtoObject();\n  return Properties === undefined ? result : defineProperties(result, Properties);\n};\n","var DESCRIPTORS = require('../internals/descriptors');\nvar definePropertyModule = require('../internals/object-define-property');\nvar anObject = require('../internals/an-object');\nvar objectKeys = require('../internals/object-keys');\n\n// `Object.defineProperties` method\n// https://tc39.github.io/ecma262/#sec-object.defineproperties\nmodule.exports = DESCRIPTORS ? Object.defineProperties : function defineProperties(O, Properties) {\n  anObject(O);\n  var keys = objectKeys(Properties);\n  var length = keys.length;\n  var index = 0;\n  var key;\n  while (length > index) definePropertyModule.f(O, key = keys[index++], Properties[key]);\n  return O;\n};\n","var internalObjectKeys = require('../internals/object-keys-internal');\nvar enumBugKeys = require('../internals/enum-bug-keys');\n\n// `Object.keys` method\n// https://tc39.github.io/ecma262/#sec-object.keys\nmodule.exports = Object.keys || function keys(O) {\n  return internalObjectKeys(O, enumBugKeys);\n};\n","var getBuiltIn = require('../internals/get-built-in');\n\nmodule.exports = getBuiltIn('document', 'documentElement');\n","var DESCRIPTORS = require('../internals/descriptors');\nvar fails = require('../internals/fails');\nvar has = require('../internals/has');\n\nvar defineProperty = Object.defineProperty;\nvar cache = {};\n\nvar thrower = function (it) { throw it; };\n\nmodule.exports = function (METHOD_NAME, options) {\n  if (has(cache, METHOD_NAME)) return cache[METHOD_NAME];\n  if (!options) options = {};\n  var method = [][METHOD_NAME];\n  var ACCESSORS = has(options, 'ACCESSORS') ? options.ACCESSORS : false;\n  var argument0 = has(options, 0) ? options[0] : thrower;\n  var argument1 = has(options, 1) ? options[1] : undefined;\n\n  return cache[METHOD_NAME] = !!method && !fails(function () {\n    if (ACCESSORS && !DESCRIPTORS) return true;\n    var O = { length: -1 };\n\n    if (ACCESSORS) defineProperty(O, 1, { enumerable: true, get: thrower });\n    else O[1] = 1;\n\n    method.call(O, argument0, argument1);\n  });\n};\n","var global = require('../internals/global');\nvar bind = require('../internals/function-bind-context');\n\nvar call = Function.call;\n\nmodule.exports = function (CONSTRUCTOR, METHOD, length) {\n  return bind(call, global[CONSTRUCTOR].prototype[METHOD], length);\n};\n","var aFunction = require('../internals/a-function');\n\n// optional / simple context binding\nmodule.exports = function (fn, that, length) {\n  aFunction(fn);\n  if (that === undefined) return fn;\n  switch (length) {\n    case 0: return function () {\n      return fn.call(that);\n    };\n    case 1: return function (a) {\n      return fn.call(that, a);\n    };\n    case 2: return function (a, b) {\n      return fn.call(that, a, b);\n    };\n    case 3: return function (a, b, c) {\n      return fn.call(that, a, b, c);\n    };\n  }\n  return function (/* ...args */) {\n    return fn.apply(that, arguments);\n  };\n};\n","module.exports = function (it) {\n  if (typeof it != 'function') {\n    throw TypeError(String(it) + ' is not a function');\n  } return it;\n};\n","require('../../modules/es.typed-array.includes');\n","'use strict';\nvar ArrayBufferViewCore = require('../internals/array-buffer-view-core');\nvar $includes = require('../internals/array-includes').includes;\n\nvar aTypedArray = ArrayBufferViewCore.aTypedArray;\nvar exportTypedArrayMethod = ArrayBufferViewCore.exportTypedArrayMethod;\n\n// `%TypedArray%.prototype.includes` method\n// https://tc39.github.io/ecma262/#sec-%typedarray%.prototype.includes\nexportTypedArrayMethod('includes', function includes(searchElement /* , fromIndex */) {\n  return $includes(aTypedArray(this), searchElement, arguments.length > 1 ? arguments[1] : undefined);\n});\n","'use strict';\nvar NATIVE_ARRAY_BUFFER = require('../internals/array-buffer-native');\nvar DESCRIPTORS = require('../internals/descriptors');\nvar global = require('../internals/global');\nvar isObject = require('../internals/is-object');\nvar has = require('../internals/has');\nvar classof = require('../internals/classof');\nvar createNonEnumerableProperty = require('../internals/create-non-enumerable-property');\nvar redefine = require('../internals/redefine');\nvar defineProperty = require('../internals/object-define-property').f;\nvar getPrototypeOf = require('../internals/object-get-prototype-of');\nvar setPrototypeOf = require('../internals/object-set-prototype-of');\nvar wellKnownSymbol = require('../internals/well-known-symbol');\nvar uid = require('../internals/uid');\n\nvar Int8Array = global.Int8Array;\nvar Int8ArrayPrototype = Int8Array && Int8Array.prototype;\nvar Uint8ClampedArray = global.Uint8ClampedArray;\nvar Uint8ClampedArrayPrototype = Uint8ClampedArray && Uint8ClampedArray.prototype;\nvar TypedArray = Int8Array && getPrototypeOf(Int8Array);\nvar TypedArrayPrototype = Int8ArrayPrototype && getPrototypeOf(Int8ArrayPrototype);\nvar ObjectPrototype = Object.prototype;\nvar isPrototypeOf = ObjectPrototype.isPrototypeOf;\n\nvar TO_STRING_TAG = wellKnownSymbol('toStringTag');\nvar TYPED_ARRAY_TAG = uid('TYPED_ARRAY_TAG');\n// Fixing native typed arrays in Opera Presto crashes the browser, see #595\nvar NATIVE_ARRAY_BUFFER_VIEWS = NATIVE_ARRAY_BUFFER && !!setPrototypeOf && classof(global.opera) !== 'Opera';\nvar TYPED_ARRAY_TAG_REQIRED = false;\nvar NAME;\n\nvar TypedArrayConstructorsList = {\n  Int8Array: 1,\n  Uint8Array: 1,\n  Uint8ClampedArray: 1,\n  Int16Array: 2,\n  Uint16Array: 2,\n  Int32Array: 4,\n  Uint32Array: 4,\n  Float32Array: 4,\n  Float64Array: 8\n};\n\nvar isView = function isView(it) {\n  var klass = classof(it);\n  return klass === 'DataView' || has(TypedArrayConstructorsList, klass);\n};\n\nvar isTypedArray = function (it) {\n  return isObject(it) && has(TypedArrayConstructorsList, classof(it));\n};\n\nvar aTypedArray = function (it) {\n  if (isTypedArray(it)) return it;\n  throw TypeError('Target is not a typed array');\n};\n\nvar aTypedArrayConstructor = function (C) {\n  if (setPrototypeOf) {\n    if (isPrototypeOf.call(TypedArray, C)) return C;\n  } else for (var ARRAY in TypedArrayConstructorsList) if (has(TypedArrayConstructorsList, NAME)) {\n    var TypedArrayConstructor = global[ARRAY];\n    if (TypedArrayConstructor && (C === TypedArrayConstructor || isPrototypeOf.call(TypedArrayConstructor, C))) {\n      return C;\n    }\n  } throw TypeError('Target is not a typed array constructor');\n};\n\nvar exportTypedArrayMethod = function (KEY, property, forced) {\n  if (!DESCRIPTORS) return;\n  if (forced) for (var ARRAY in TypedArrayConstructorsList) {\n    var TypedArrayConstructor = global[ARRAY];\n    if (TypedArrayConstructor && has(TypedArrayConstructor.prototype, KEY)) {\n      delete TypedArrayConstructor.prototype[KEY];\n    }\n  }\n  if (!TypedArrayPrototype[KEY] || forced) {\n    redefine(TypedArrayPrototype, KEY, forced ? property\n      : NATIVE_ARRAY_BUFFER_VIEWS && Int8ArrayPrototype[KEY] || property);\n  }\n};\n\nvar exportTypedArrayStaticMethod = function (KEY, property, forced) {\n  var ARRAY, TypedArrayConstructor;\n  if (!DESCRIPTORS) return;\n  if (setPrototypeOf) {\n    if (forced) for (ARRAY in TypedArrayConstructorsList) {\n      TypedArrayConstructor = global[ARRAY];\n      if (TypedArrayConstructor && has(TypedArrayConstructor, KEY)) {\n        delete TypedArrayConstructor[KEY];\n      }\n    }\n    if (!TypedArray[KEY] || forced) {\n      // V8 ~ Chrome 49-50 `%TypedArray%` methods are non-writable non-configurable\n      try {\n        return redefine(TypedArray, KEY, forced ? property : NATIVE_ARRAY_BUFFER_VIEWS && Int8Array[KEY] || property);\n      } catch (error) { /* empty */ }\n    } else return;\n  }\n  for (ARRAY in TypedArrayConstructorsList) {\n    TypedArrayConstructor = global[ARRAY];\n    if (TypedArrayConstructor && (!TypedArrayConstructor[KEY] || forced)) {\n      redefine(TypedArrayConstructor, KEY, property);\n    }\n  }\n};\n\nfor (NAME in TypedArrayConstructorsList) {\n  if (!global[NAME]) NATIVE_ARRAY_BUFFER_VIEWS = false;\n}\n\n// WebKit bug - typed arrays constructors prototype is Object.prototype\nif (!NATIVE_ARRAY_BUFFER_VIEWS || typeof TypedArray != 'function' || TypedArray === Function.prototype) {\n  // eslint-disable-next-line no-shadow\n  TypedArray = function TypedArray() {\n    throw TypeError('Incorrect invocation');\n  };\n  if (NATIVE_ARRAY_BUFFER_VIEWS) for (NAME in TypedArrayConstructorsList) {\n    if (global[NAME]) setPrototypeOf(global[NAME], TypedArray);\n  }\n}\n\nif (!NATIVE_ARRAY_BUFFER_VIEWS || !TypedArrayPrototype || TypedArrayPrototype === ObjectPrototype) {\n  TypedArrayPrototype = TypedArray.prototype;\n  if (NATIVE_ARRAY_BUFFER_VIEWS) for (NAME in TypedArrayConstructorsList) {\n    if (global[NAME]) setPrototypeOf(global[NAME].prototype, TypedArrayPrototype);\n  }\n}\n\n// WebKit bug - one more object in Uint8ClampedArray prototype chain\nif (NATIVE_ARRAY_BUFFER_VIEWS && getPrototypeOf(Uint8ClampedArrayPrototype) !== TypedArrayPrototype) {\n  setPrototypeOf(Uint8ClampedArrayPrototype, TypedArrayPrototype);\n}\n\nif (DESCRIPTORS && !has(TypedArrayPrototype, TO_STRING_TAG)) {\n  TYPED_ARRAY_TAG_REQIRED = true;\n  defineProperty(TypedArrayPrototype, TO_STRING_TAG, { get: function () {\n    return isObject(this) ? this[TYPED_ARRAY_TAG] : undefined;\n  } });\n  for (NAME in TypedArrayConstructorsList) if (global[NAME]) {\n    createNonEnumerableProperty(global[NAME], TYPED_ARRAY_TAG, NAME);\n  }\n}\n\nmodule.exports = {\n  NATIVE_ARRAY_BUFFER_VIEWS: NATIVE_ARRAY_BUFFER_VIEWS,\n  TYPED_ARRAY_TAG: TYPED_ARRAY_TAG_REQIRED && TYPED_ARRAY_TAG,\n  aTypedArray: aTypedArray,\n  aTypedArrayConstructor: aTypedArrayConstructor,\n  exportTypedArrayMethod: exportTypedArrayMethod,\n  exportTypedArrayStaticMethod: exportTypedArrayStaticMethod,\n  isView: isView,\n  isTypedArray: isTypedArray,\n  TypedArray: TypedArray,\n  TypedArrayPrototype: TypedArrayPrototype\n};\n","module.exports = typeof ArrayBuffer !== 'undefined' && typeof DataView !== 'undefined';\n","var TO_STRING_TAG_SUPPORT = require('../internals/to-string-tag-support');\nvar classofRaw = require('../internals/classof-raw');\nvar wellKnownSymbol = require('../internals/well-known-symbol');\n\nvar TO_STRING_TAG = wellKnownSymbol('toStringTag');\n// ES3 wrong here\nvar CORRECT_ARGUMENTS = classofRaw(function () { return arguments; }()) == 'Arguments';\n\n// fallback for IE11 Script Access Denied error\nvar tryGet = function (it, key) {\n  try {\n    return it[key];\n  } catch (error) { /* empty */ }\n};\n\n// getting tag from ES6+ `Object.prototype.toString`\nmodule.exports = TO_STRING_TAG_SUPPORT ? classofRaw : function (it) {\n  var O, tag, result;\n  return it === undefined ? 'Undefined' : it === null ? 'Null'\n    // @@toStringTag case\n    : typeof (tag = tryGet(O = Object(it), TO_STRING_TAG)) == 'string' ? tag\n    // builtinTag case\n    : CORRECT_ARGUMENTS ? classofRaw(O)\n    // ES3 arguments fallback\n    : (result = classofRaw(O)) == 'Object' && typeof O.callee == 'function' ? 'Arguments' : result;\n};\n","var wellKnownSymbol = require('../internals/well-known-symbol');\n\nvar TO_STRING_TAG = wellKnownSymbol('toStringTag');\nvar test = {};\n\ntest[TO_STRING_TAG] = 'z';\n\nmodule.exports = String(test) === '[object z]';\n","var has = require('../internals/has');\nvar toObject = require('../internals/to-object');\nvar sharedKey = require('../internals/shared-key');\nvar CORRECT_PROTOTYPE_GETTER = require('../internals/correct-prototype-getter');\n\nvar IE_PROTO = sharedKey('IE_PROTO');\nvar ObjectPrototype = Object.prototype;\n\n// `Object.getPrototypeOf` method\n// https://tc39.github.io/ecma262/#sec-object.getprototypeof\nmodule.exports = CORRECT_PROTOTYPE_GETTER ? Object.getPrototypeOf : function (O) {\n  O = toObject(O);\n  if (has(O, IE_PROTO)) return O[IE_PROTO];\n  if (typeof O.constructor == 'function' && O instanceof O.constructor) {\n    return O.constructor.prototype;\n  } return O instanceof Object ? ObjectPrototype : null;\n};\n","var requireObjectCoercible = require('../internals/require-object-coercible');\n\n// `ToObject` abstract operation\n// https://tc39.github.io/ecma262/#sec-toobject\nmodule.exports = function (argument) {\n  return Object(requireObjectCoercible(argument));\n};\n","var fails = require('../internals/fails');\n\nmodule.exports = !fails(function () {\n  function F() { /* empty */ }\n  F.prototype.constructor = null;\n  return Object.getPrototypeOf(new F()) !== F.prototype;\n});\n","var anObject = require('../internals/an-object');\nvar aPossiblePrototype = require('../internals/a-possible-prototype');\n\n// `Object.setPrototypeOf` method\n// https://tc39.github.io/ecma262/#sec-object.setprototypeof\n// Works with __proto__ only. Old v8 can't work with null proto objects.\n/* eslint-disable no-proto */\nmodule.exports = Object.setPrototypeOf || ('__proto__' in {} ? function () {\n  var CORRECT_SETTER = false;\n  var test = {};\n  var setter;\n  try {\n    setter = Object.getOwnPropertyDescriptor(Object.prototype, '__proto__').set;\n    setter.call(test, []);\n    CORRECT_SETTER = test instanceof Array;\n  } catch (error) { /* empty */ }\n  return function setPrototypeOf(O, proto) {\n    anObject(O);\n    aPossiblePrototype(proto);\n    if (CORRECT_SETTER) setter.call(O, proto);\n    else O.__proto__ = proto;\n    return O;\n  };\n}() : undefined);\n","var isObject = require('../internals/is-object');\n\nmodule.exports = function (it) {\n  if (!isObject(it) && it !== null) {\n    throw TypeError(\"Can't set \" + String(it) + ' as a prototype');\n  } return it;\n};\n","/* eslint-disable unicorn/prefer-node-append */\r\n[Element.prototype, Document.prototype, DocumentFragment.prototype].forEach(\r\n    (item) => {\r\n        if (Object.prototype.hasOwnProperty.call(item, 'append')) {\r\n            return;\r\n        }\r\n\r\n        Object.defineProperty(item, 'append', {\r\n            configurable: true,\r\n            enumerable: true,\r\n            writable: true,\r\n            value: function append(...args) {\r\n                const argArr = Array.prototype.slice.call(args),\r\n                    docFrag = document.createDocumentFragment();\r\n\r\n                argArr.forEach(function(argItem) {\r\n                    const isNode = argItem instanceof Node;\r\n                    docFrag.appendChild(\r\n                        isNode\r\n                            ? argItem\r\n                            : document.createTextNode(String(argItem))\r\n                    );\r\n                });\r\n\r\n                this.appendChild(docFrag);\r\n            }\r\n        });\r\n    }\r\n);\r\n","[Element.prototype, CharacterData.prototype, DocumentType.prototype].forEach(\r\n    (item) => {\r\n        if (Object.prototype.hasOwnProperty.call(item, 'remove')) {\r\n            return;\r\n        }\r\n\r\n        Object.defineProperty(item, 'remove', {\r\n            configurable: true,\r\n            enumerable: true,\r\n            writable: true,\r\n            value: function remove() {\r\n                // eslint-disable-next-line unicorn/prefer-node-remove\r\n                if (this.parentNode !== null) this.parentNode.removeChild(this);\r\n            }\r\n        });\r\n    }\r\n);\r\n","[HTMLCanvasElement.prototype].forEach((item) => {\r\n    if (Object.prototype.hasOwnProperty.call(item, 'toBlob')) {\r\n        return;\r\n    }\r\n\r\n    Object.defineProperty(HTMLCanvasElement.prototype, 'toBlob', {\r\n        value: function(\r\n            callback: (b: Blob) => any,\r\n            type: string,\r\n            quality: number\r\n        ) {\r\n            setTimeout(() => {\r\n                const binStr = atob(\r\n                    this.toDataURL(type, quality).split(',')[1]\r\n                );\r\n                const len = binStr.length;\r\n                const arr = new Uint8Array(len);\r\n\r\n                for (let i = 0; i < len; i++) {\r\n                    arr[i] = binStr.charCodeAt(i);\r\n                }\r\n\r\n                callback(new Blob([arr], { type: type || 'image/png' }));\r\n            });\r\n        }\r\n    });\r\n});\r\n","import { Callbacks } from '../callbacks';\r\nimport { IPlayer } from '../iplayer';\r\nimport { PlayerFactory } from '../player-factory';\r\n\r\nimport { logger, SourceSet } from 'vchat-core';\r\n\r\nexport interface TestPlayerConfig {\r\n    name: string;\r\n    format: string | string[];\r\n    supported: boolean;\r\n\r\n    raiseErrorAfter?: number;\r\n}\r\n\r\nexport class DummyPlayerFactory implements PlayerFactory {\r\n    get format(): string | string[] {\r\n        return this.config.format;\r\n    }\r\n\r\n    private logName: string;\r\n\r\n    private config: TestPlayerConfig;\r\n\r\n    constructor(config: TestPlayerConfig) {\r\n        this.config = config;\r\n        this.logName = 'TestPlayerFactory[' + config.name + ']';\r\n    }\r\n\r\n    public isSupported(): boolean {\r\n        return this.config.supported;\r\n    }\r\n\r\n    public async create(\r\n        callbacks: Callbacks,\r\n        video: HTMLVideoElement\r\n    ): Promise<IPlayer> {\r\n        this.log('.create', video);\r\n\r\n        const cont: HTMLDivElement = document.createElement('div');\r\n        cont.style.width = '100%';\r\n        cont.style.height = '100%';\r\n\r\n        let sources = [];\r\n\r\n        const player = {\r\n            el: [cont],\r\n            name: 'dummy' + this.config.name,\r\n            play: (sourceSet: SourceSet, format: string): void => {\r\n                this.log('.play', sourceSet, format);\r\n                sources = sourceSet[format];\r\n                if (sources && sources.length > 0) {\r\n                    callbacks.onPlayStart(sources[0]);\r\n                }\r\n\r\n                if (this.config.raiseErrorAfter > 0) {\r\n                    setTimeout(() => {\r\n                        callbacks.onError('breakAfter');\r\n                    }, this.config.raiseErrorAfter);\r\n                }\r\n            },\r\n\r\n            stop: (): void => {\r\n                this.log('.stop');\r\n                callbacks.onPlayStop();\r\n            },\r\n\r\n            destroy: (): HTMLVideoElement => {\r\n                this.log('.destroy');\r\n                player.stop();\r\n\r\n                return null;\r\n            },\r\n\r\n            setVolume: (value): void => {\r\n                this.log('.setVolume', value);\r\n            }\r\n        };\r\n        return player;\r\n    }\r\n\r\n    private log(message: string, ...optionalParams: any[]): void {\r\n        const p = [\r\n            this.logName + (message.charAt(0) === '.' ? '' : ' ') + message\r\n        ].concat(optionalParams);\r\n        logger.log.apply(undefined, p);\r\n    }\r\n}\r\n","import { Callbacks } from '../../callbacks';\r\nimport { ErrorLevel } from '../../errorlevel';\r\nimport { IPlayer } from '../../iplayer';\r\nimport { MediaErrorExt } from '../../media-error-ext';\r\nimport { PlayerEvent, PlayModes } from '../../player';\r\nimport { PlayerFactory } from '../../player-factory';\r\nimport { PlayPromiseInfo } from '../../play-promise-info';\r\nimport { QualityBoundaries } from '../../quality-boundaries';\r\nimport { QualityLevel } from '../../quality-level';\r\nimport { BrowserName, BrowserOS, isBrowserVersion } from '../../utils';\r\n\r\nimport { logger, SourceSet } from 'vchat-core';\r\nimport { HlsJsPlayerConfig } from './hlsjs-player-config';\r\nimport * as Hls from 'hls.js';\r\n\r\nconst defaultQualityBoundaries: QualityBoundaries = {\r\n    low: 0,\r\n    medium: 250,\r\n    good: 500\r\n};\r\n\r\nconst defaultWaitingTimeout = 3000;\r\n\r\nconst ABORT_ERROR = 'AbortError';\r\nconst NOT_ALLOWED_ERROR = 'NotAllowedError';\r\nconst NS_ERROR_NOT_AVAILABLE = 'NS_ERROR_NOT_AVAILABLE';\r\n\r\n/**\r\n * A player for HLS streams using the hls.js JavaScript library.\r\n * supported format: hls\r\n * name:              HLSJS\r\n */\r\nexport class HlsJsPlayerFactory implements PlayerFactory {\r\n    public readonly format = 'hls';\r\n\r\n    private config: HlsJsPlayerConfig;\r\n\r\n    constructor(config?: HlsJsPlayerConfig) {\r\n        this.config = config || {};\r\n    }\r\n\r\n    public isSupported(): boolean {\r\n        /*\r\n         * enable Hls if browser supports Hls.js and guest uses one of the following (due to autoplay)\r\n         * - Desktop PC (non-Safari)\r\n         * - Firefox >= 49 on Android\r\n         * - Chrome >= 53 on Android (muted autoplay)\r\n         */\r\n        return (\r\n            Hls.isSupported() &&\r\n            !isBrowserVersion(BrowserName.SAFARI) &&\r\n            !isBrowserVersion(BrowserName.FIREFOX, 0, BrowserOS.ANDROID, 49) &&\r\n            !isBrowserVersion(BrowserName.CHROME, 0, BrowserOS.ANDROID, 53)\r\n        );\r\n    }\r\n\r\n    public async create(\r\n        callbacks: Callbacks,\r\n        video?: HTMLVideoElement\r\n    ): Promise<IPlayer> {\r\n        let supportsPlayPromise = false;\r\n        const dummyVideo = document.createElement('video');\r\n        const promise = dummyVideo.play();\r\n\r\n        if (promise) {\r\n            supportsPlayPromise = true;\r\n            promise.catch(() => {\r\n                /** noop */\r\n            });\r\n        }\r\n\r\n        let playMode = supportsPlayPromise\r\n            ? PlayModes.PROMISE_PLAY_UNMUTED\r\n            : PlayModes.AUTO_PLAY_UNMUTED;\r\n\r\n        if (!video) {\r\n            video = document.createElement('video');\r\n            video.volume = 1;\r\n            video.muted = false;\r\n        }\r\n\r\n        video.crossOrigin = 'anonymous';\r\n        video.controls = false;\r\n\r\n        video.style.width = '100%';\r\n        video.style.height = '100%';\r\n\r\n        if (!supportsPlayPromise) {\r\n            video.autoplay = true;\r\n        }\r\n\r\n        if (this.config.poster) {\r\n            video.poster = this.config.poster;\r\n        }\r\n\r\n        const hlsConfig = {\r\n            debug: false,\r\n            maxBufferLength: 3,\r\n            maxMaxBufferLength: 10,\r\n            capLevelToPlayerSize: true\r\n        };\r\n\r\n        let canvas: HTMLCanvasElement = null;\r\n\r\n        if (\r\n            this.config.useCanvasPoster ||\r\n            this.config.useCanvasPoster === undefined\r\n        ) {\r\n            canvas = document.createElement('canvas');\r\n            canvas.style.position = 'absolute';\r\n            canvas.style.left = '-100000px';\r\n            canvas.style.top = '0';\r\n        }\r\n\r\n        let quality: QualityLevel = 'low';\r\n        let currentSource = '';\r\n        let currentVideoWidth = 0;\r\n\r\n        let hls: Hls = null;\r\n\r\n        let sources = [];\r\n\r\n        let hlsIsLoading = false;\r\n        let streamPaused = false;\r\n\r\n        let hlsAbortErrorRetry = false;\r\n        let playTriggeredByUserInteraction = false;\r\n\r\n        let playerVolume = video.volume;\r\n\r\n        let canvasHideInterval = null;\r\n\r\n        let autoPlayTimeout = null;\r\n        let waitingTimeout = null;\r\n\r\n        const sendPlayInfo = (): void => {\r\n            callbacks.onPlayInfo({\r\n                width: video.videoWidth,\r\n                height: video.videoHeight,\r\n                quality: quality,\r\n                paused: video.paused,\r\n                volume: video.volume,\r\n                name: player.name,\r\n                source: currentSource\r\n            });\r\n        };\r\n\r\n        const videoResolutionChange = (videoWidth: number): void => {\r\n            let newQuality: QualityLevel = 'low';\r\n            const boundaries =\r\n                this.config.qualityBoundaries || defaultQualityBoundaries;\r\n\r\n            if (boundaries.good && videoWidth >= boundaries.good) {\r\n                newQuality = 'good';\r\n            } else if (boundaries.medium && videoWidth >= boundaries.medium) {\r\n                newQuality = 'medium';\r\n            }\r\n\r\n            if (newQuality !== quality || videoWidth !== currentVideoWidth) {\r\n                setQuality(newQuality);\r\n            }\r\n\r\n            currentVideoWidth = videoWidth;\r\n        };\r\n\r\n        const setQuality = (newQuality: QualityLevel): void => {\r\n            quality = newQuality;\r\n            sendPlayInfo();\r\n        };\r\n\r\n        const initHlsJs = (): void => {\r\n            if (hls) {\r\n                hls.destroy();\r\n            }\r\n\r\n            hls = new Hls(hlsConfig);\r\n\r\n            hls.attachMedia(video);\r\n\r\n            hls.on(Hls.Events.LEVEL_SWITCHED, () => {\r\n                videoResolutionChange(video.videoWidth);\r\n            });\r\n\r\n            hls.on(Hls.Events.LEVEL_LOADED, () => {\r\n                videoResolutionChange(video.videoWidth);\r\n            });\r\n\r\n            hls.on(Hls.Events.ERROR, (event, data) => {\r\n                logger.log('Hls.Events.ERROR', data);\r\n\r\n                // bufferStalledError\r\n                // bufferSeekOverHole\r\n                // bufferNudgeOnStall\r\n\r\n                // levelLoadError\r\n\r\n                const errorData = {\r\n                    event: event\r\n                };\r\n\r\n                if (data.type) {\r\n                    errorData['type'] = data.type;\r\n                }\r\n\r\n                if (data.fatal) {\r\n                    errorData['fatal'] = true;\r\n                }\r\n\r\n                if (data.details) {\r\n                    errorData['details'] = data.details;\r\n                }\r\n\r\n                callbacks.onPlayError(ErrorLevel.Info, errorData);\r\n\r\n                if (data.details == 'bufferNudgeOnStall') {\r\n                    // playNext()\r\n                    return;\r\n                }\r\n\r\n                if (data.details == Hls.ErrorDetails.FRAG_LOAD_ERROR) {\r\n                    logger.log('hls.ErrorDetails.FRAG_LOAD_ERROR');\r\n                }\r\n\r\n                if (data.fatal) {\r\n                    switch (data.type) {\r\n                        case Hls.ErrorTypes.NETWORK_ERROR:\r\n                            // try to recover network error\r\n                            logger.log(\r\n                                'fatal network error encountered, try to recover'\r\n                            );\r\n                            hlsIsLoading = true;\r\n                            hls.startLoad();\r\n                            break;\r\n                        case Hls.ErrorTypes.MEDIA_ERROR:\r\n                            logger.log(\r\n                                'fatal media error encountered, try to recover'\r\n                            );\r\n                            hls.recoverMediaError();\r\n                            break;\r\n                        default:\r\n                            logger.log(\r\n                                'fatal error encountered, cannot recover'\r\n                            );\r\n                            hls.destroy();\r\n                            callbacks.onError('media');\r\n                            break;\r\n                    }\r\n                }\r\n            });\r\n\r\n            hlsIsLoading = true;\r\n            hls.loadSource(currentSource);\r\n        };\r\n\r\n        const onCanPlay = (): void => {\r\n            if (!supportsPlayPromise) {\r\n                autoPlayTimeout = setTimeout(() => {\r\n                    if (!playTriggeredByUserInteraction) {\r\n                        play(true);\r\n                    } else {\r\n                        logPlay({\r\n                            name: 'AutoPlayError',\r\n                            message: 'AutoPlay failed'\r\n                        });\r\n\r\n                        onError();\r\n                    }\r\n                }, 500);\r\n            }\r\n        };\r\n\r\n        const onError = (): void => {\r\n            let errorCode = 0;\r\n            let errorMessage = '';\r\n\r\n            if (video && video.error) {\r\n                const errorExt: MediaErrorExt = video.error as MediaErrorExt;\r\n\r\n                errorCode = errorExt.code;\r\n                errorMessage = errorExt.message;\r\n            }\r\n\r\n            if (\r\n                errorCode === MediaError.MEDIA_ERR_DECODE ||\r\n                errorCode === MediaError.MEDIA_ERR_NETWORK\r\n            ) {\r\n                callbacks.onPlayError(ErrorLevel.Info, {\r\n                    code: errorCode,\r\n                    message: errorMessage\r\n                });\r\n                resumePlay();\r\n            } else {\r\n                callbacks.onError({ code: errorCode, message: errorMessage });\r\n            }\r\n        };\r\n\r\n        const onPause = (): void => {\r\n            if (!streamPaused) {\r\n                // TODO: try to restart stream?\r\n                callbacks.onSendMetrics(PlayerEvent.Pause);\r\n\r\n                hlsIsLoading = false;\r\n                hls.stopLoad();\r\n\r\n                // TODO: pause can be triggered by user (e.g. via Android Phone: notification bar -> pause button @ stream -> pauses stream and can only be restarted from the notification bar)\r\n                if (this.config.userInteractionCallback) {\r\n                    this.config.userInteractionCallback(resumeByButton);\r\n                }\r\n            }\r\n        };\r\n\r\n        const onPlayError = (error: string | DOMException): void => {\r\n            if (video && video.error) {\r\n                onError();\r\n            } else if (typeof error === 'string') {\r\n                callbacks.onPlayError(ErrorLevel.Info, { message: error });\r\n            } else if (typeof error === 'object') {\r\n                callbacks.onPlayError(ErrorLevel.Info, {\r\n                    name: error.name,\r\n                    message: error.message\r\n                });\r\n            } else {\r\n                callbacks.onError({ code: '1337', message: 'Unknown error' });\r\n            }\r\n        };\r\n\r\n        const onPlaying = (): void => {\r\n            if (autoPlayTimeout) {\r\n                clearTimeout(autoPlayTimeout);\r\n                autoPlayTimeout = null;\r\n            }\r\n\r\n            // force restart when stream lost focus and hence stopped load on hls\r\n            if (!hlsIsLoading) {\r\n                resumePlay();\r\n            } else {\r\n                callbacks.onSendMetrics(PlayerEvent.Playing);\r\n                sendPlayInfo();\r\n\r\n                // move the canvas\r\n                if (canvasHideInterval) {\r\n                    clearInterval(canvasHideInterval);\r\n                }\r\n\r\n                if (canvas) {\r\n                    canvasHideInterval = setInterval(canvasHide, 25);\r\n                }\r\n\r\n                if (waitingTimeout) {\r\n                    clearTimeout(waitingTimeout);\r\n                    waitingTimeout = null;\r\n                }\r\n            }\r\n        };\r\n\r\n        const onTimeUpdate = (): void => {\r\n            if (video.videoWidth > 0) {\r\n                canvasUpdate();\r\n            }\r\n        };\r\n\r\n        const onWaiting = (): void => {\r\n            if (!streamPaused) {\r\n                callbacks.onSendMetrics(PlayerEvent.Waiting);\r\n\r\n                if (waitingTimeout) {\r\n                    clearTimeout(waitingTimeout);\r\n                }\r\n\r\n                waitingTimeout = setTimeout(() => {\r\n                    setQuality('low');\r\n                }, this.config.waitingTimeout || defaultWaitingTimeout);\r\n            }\r\n        };\r\n\r\n        const onWindowResize = (): void => {\r\n            canvasUpdate();\r\n        };\r\n\r\n        const canvasUpdate = (): void => {\r\n            if (canvas) {\r\n                if (video.videoHeight > 0) {\r\n                    canvas.height = video.clientHeight;\r\n                    canvas.width = video.clientWidth;\r\n                }\r\n\r\n                window.requestAnimationFrame(canvasUpdateDo);\r\n            }\r\n        };\r\n\r\n        const canvasUpdateDo = (): void => {\r\n            if (canvas && video.readyState >= 2) {\r\n                try {\r\n                    // do not write directly to video's poster because it will be overwritten by hls.loadSource()\r\n                    canvas\r\n                        .getContext('2d')\r\n                        .drawImage(\r\n                            video,\r\n                            0,\r\n                            0,\r\n                            video.clientWidth,\r\n                            video.clientHeight\r\n                        );\r\n                } catch (error) {\r\n                    if (error.name === NS_ERROR_NOT_AVAILABLE) {\r\n                        // Wait a bit before trying again\r\n                        setTimeout(canvasUpdateDo, 1);\r\n                    } else {\r\n                        throw error;\r\n                    }\r\n                }\r\n            }\r\n        };\r\n\r\n        const canvasHide = (): void => {\r\n            if (canvas && video.videoWidth) {\r\n                canvas.style.left = '-100000px';\r\n\r\n                clearInterval(canvasHideInterval);\r\n                canvasHideInterval = null;\r\n            }\r\n        };\r\n\r\n        const resumePlay = (): void => {\r\n            if (canvas) {\r\n                canvas.style.left = '0';\r\n            }\r\n\r\n            if (waitingTimeout) {\r\n                clearTimeout(waitingTimeout);\r\n            }\r\n\r\n            waitingTimeout = setTimeout(() => {\r\n                setQuality('low');\r\n            }, this.config.waitingTimeout || defaultWaitingTimeout);\r\n\r\n            // combination of both, hls.startLoad and play() is necessary in order to continue the stream (play) and to jump to the current position (startLoad)\r\n            // re-init HLS in order to make sure HLS really fetches a fresh chunklist (avoids bufferStalled errors)\r\n            // timeout is necessary to give canvas enough time to be put in place\r\n            setTimeout(() => {\r\n                initHlsJs();\r\n                play(false);\r\n            }, 100);\r\n\r\n            callbacks.onSendMetrics(PlayerEvent.Load);\r\n        };\r\n\r\n        video.addEventListener('canplay', onCanPlay, true);\r\n        video.addEventListener('pause', onPause, true);\r\n        video.addEventListener('playing', onPlaying, true);\r\n        video.addEventListener('timeupdate', onTimeUpdate, true);\r\n        video.addEventListener('waiting', onWaiting, true);\r\n\r\n        window.addEventListener('resize', onWindowResize);\r\n\r\n        const logPlay = (error: Error = null): void => {\r\n            const videoData = {\r\n                muted: video.muted,\r\n                paused: video.paused,\r\n                volume: video.volume\r\n            };\r\n\r\n            const playerInfo: PlayPromiseInfo = {\r\n                playMode: playMode,\r\n                success: !error,\r\n                videoElement: videoData,\r\n                volume: playerVolume\r\n            };\r\n\r\n            if (error) {\r\n                playerInfo.error = error.name;\r\n                playerInfo.errorMsg = error.message;\r\n            }\r\n\r\n            callbacks.onSendMetrics(PlayerEvent.Play, playerInfo);\r\n\r\n            if (this.config.playLogger) {\r\n                this.config.playLogger(playerInfo);\r\n            }\r\n        };\r\n\r\n        const play = (mute = false, button = false): void => {\r\n            if (supportsPlayPromise) {\r\n                video\r\n                    .play()\r\n                    .then(() => {\r\n                        logPlay();\r\n                    })\r\n                    .catch((error) => {\r\n                        logPlay(error);\r\n                        if (\r\n                            error.name === NOT_ALLOWED_ERROR ||\r\n                            error.name === ABORT_ERROR\r\n                        ) {\r\n                            if (button) {\r\n                                onPlayError(error);\r\n                            } else if (\r\n                                error.name == ABORT_ERROR &&\r\n                                !hlsAbortErrorRetry\r\n                            ) {\r\n                                // retry once to cover occurring load() interrupts play()\r\n                                hlsAbortErrorRetry = true;\r\n                                setTimeout(() => {\r\n                                    play();\r\n                                }, 50);\r\n                            } else if (!video.muted) {\r\n                                playerVolume = 0;\r\n\r\n                                video.muted = true;\r\n                                video.volume = 0;\r\n\r\n                                playMode = PlayModes.PROMISE_PLAY_MUTED;\r\n\r\n                                callbacks.onVolumeChange(0);\r\n\r\n                                play();\r\n                            } else {\r\n                                if (this.config.userInteractionCallback) {\r\n                                    playMode = PlayModes.PROMISE_PLAY_BUTTON;\r\n\r\n                                    this.config.userInteractionCallback(\r\n                                        playByButton\r\n                                    );\r\n                                } else {\r\n                                    onPlayError(\r\n                                        'No userInteractionCallback set'\r\n                                    );\r\n                                }\r\n                            }\r\n                        } else {\r\n                            onPlayError(error);\r\n                        }\r\n                    });\r\n            } else {\r\n                if (mute) {\r\n                    logPlay({\r\n                        name: 'AutoPlayError',\r\n                        message: 'AutoPlay failed'\r\n                    });\r\n\r\n                    if (!video.muted) {\r\n                        playerVolume = 0;\r\n\r\n                        video.muted = true;\r\n                        video.volume = 0;\r\n\r\n                        playMode = PlayModes.AUTO_PLAY_MUTED;\r\n\r\n                        callbacks.onVolumeChange(0);\r\n\r\n                        video.play();\r\n                    } else {\r\n                        if (this.config.userInteractionCallback) {\r\n                            playMode = PlayModes.AUTO_PLAY_BUTTON;\r\n\r\n                            this.config.userInteractionCallback(playByButton);\r\n                        } else {\r\n                            onPlayError('No userInteractionCallback set');\r\n                        }\r\n                    }\r\n                } else {\r\n                    video.play();\r\n                }\r\n            }\r\n        };\r\n\r\n        const playByButton = (e): void => {\r\n            if (e && e.cancelable) {\r\n                e.preventDefault();\r\n                e.stopPropagation();\r\n            }\r\n\r\n            playerVolume = 1;\r\n\r\n            video.muted = false;\r\n            video.volume = 1;\r\n\r\n            callbacks.onVolumeChange(1);\r\n\r\n            play(false, true);\r\n\r\n            playTriggeredByUserInteraction = true;\r\n        };\r\n\r\n        const resumeByButton = (e): void => {\r\n            if (e && e.cancelable) {\r\n                e.preventDefault();\r\n                e.stopPropagation();\r\n            }\r\n\r\n            resumePlay();\r\n        };\r\n\r\n        const playNext = (): void => {\r\n            const source = sources.shift();\r\n            if (source) {\r\n                currentSource = source.stream;\r\n\r\n                initHlsJs();\r\n\r\n                callbacks.onPlayStart(source);\r\n\r\n                sendPlayInfo();\r\n\r\n                play();\r\n            } else {\r\n                callbacks.onError('source');\r\n            }\r\n        };\r\n\r\n        const player: IPlayer = {\r\n            el: [video, canvas],\r\n            name: 'HLSJS',\r\n            play: (sourceSet: SourceSet) => {\r\n                sources = sourceSet.hls ? sourceSet.hls.slice() : [];\r\n\r\n                playNext();\r\n\r\n                if (streamPaused) {\r\n                    streamPaused = false;\r\n                }\r\n            },\r\n\r\n            stop: () => {\r\n                if (canvas) {\r\n                    canvas.style.left = '0';\r\n                }\r\n\r\n                video.pause();\r\n                hls.stopLoad();\r\n                callbacks.onPlayStop();\r\n\r\n                hlsIsLoading = false;\r\n                streamPaused = true;\r\n            },\r\n\r\n            destroy: () => {\r\n                // do clean up since video element will be reused\r\n                video.removeEventListener('canplay', onCanPlay, true);\r\n                video.removeEventListener('pause', onPause, true);\r\n                video.removeEventListener('playing', onPlaying, true);\r\n                video.removeEventListener('timeupdate', onTimeUpdate, true);\r\n                video.removeEventListener('waiting', onWaiting, true);\r\n\r\n                window.removeEventListener('resize', onWindowResize);\r\n\r\n                if (canvasHideInterval) {\r\n                    clearInterval(canvasHideInterval);\r\n                }\r\n\r\n                player.stop();\r\n                hls.destroy();\r\n\r\n                // clean up video element\r\n                video.crossOrigin = null;\r\n                video.controls = false;\r\n                video.style.width = null;\r\n                video.style.height = null;\r\n                video.removeAttribute('autoplay');\r\n\r\n                return video;\r\n            },\r\n\r\n            setVolume: (value) => {\r\n                playerVolume = value;\r\n\r\n                video.volume = value;\r\n                video.muted = !value;\r\n            }\r\n        };\r\n        return player;\r\n    }\r\n}\r\n","module.exports = __WEBPACK_EXTERNAL_MODULE__83__;","import { Provider } from 'vchat-core';\r\nimport { JpegUploadSettings } from './jpeg-upload-settings';\r\n\r\nexport class VideoElementFrameProvider implements Provider {\r\n    private _errorCallback?: (error: Error) => void;\r\n    private _canvas: HTMLCanvasElement = document.createElement('canvas');\r\n    private _videoElement: HTMLVideoElement;\r\n    private _jpegUploadSettings: JpegUploadSettings;\r\n\r\n    constructor(\r\n        videoElement: HTMLVideoElement,\r\n        jpegUploadSettings: JpegUploadSettings,\r\n        errorCallback?: (error: Error) => void\r\n    ) {\r\n        if (!videoElement) {\r\n            throw new Error('videoElement must not be undefined');\r\n        }\r\n        this._errorCallback = errorCallback;\r\n        this._videoElement = videoElement;\r\n        this._jpegUploadSettings = jpegUploadSettings;\r\n\r\n        const mediaStream: MediaStream = videoElement.srcObject as MediaStream;\r\n        const videoTrackSettings = mediaStream\r\n            .getVideoTracks()[0]\r\n            .getSettings();\r\n        const aspectRatio =\r\n            videoTrackSettings.aspectRatio ||\r\n            videoTrackSettings.width / videoTrackSettings.height;\r\n\r\n        this._canvas.width = this._jpegUploadSettings.width;\r\n        this._canvas.height = this._jpegUploadSettings.width / aspectRatio;\r\n    }\r\n\r\n    public async getSnapshot(): Promise<Blob> {\r\n        this._canvas\r\n            .getContext('2d')\r\n            .drawImage(\r\n                this._videoElement,\r\n                0,\r\n                0,\r\n                this._canvas.width,\r\n                this._canvas.height\r\n            );\r\n\r\n        return new Promise<Blob>((res) =>\r\n            this._canvas.toBlob(\r\n                res,\r\n                'image/jpeg',\r\n                this._jpegUploadSettings.quality\r\n            )\r\n        );\r\n    }\r\n    public onError?(error: Error): void {\r\n        if (this._errorCallback) {\r\n            this._errorCallback(error);\r\n        }\r\n    }\r\n}\r\n","module.exports = __WEBPACK_EXTERNAL_MODULE__85__;","import { Callbacks } from '../callbacks';\r\nimport { ErrorLevel } from '../errorlevel';\r\nimport { IPlayer } from '../iplayer';\r\nimport { MediaErrorExt } from '../media-error-ext';\r\nimport { PlayPromiseInfo } from '../play-promise-info';\r\nimport { PlayerEvent, PlayModes } from '../player';\r\nimport { PlayerFactory } from '../player-factory';\r\nimport { QualityBoundaries } from '../quality-boundaries';\r\nimport { QualityLevel } from '../quality-level';\r\nimport { BrowserName, BrowserOS, isBrowserVersion } from '../utils';\r\n\r\nimport { SourceSet } from 'vchat-core';\r\n\r\nconst defaultQualityBoundaries: QualityBoundaries = {\r\n    low: 0,\r\n    medium: 250,\r\n    good: 500\r\n};\r\n\r\nconst defaultWaitingTimeout = 3000;\r\n\r\nconst ABORT_ERROR = 'AbortError';\r\nconst NOT_ALLOWED_ERROR = 'NotAllowedError';\r\nconst NS_ERROR_NOT_AVAILABLE = 'NS_ERROR_NOT_AVAILABLE';\r\n\r\nexport interface HlsPlayerConfig {\r\n    /** called when either a play() call was successful or the play() call failed;\r\n     * this function receives a playInfo object (see [PlayPromiseInfo])\r\n     * */\r\n    playLogger?: (playInfo: PlayPromiseInfo) => void;\r\n    /** a path to a poster to be set on the video element */\r\n    poster?: string;\r\n    /** an object with attributes low, medium, good indicating which quality level is reached at what resolution (the value to each key is the minimal video width) */\r\n    qualityBoundaries?: QualityBoundaries;\r\n    /** in milliseconds, time until a new play() call will be triggered when the stream does not recover in time */\r\n    recoverTimeout?: number;\r\n    /** this function retrieves a certain reloadFunction which provides an additional play button on Apple devices in the rare case that the stream is active but the video image is stuck */\r\n    reloadCallback?: (reloadFunc: (e) => void) => void;\r\n    /** when set to true a separate canvas is used instead of the video elements own poster attribute in order to provide a valid image whenever the video element is stuck */\r\n    useCanvasPoster?: boolean;\r\n    /** called when the video elements throws a pause event or when the automatic playback failed; receives a function as first parameter; this function can then be used to trigger a new play() event on the video element */\r\n    userInteractionCallback?: (userInteractionFunc: (e) => void) => void;\r\n    /** timeout in milliseconds (starting when the video element throws a waiting event) until the player is torn down and the vchat-player tries the next one */\r\n    waitingTimeout?: number;\r\n}\r\n\r\n/**\r\nA player for HLS streams using the native HLS implementation of the browser (currently available on Apple devices and in Chrome on Android).\r\n\r\n* supported format:  hls\r\n* name:              HLS_NATIVE\r\n */\r\nexport class HlsPlayerFactory implements PlayerFactory {\r\n    public readonly format = 'hls';\r\n\r\n    private config: HlsPlayerConfig;\r\n\r\n    constructor(config?: HlsPlayerConfig) {\r\n        this.config = config || {};\r\n    }\r\n\r\n    public isSupported(): boolean {\r\n        /*\r\n         * currently limited to browsers with support for autoplay\r\n         * - Safari >= 10 (muted autoplay)\r\n         * - Chrome >= 53 (on iOS / Android)\r\n         */\r\n        return (\r\n            isBrowserVersion(BrowserName.SAFARI, 10) ||\r\n            isBrowserVersion(BrowserName.CHROME, 53, BrowserOS.IOS) ||\r\n            isBrowserVersion(BrowserName.CHROME, 53, BrowserOS.ANDROID)\r\n        );\r\n    }\r\n\r\n    public async create(\r\n        callbacks: Callbacks,\r\n        video: HTMLVideoElement\r\n    ): Promise<IPlayer> {\r\n        let supportsPlayPromise = false;\r\n        const dummyVideo = document.createElement('video');\r\n        const promise = dummyVideo.play();\r\n\r\n        if (promise) {\r\n            supportsPlayPromise = true;\r\n            promise.catch(() => {\r\n                /** noop */\r\n            });\r\n        }\r\n\r\n        let playMode = supportsPlayPromise\r\n            ? PlayModes.PROMISE_PLAY_UNMUTED\r\n            : PlayModes.AUTO_PLAY_UNMUTED;\r\n\r\n        if (!video) {\r\n            video = document.createElement('video');\r\n            video.volume = 1;\r\n            video.muted = false;\r\n        }\r\n\r\n        video.crossOrigin = 'anonymous';\r\n        video.controls = false;\r\n        video.style.width = '100%';\r\n        video.style.height = '100%';\r\n\r\n        if (!supportsPlayPromise) {\r\n            video.autoplay = true;\r\n        }\r\n\r\n        if (this.config.poster) {\r\n            video.poster = this.config.poster;\r\n        }\r\n\r\n        video.setAttribute('playsinline', 'true');\r\n\r\n        let canvas: HTMLCanvasElement = null;\r\n\r\n        if (\r\n            this.config.useCanvasPoster ||\r\n            this.config.useCanvasPoster === undefined\r\n        ) {\r\n            canvas = document.createElement('canvas');\r\n            canvas.style.position = 'absolute';\r\n            canvas.style.left = '-100000px';\r\n            canvas.style.top = '0';\r\n        }\r\n\r\n        let quality: QualityLevel = 'low';\r\n        let currentSource = '';\r\n        let currentVideoWidth = 0;\r\n\r\n        let sources = [];\r\n\r\n        let hlsAbortErrorRetry = false;\r\n        let playTriggeredByUserInteraction = false;\r\n\r\n        let isPlaying = false;\r\n        let isStopped = false;\r\n\r\n        let playerVolume = video.volume;\r\n        let lastTimeUpdate = 0;\r\n        let preFirstFrameCounter = 0;\r\n\r\n        let canvasHideInterval = null;\r\n        let heartBeatInterval = null;\r\n\r\n        let autoPlayTimeout = null;\r\n        let waitingTimeout: number = null;\r\n\r\n        let controlsShown = false;\r\n\r\n        const sendPlayInfo = (): void => {\r\n            callbacks.onPlayInfo({\r\n                width: video.videoWidth,\r\n                height: video.videoHeight,\r\n                quality: quality,\r\n                volume: video.volume,\r\n                paused: video.paused,\r\n                name: player.name,\r\n                source: currentSource\r\n            });\r\n        };\r\n\r\n        const setQuality = (newQuality: QualityLevel): void => {\r\n            quality = newQuality;\r\n            sendPlayInfo();\r\n        };\r\n\r\n        const videoResolutionChange = (videoWidth: number): void => {\r\n            if (!isStopped) {\r\n                let newQuality: QualityLevel = 'low';\r\n                const boundaries =\r\n                    this.config.qualityBoundaries || defaultQualityBoundaries;\r\n\r\n                if (boundaries.good && videoWidth >= boundaries.good) {\r\n                    newQuality = 'good';\r\n                } else if (\r\n                    boundaries.medium &&\r\n                    videoWidth >= boundaries.medium\r\n                ) {\r\n                    newQuality = 'medium';\r\n                }\r\n\r\n                if (\r\n                    newQuality !== quality ||\r\n                    videoWidth !== currentVideoWidth\r\n                ) {\r\n                    setQuality(newQuality);\r\n                }\r\n\r\n                currentVideoWidth = videoWidth;\r\n            }\r\n        };\r\n\r\n        const onCanPlay = (): void => {\r\n            if (!supportsPlayPromise) {\r\n                autoPlayTimeout = setTimeout(() => {\r\n                    if (!playTriggeredByUserInteraction) {\r\n                        play(true);\r\n                    } else {\r\n                        logPlay({\r\n                            name: 'AutoPlayError',\r\n                            message: 'AutoPlay failed'\r\n                        });\r\n\r\n                        onError();\r\n                    }\r\n                }, 500);\r\n            }\r\n        };\r\n\r\n        const onEnded = (): void => {\r\n            callbacks.onError('ended');\r\n        };\r\n\r\n        const onError = (): void => {\r\n            // ignore errors after stream is stopped\r\n            if (!isStopped) {\r\n                let errorCode = 0;\r\n                let errorMessage = '';\r\n\r\n                if (video && video.error) {\r\n                    const errorExt: MediaErrorExt = video.error as MediaErrorExt;\r\n\r\n                    errorCode = errorExt.code;\r\n                    errorMessage = errorExt.message;\r\n                }\r\n\r\n                if (\r\n                    errorCode === MediaError.MEDIA_ERR_DECODE ||\r\n                    errorCode === MediaError.MEDIA_ERR_NETWORK\r\n                ) {\r\n                    callbacks.onPlayError(ErrorLevel.Info, {\r\n                        code: errorCode,\r\n                        message: errorMessage\r\n                    });\r\n                    resumePlay();\r\n                } else {\r\n                    callbacks.onError({\r\n                        code: errorCode,\r\n                        message: errorMessage\r\n                    });\r\n                }\r\n            }\r\n        };\r\n\r\n        const onHeartBeat = (): void => {\r\n            let recoverTimeout = this.config.recoverTimeout || 2000;\r\n\r\n            if (preFirstFrameCounter > 0) {\r\n                recoverTimeout *= 3;\r\n            }\r\n\r\n            if (\r\n                isPlaying &&\r\n                lastTimeUpdate &&\r\n                window.performance.now() - recoverTimeout > lastTimeUpdate\r\n            ) {\r\n                resumePlay();\r\n            }\r\n        };\r\n\r\n        const onPause = (): void => {\r\n            if (!isStopped) {\r\n                callbacks.onSendMetrics(PlayerEvent.Pause);\r\n\r\n                if (isPlaying) {\r\n                    isPlaying = false;\r\n                    // TODO: startStream again?\r\n\r\n                    // TODO: pause can be triggered by user (e.g. via Android Phone: notification bar -> pause button @ stream -> pauses stream and can only be restarted from the notification bar)\r\n                    if (this.config.userInteractionCallback) {\r\n                        this.config.userInteractionCallback(resumeByButton);\r\n                    }\r\n                }\r\n            }\r\n        };\r\n\r\n        const onPlayError = (error: string | DOMException): void => {\r\n            if (video && video.error) {\r\n                onError();\r\n            } else if (typeof error === 'string') {\r\n                callbacks.onPlayError(ErrorLevel.Info, { message: error });\r\n            } else if (typeof error === 'object') {\r\n                callbacks.onPlayError(ErrorLevel.Info, {\r\n                    name: error.name,\r\n                    message: error.message\r\n                });\r\n            } else {\r\n                callbacks.onError({ code: '1337', message: 'Unknown error' });\r\n            }\r\n        };\r\n\r\n        const onPlaying = (): void => {\r\n            isPlaying = true;\r\n            // isInitialPlayProcessed = true\r\n\r\n            if (autoPlayTimeout) {\r\n                clearTimeout(autoPlayTimeout);\r\n                autoPlayTimeout = null;\r\n            }\r\n\r\n            callbacks.onSendMetrics(PlayerEvent.Playing);\r\n            sendPlayInfo();\r\n\r\n            // move the canvas\r\n            if (canvasHideInterval) {\r\n                clearInterval(canvasHideInterval);\r\n            }\r\n\r\n            if (canvas) {\r\n                canvasHideInterval = setInterval(canvasHide, 25);\r\n            }\r\n\r\n            if (waitingTimeout) {\r\n                window.clearTimeout(waitingTimeout);\r\n                waitingTimeout = null;\r\n            }\r\n\r\n            if (controlsShown) {\r\n                video.controls = false;\r\n                controlsShown = false;\r\n            }\r\n        };\r\n\r\n        const onTimeUpdate = (): void => {\r\n            if (isPlaying && video.videoWidth > 0) {\r\n                videoResolutionChange(video.videoWidth);\r\n                canvasUpdate();\r\n\r\n                if (waitingTimeout) {\r\n                    clearTimeout(waitingTimeout);\r\n                    waitingTimeout = null;\r\n                }\r\n\r\n                if (preFirstFrameCounter === 2) {\r\n                    preFirstFrameCounter = 0;\r\n                } else if (preFirstFrameCounter > 0) {\r\n                    preFirstFrameCounter++;\r\n                }\r\n            }\r\n\r\n            lastTimeUpdate = window.performance.now();\r\n        };\r\n\r\n        const onWaiting = (): void => {\r\n            if (!isStopped) {\r\n                callbacks.onSendMetrics(PlayerEvent.Waiting);\r\n\r\n                if (waitingTimeout) {\r\n                    clearTimeout(waitingTimeout);\r\n                }\r\n\r\n                waitingTimeout = window.setTimeout(() => {\r\n                    setQuality('low');\r\n                }, this.config.waitingTimeout || defaultWaitingTimeout);\r\n            }\r\n        };\r\n\r\n        const onWindowResize = (): void => {\r\n            canvasUpdate();\r\n        };\r\n\r\n        const canvasUpdate = (): void => {\r\n            if (canvas) {\r\n                if (video.videoHeight > 0) {\r\n                    canvas.height = video.clientHeight;\r\n                    canvas.width = video.clientWidth;\r\n                }\r\n\r\n                window.requestAnimationFrame(canvasUpdateDo);\r\n            }\r\n        };\r\n\r\n        const canvasUpdateDo = (): void => {\r\n            if (canvas && video.readyState >= 2) {\r\n                try {\r\n                    // do not write directly to video's poster because it will be overwritten by hls.loadSource()\r\n                    canvas\r\n                        .getContext('2d')\r\n                        .drawImage(\r\n                            video,\r\n                            0,\r\n                            0,\r\n                            video.clientWidth,\r\n                            video.clientHeight\r\n                        );\r\n                } catch (error) {\r\n                    if (error.name === NS_ERROR_NOT_AVAILABLE) {\r\n                        // Wait a bit before trying again\r\n                        setTimeout(canvasUpdateDo, 1);\r\n                    } else {\r\n                        throw error;\r\n                    }\r\n                }\r\n            }\r\n            // TODO: directly write to poster? not working in Safari 10 (no cross-origin setting on video), only on readyState >= 2\r\n            // video.poster = canvas.toDataURL('image/png')\r\n        };\r\n\r\n        const canvasHide = (): void => {\r\n            if (canvas && video.videoWidth) {\r\n                canvas.style.left = '-100000px';\r\n\r\n                clearInterval(canvasHideInterval);\r\n                canvasHideInterval = null;\r\n            }\r\n        };\r\n\r\n        const resumePlay = (fromButton = false, reload = false): void => {\r\n            if (canvas) {\r\n                canvas.style.left = '0';\r\n            }\r\n\r\n            if (waitingTimeout) {\r\n                clearTimeout(waitingTimeout);\r\n            }\r\n\r\n            waitingTimeout = window.setTimeout(() => {\r\n                setQuality('low');\r\n            }, this.config.waitingTimeout || defaultWaitingTimeout);\r\n\r\n            isPlaying = false;\r\n\r\n            // timeout is necessary to give canvas enough time to be put in place\r\n            setTimeout(() => {\r\n                video.load();\r\n\r\n                play(false, fromButton);\r\n            }, 100);\r\n\r\n            if (reload) {\r\n                callbacks.onSendMetrics(PlayerEvent.Reload);\r\n            } else {\r\n                callbacks.onSendMetrics(PlayerEvent.Load);\r\n            }\r\n        };\r\n\r\n        video.addEventListener('canplay', onCanPlay, true);\r\n        video.addEventListener('ended', onEnded, true);\r\n        video.addEventListener('error', onError, true);\r\n        video.addEventListener('pause', onPause, true);\r\n        video.addEventListener('playing', onPlaying, true);\r\n        video.addEventListener('timeupdate', onTimeUpdate, true);\r\n        video.addEventListener('waiting', onWaiting, true);\r\n\r\n        window.addEventListener('resize', onWindowResize);\r\n\r\n        heartBeatInterval = setInterval(onHeartBeat, 250);\r\n\r\n        const logPlay = (error: Error = null): void => {\r\n            const videoData = {\r\n                muted: video.muted,\r\n                paused: video.paused,\r\n                volume: video.volume\r\n            };\r\n\r\n            const playerInfo: PlayPromiseInfo = {\r\n                playMode: playMode,\r\n                success: !error,\r\n                videoElement: videoData,\r\n                volume: playerVolume\r\n            };\r\n\r\n            if (error) {\r\n                playerInfo.error = error.name;\r\n                playerInfo.errorMsg = error.message;\r\n            }\r\n\r\n            callbacks.onSendMetrics(PlayerEvent.Play, playerInfo);\r\n\r\n            if (this.config.playLogger) {\r\n                this.config.playLogger(playerInfo);\r\n            }\r\n        };\r\n\r\n        const play = (mute = false, button = false): void => {\r\n            isStopped = false;\r\n            preFirstFrameCounter = 1;\r\n\r\n            if (supportsPlayPromise) {\r\n                video\r\n                    .play()\r\n                    .then(() => {\r\n                        logPlay();\r\n                    })\r\n                    .catch((error) => {\r\n                        logPlay(error);\r\n                        if (\r\n                            error.name === NOT_ALLOWED_ERROR ||\r\n                            error.name === ABORT_ERROR\r\n                        ) {\r\n                            if (button) {\r\n                                onPlayError(error);\r\n                            } else if (\r\n                                error.name == ABORT_ERROR &&\r\n                                !hlsAbortErrorRetry\r\n                            ) {\r\n                                // retry once to cover occurring load() interrupts play()\r\n                                hlsAbortErrorRetry = true;\r\n                                setTimeout(() => {\r\n                                    play();\r\n                                }, 50);\r\n                            } else if (!video.muted) {\r\n                                playerVolume = 0;\r\n\r\n                                video.muted = true;\r\n                                video.volume = 0;\r\n\r\n                                playMode = PlayModes.PROMISE_PLAY_MUTED;\r\n\r\n                                callbacks.onVolumeChange(0);\r\n\r\n                                play();\r\n                            } else {\r\n                                if (this.config.userInteractionCallback) {\r\n                                    playMode = PlayModes.PROMISE_PLAY_BUTTON;\r\n\r\n                                    this.config.userInteractionCallback(\r\n                                        playByButton\r\n                                    );\r\n\r\n                                    if (error.name === NOT_ALLOWED_ERROR) {\r\n                                        onPlayError(\r\n                                            NOT_ALLOWED_ERROR +\r\n                                                ': Try controls play'\r\n                                        );\r\n                                        video.controls = true;\r\n                                        controlsShown = true;\r\n                                    }\r\n                                } else {\r\n                                    onPlayError(\r\n                                        'No userInteractionCallback set'\r\n                                    );\r\n                                }\r\n                            }\r\n                        } else {\r\n                            onPlayError(error);\r\n                        }\r\n                    });\r\n            } else {\r\n                if (mute) {\r\n                    logPlay({\r\n                        name: 'AutoPlayError',\r\n                        message: 'AutoPlay failed'\r\n                    });\r\n\r\n                    if (!video.muted) {\r\n                        playerVolume = 0;\r\n\r\n                        video.muted = true;\r\n                        video.volume = 0;\r\n\r\n                        playMode = PlayModes.AUTO_PLAY_MUTED;\r\n\r\n                        callbacks.onVolumeChange(0);\r\n\r\n                        video.play();\r\n                    } else {\r\n                        if (this.config.userInteractionCallback) {\r\n                            playMode = PlayModes.AUTO_PLAY_BUTTON;\r\n\r\n                            this.config.userInteractionCallback(playByButton);\r\n                        } else {\r\n                            onPlayError('No userInteractionCallback set');\r\n                        }\r\n                    }\r\n                } else {\r\n                    video.play();\r\n                }\r\n            }\r\n        };\r\n\r\n        const playByButton = (e): void => {\r\n            if (e && e.cancelable) {\r\n                e.preventDefault();\r\n                e.stopPropagation();\r\n            }\r\n\r\n            playerVolume = 1;\r\n\r\n            video.muted = false;\r\n            video.volume = 1;\r\n\r\n            callbacks.onVolumeChange(1);\r\n\r\n            play(false, true);\r\n\r\n            playTriggeredByUserInteraction = true;\r\n        };\r\n\r\n        const resumeByButton = (e): void => {\r\n            if (e && e.cancelable) {\r\n                e.preventDefault();\r\n                e.stopPropagation();\r\n            }\r\n\r\n            resumePlay(true);\r\n        };\r\n\r\n        const playNext = (): void => {\r\n            const source = sources.shift();\r\n            if (source) {\r\n                removeSources(video);\r\n\r\n                callbacks.onPlayStart(source);\r\n\r\n                currentSource = source.stream;\r\n\r\n                sendPlayInfo();\r\n\r\n                const srcElement = document.createElement('source');\r\n                srcElement.src = currentSource;\r\n                srcElement.type = 'video/mp4';\r\n\r\n                video.append(srcElement);\r\n\r\n                play();\r\n            } else {\r\n                callbacks.onError('source');\r\n            }\r\n        };\r\n\r\n        const player: IPlayer = {\r\n            el: [video, canvas],\r\n            name: 'HLS_NATIVE',\r\n            play: (sourceSet: SourceSet) => {\r\n                sources = sourceSet.hls ? sourceSet.hls.slice() : [];\r\n                playNext();\r\n            },\r\n\r\n            stop: () => {\r\n                isPlaying = false;\r\n                isStopped = true;\r\n\r\n                // move canvas into position as a poster-replacement (Safari 10 / 11 does not support crossOrigin setting on video hence the canvas cannot export its data to the video element's poster attribute)\r\n                if (canvas) {\r\n                    canvas.style.left = '0';\r\n                }\r\n\r\n                // special clean up for HLS on iOS to force stop load\r\n                video.pause();\r\n                removeSources(video);\r\n                video.removeAttribute('src');\r\n                video.preload = 'none';\r\n\r\n                try {\r\n                    video.load();\r\n                } catch (error) {\r\n                    // do nothing\r\n                }\r\n\r\n                callbacks.onPlayStop();\r\n\r\n                if (waitingTimeout) {\r\n                    clearTimeout(waitingTimeout);\r\n                    waitingTimeout = null;\r\n                }\r\n            },\r\n\r\n            destroy: () => {\r\n                // do clean up since video element will be reused\r\n                removeSources(video);\r\n                video.removeEventListener('ended', onEnded, true);\r\n                video.removeEventListener('error', onError, true);\r\n                video.removeEventListener('canplay', onCanPlay, true);\r\n                video.removeEventListener('pause', onPause, true);\r\n                video.removeEventListener('playing', onPlaying, true);\r\n                video.removeEventListener('timeupdate', onTimeUpdate, true);\r\n                video.removeEventListener('waiting', onWaiting, true);\r\n\r\n                window.removeEventListener('resize', onWindowResize);\r\n\r\n                clearInterval(heartBeatInterval);\r\n\r\n                if (canvasHideInterval) {\r\n                    clearInterval(canvasHideInterval);\r\n                }\r\n\r\n                player.stop();\r\n                // .destroy()\r\n\r\n                // clean up video element\r\n                video.crossOrigin = null;\r\n                video.controls = false;\r\n                video.style.width = null;\r\n                video.style.height = null;\r\n                video.removeAttribute('autoplay');\r\n\r\n                return video;\r\n            },\r\n\r\n            setVolume: (value) => {\r\n                playerVolume = value;\r\n\r\n                video.volume = value;\r\n                video.muted = !value;\r\n            }\r\n        };\r\n\r\n        if (this.config.reloadCallback) {\r\n            this.config.reloadCallback((e): void => {\r\n                if (e && e.cancelable) {\r\n                    e.preventDefault();\r\n                    e.stopPropagation();\r\n                }\r\n\r\n                resumePlay(true, true);\r\n            });\r\n        }\r\n\r\n        return player;\r\n    }\r\n}\r\n\r\nfunction removeSources(video: HTMLVideoElement): void {\r\n    for (let c = video.children.length - 1; c >= 0; c--) {\r\n        video.removeChild(video.children[c]);\r\n    }\r\n}\r\n","import { logger, PicStream, Source, SourceSet } from 'vchat-core';\r\nimport { Callbacks } from '../callbacks';\r\nimport { IPlayer } from '../iplayer';\r\nimport { PlayInfo } from '../play-info';\r\nimport { PlayerFactory } from '../player-factory';\r\n\r\nexport interface JpegPlayerConfig {\r\n    /** called when the player has successfully been initialized; it retrieves a parameter hasAudio which indicates whether or not the player started with audio */\r\n    initCallback?: (hasAudio: boolean) => void;\r\n    /** when set to true the additional audio stream will not be loaded; it is advisable to deactivate audio at the moment due to some quality issues */\r\n    noAudio?: boolean;\r\n}\r\n\r\n/**\r\n * A player for a JPEG stream (using the PicStream class from vchat-core). In addition an mp3 or OGG/Vorbis stream can be played to add sound to the images.\r\n */\r\nexport class JpegPlayerFactory implements PlayerFactory {\r\n    public readonly format = 'jpeg';\r\n\r\n    private config: JpegPlayerConfig;\r\n\r\n    constructor(config?: JpegPlayerConfig) {\r\n        this.config = config || {};\r\n    }\r\n\r\n    public isSupported(): boolean {\r\n        return true;\r\n    }\r\n\r\n    public async create(callbacks: Callbacks): Promise<IPlayer> {\r\n        const audioElement: HTMLAudioElement = document.createElement('audio');\r\n\r\n        const supports: object = {\r\n            'audio/mp3':\r\n                audioElement.canPlayType &&\r\n                audioElement\r\n                    .canPlayType('audio/mpeg;codecs=mp3')\r\n                    .replace(/no/, ''),\r\n            'audio/ogg':\r\n                audioElement.canPlayType &&\r\n                audioElement.canPlayType('audio/ogg').replace(/no/, '')\r\n        };\r\n\r\n        const canAudio = supports['audio/mp3'] || supports['audio/ogg'];\r\n\r\n        const canvas: HTMLCanvasElement = document.createElement('canvas');\r\n        canvas.style.width = '100%';\r\n        canvas.style.height = '100%';\r\n\r\n        const withAudio: boolean = !this.config.noAudio && canAudio;\r\n        let dataEventSend = false;\r\n        let currentSource = '';\r\n        let isStopped = true;\r\n\r\n        let audio: HTMLAudioElement;\r\n        if (withAudio) {\r\n            audio = document.createElement('audio');\r\n            audio.autoplay = true;\r\n\r\n            canvas.append(audio);\r\n        }\r\n\r\n        const picStream = new PicStream((image: HTMLImageElement) => {\r\n            if (!dataEventSend) {\r\n                dataEventSend = true;\r\n\r\n                const info: PlayInfo = {\r\n                    width: image.naturalWidth,\r\n                    height: image.naturalHeight,\r\n\r\n                    quality: 'medium',\r\n                    paused: false,\r\n                    volume: withAudio ? audio.volume : 0,\r\n                    name: player.name,\r\n                    source: currentSource\r\n                };\r\n                callbacks.onPlayInfo(info);\r\n            }\r\n\r\n            const aspectRatio = image.width / image.height;\r\n\r\n            if (canvas.width != canvas.clientWidth) {\r\n                canvas.width = canvas.clientWidth;\r\n            }\r\n\r\n            if (canvas.height != canvas.clientHeight) {\r\n                canvas.height = canvas.clientHeight;\r\n            }\r\n\r\n            let dw = 0;\r\n            let dh = 0;\r\n\r\n            if (aspectRatio * canvas.height > canvas.width) {\r\n                dw = canvas.width;\r\n                dh = canvas.width / aspectRatio;\r\n            } else {\r\n                dw = canvas.height * aspectRatio;\r\n                dh = canvas.height;\r\n            }\r\n\r\n            const offsetX = (canvas.width - dw) / 2;\r\n            const offsetY = (canvas.height - dh) / 2;\r\n\r\n            const ctx = canvas.getContext('2d');\r\n\r\n            ctx.drawImage(\r\n                image,\r\n                0,\r\n                0,\r\n                image.width,\r\n                image.height,\r\n                offsetX,\r\n                offsetY,\r\n                dw,\r\n                dh\r\n            );\r\n        });\r\n\r\n        const player = {\r\n            el: [canvas],\r\n            name: 'JPEG',\r\n\r\n            play: (sourceSet: SourceSet): void => {\r\n                player.stop();\r\n\r\n                let source: string;\r\n                let sourceType: string;\r\n                let sources: Source[];\r\n\r\n                isStopped = false;\r\n\r\n                sources = sourceSet.jpeg;\r\n                if (sources && sources.length > 0) {\r\n                    currentSource = sources[0].stream;\r\n                    picStream.play(currentSource);\r\n                }\r\n\r\n                if (withAudio) {\r\n                    const d = [\r\n                        sourceSet.mp3,\r\n                        'audio/mp3',\r\n                        sourceSet.vorbis,\r\n                        'audio/ogg'\r\n                    ];\r\n                    for (let i = 0; i < 2; i++) {\r\n                        sources = d[i * 2] as any;\r\n                        sourceType = d[i * 2 + 1] as string;\r\n                        if (\r\n                            sources &&\r\n                            sources.length > 0 &&\r\n                            supports[sourceType]\r\n                        ) {\r\n                            source = sources[0].stream;\r\n                            const src: HTMLSourceElement = document.createElement(\r\n                                'source'\r\n                            );\r\n                            src.src = source;\r\n                            src.type = d[i * 2 + 1] as string;\r\n                            audio.append(src);\r\n                        }\r\n                    }\r\n\r\n                    const r = audio.play() as any;\r\n                    if (r && r.catch) {\r\n                        r.catch(() => {\r\n                            audio.volume = 0;\r\n                            audio.muted = true;\r\n\r\n                            callbacks.onVolumeChange(0);\r\n                            logger.warn('JpegPlayerFactory audio.play failed');\r\n                        });\r\n                    }\r\n                }\r\n                callbacks.onPlayStart(source);\r\n            },\r\n\r\n            stop: (): void => {\r\n                isStopped = true;\r\n\r\n                picStream.stop();\r\n                if (withAudio) {\r\n                    audio.pause();\r\n                    while (audio.firstChild) {\r\n                        audio.removeChild(audio.firstChild);\r\n                    }\r\n                }\r\n                dataEventSend = false;\r\n                callbacks.onPlayStop();\r\n            },\r\n\r\n            destroy: (): HTMLVideoElement => {\r\n                player.stop();\r\n\r\n                return null;\r\n            },\r\n\r\n            setVolume: (value: number): void => {\r\n                if (withAudio && !isStopped) {\r\n                    audio.volume = value;\r\n                    audio.muted = !value; // special handling for mobile Safari\r\n\r\n                    if (audio.paused) {\r\n                        const playPromise = audio.play();\r\n                        if (playPromise) {\r\n                            playPromise.catch(() => {\r\n                                logger.warn(\r\n                                    'JpegPlayerFactory audio.play failed'\r\n                                );\r\n                            });\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        };\r\n\r\n        if (this.config.initCallback) {\r\n            this.config.initCallback(withAudio);\r\n        }\r\n\r\n        return player;\r\n    }\r\n}\r\n","import { Callbacks } from './callbacks';\r\nimport { IPlayer } from './iplayer';\r\nimport { PlayerFactory } from './player-factory';\r\n\r\n// Utility class\r\nexport class PlayerFactoryLoader implements PlayerFactory {\r\n    public format: string;\r\n    private loader: () => Promise<PlayerFactory>;\r\n    private factory: PlayerFactory;\r\n    constructor(format: string, loader: () => Promise<PlayerFactory>) {\r\n        this.format = format;\r\n        this.loader = loader;\r\n    }\r\n    public isSupported(): boolean {\r\n        return !this.factory || this.factory.isSupported();\r\n    }\r\n    public async create(\r\n        callbacks: Callbacks,\r\n        video: HTMLVideoElement\r\n    ): Promise<IPlayer> {\r\n        if (this.factory) {\r\n            return this.factory.create(callbacks, video);\r\n        }\r\n\r\n        this.factory = await this.loader();\r\n        this.factory.create(callbacks, video);\r\n    }\r\n}\r\n","import { Callbacks } from '../../callbacks';\r\nimport { IPlayer } from '../../iplayer';\r\nimport { PlayerFactory } from '../../player-factory';\r\nimport { BrowserName, isBrowserVersion } from '../../utils';\r\nimport { dummy, flashInfo, RtmpPlayer, swfFails } from './rtmp-player';\r\nimport { RtmpPlayerConfig } from './rtmp-player-config';\r\n\r\nexport class RtmpPlayerFactory implements PlayerFactory {\r\n    public readonly format = 'rtmp';\r\n    private config: RtmpPlayerConfig;\r\n    constructor(config?: RtmpPlayerConfig) {\r\n        this.config = config || {};\r\n    }\r\n    public isSupported(): boolean {\r\n        const mver = flashInfo().major;\r\n        let supported =\r\n            mver === 999\r\n                ? swfFails <= 1\r\n                : swfFails <= 4 &&\r\n                  (mver > 11 || (mver === 11 && flashInfo().minor >= 3));\r\n        // special handling for zoomed Firefox\r\n        if (\r\n            window &&\r\n            window.devicePixelRatio > 1 &&\r\n            isBrowserVersion(BrowserName.FIREFOX)\r\n        ) {\r\n            supported = false;\r\n        }\r\n        return supported;\r\n    }\r\n    public async create(callbacks: Callbacks): Promise<IPlayer> {\r\n        if (this.config.onPreInit) {\r\n            this.config.onPreInit();\r\n        }\r\n        let canPublish = true;\r\n        if (typeof this.config.useUpstream !== 'undefined') {\r\n            canPublish = this.config.useUpstream;\r\n        }\r\n        return new RtmpPlayer(\r\n            callbacks,\r\n            this.config.swfPath || 'player.swf',\r\n            this.config.timeout || 8000,\r\n            this.config.onInit || dummy,\r\n            canPublish\r\n        );\r\n    }\r\n}\r\n","import { Callbacks } from '../../callbacks';\r\nimport { CameraConfig } from '../../camera-config';\r\nimport { IPlayer } from '../../iplayer';\r\n\r\nimport { logger, RtmpSource, SourceSet, TargetSet } from 'vchat-core';\r\nimport { CameraPosition } from '../../camera-position';\r\n\r\nlet flashInfoData = null;\r\n\r\nexport const flashInfo = (): any => {\r\n    if (!flashInfoData) {\r\n        const isDef = (value: PluginArray): boolean => {\r\n            return typeof value !== 'undefined';\r\n        };\r\n        const ua = navigator.userAgent.toLowerCase();\r\n        let oldIEMode = navigator.appName === 'Microsoft Internet Explorer';\r\n        let pluginMode = false;\r\n        let major = 0;\r\n        let minor = 0;\r\n        const r = /edge\\/(\\d+)/.exec(navigator.appName);\r\n        const edge2017 = r && parseInt(r[1], 10) >= 15; // 2017-04 flash support is broken\r\n\r\n        if (!edge2017 && isDef(navigator.plugins)) {\r\n            const flash = navigator.plugins['Shockwave Flash'];\r\n            if (typeof flash === 'object') {\r\n                pluginMode = true;\r\n                oldIEMode = false;\r\n                const v = /(\\d+)\\.(\\d+)/.exec(flash.description);\r\n                if (v) {\r\n                    major = parseInt(v[1], 10);\r\n                    minor = parseInt(v[2], 10);\r\n                }\r\n            } else {\r\n                const win = ua.includes('windows');\r\n                const mac = ua.includes('mac');\r\n\r\n                if (!!window['chrome'] && (win || mac)) {\r\n                    const v = /chrome\\/(\\d+)/.exec(ua);\r\n                    const chromeVersion = v ? parseInt(v[1], 10) : 0;\r\n\r\n                    if (\r\n                        chromeVersion >= 56 &&\r\n                        !/(?:opr|vivaldi|yabrowser|dragon)\\//.test(ua)\r\n                    ) {\r\n                        // google chrome for win/mac and not other chromium based browser\r\n                        pluginMode = true;\r\n                        oldIEMode = false;\r\n                        major = 999;\r\n                        minor = 0;\r\n                    }\r\n                }\r\n            }\r\n        }\r\n\r\n        if (!pluginMode) {\r\n            try {\r\n                /* eslint-disable no-undef */\r\n                const ax = new ActiveXObject('ShockwaveFlash.ShockwaveFlash');\r\n                /* eslint-enable no-undef */\r\n\r\n                if (ax) {\r\n                    const v = /(\\d+),(\\d+)/.exec(ax.GetVariable('$version'));\r\n                    if (v) {\r\n                        oldIEMode = true;\r\n                        major = parseInt(v[1], 10);\r\n                        minor = parseInt(v[2], 10);\r\n                    }\r\n                }\r\n            } catch (error) {\r\n                /* ignore as this is only valid on IE */\r\n            }\r\n        }\r\n        flashInfoData = { major, minor, oldIEMode };\r\n    }\r\n    return flashInfoData;\r\n};\r\n\r\nfunction param(name: string, value: string): HTMLParamElement {\r\n    const p = document.createElement('param') as HTMLParamElement;\r\n    p.name = name;\r\n    p.value = value;\r\n    return p;\r\n}\r\n\r\nfunction buildFlashObject(\r\n    id: string,\r\n    src: string,\r\n    flashvars: string,\r\n    wmode = 'window'\r\n): SWFPlayer {\r\n    // @see https://helpx.adobe.com/flash/kb/flash-object-embed-tag-attributes.html\r\n    const params = {\r\n        id,\r\n\r\n        allowfullscreen: false,\r\n        allowscriptaccess: 'always',\r\n        bgcolor: '#000',\r\n        browserzoom: 'noscale',\r\n        flashvars,\r\n        quality: 'high',\r\n        wmode\r\n    };\r\n\r\n    const obj: HTMLObjectElement = document.createElement(\r\n        'object'\r\n    ) as HTMLObjectElement;\r\n    obj.width = '100%';\r\n    obj.height = '100%';\r\n    obj.id = id;\r\n    obj.name = id;\r\n\r\n    if (flashInfo().oldIEMode) {\r\n        (obj as any).classid = 'clsid:D27CDB6E-AE6D-11cf-96B8-444553540000';\r\n        obj.append(param('movie', src));\r\n    } else {\r\n        obj.data = src;\r\n        obj.type = 'application/x-shockwave-flash';\r\n    }\r\n\r\n    for (const key in params) {\r\n        obj.append(param(key, params[key]));\r\n    }\r\n\r\n    return obj as SWFPlayer;\r\n}\r\n\r\nfunction findUniqueName(): string {\r\n    let name = '';\r\n    let max = 99;\r\n    do {\r\n        if (max-- === 0) {\r\n            return null;\r\n        }\r\n        name =\r\n            '_rtmpPlayer_' + Math.ceil(Math.random() * 0x1000000).toString(16);\r\n    } while (\r\n        Object.prototype.hasOwnProperty.call(window, name) &&\r\n        document.querySelector('#' + name)\r\n    );\r\n    return name;\r\n}\r\n\r\nexport let swfFails: number = (function(): number {\r\n    const r = /player_swf_fails\\s*=\\s*(\\d+)-(\\d+).*/.exec(document.cookie);\r\n    if (r) {\r\n        return parseInt(r[1], 10) || 0;\r\n    }\r\n    return 0;\r\n})();\r\n\r\nfunction updateFails(value): void {\r\n    swfFails = value;\r\n\r\n    let cookie = 'player_swf_fails=' + swfFails;\r\n\r\n    if (swfFails) {\r\n        cookie += '-' + Math.floor(Date.now() / 1000) + ';max-age=' + 86400 * 7;\r\n    }\r\n\r\n    cookie += ';path=/';\r\n\r\n    document.cookie = cookie;\r\n}\r\n\r\nexport const dummy = (): void => {\r\n    /** noop */\r\n};\r\n\r\ninterface SWFPlayer extends HTMLObjectElement {\r\n    play(app: string, stream: string): void;\r\n    stop(): void;\r\n    hasCamera(): boolean;\r\n    startCamera(config: any);\r\n    stopCamera();\r\n    publish(app: string, stream: string): void;\r\n    unpublish(): void;\r\n    setVolume(value: number): void;\r\n    getVolume(): number;\r\n}\r\n\r\nconst enum PlayerState {\r\n    UNDEF,\r\n    STOP,\r\n    PLAY\r\n}\r\n\r\n/**\r\n * A player for flash streams.\r\n * supported format:  rtmp\r\n * name:              RTMP\r\n */\r\nexport class RtmpPlayer implements IPlayer {\r\n    public readonly name = 'RTMP';\r\n    public canPublish = true;\r\n    public el: HTMLElement[];\r\n\r\n    private id: string;\r\n    private state: PlayerState = PlayerState.UNDEF;\r\n    private cameraState = 0;\r\n    private publishState = 0;\r\n    private queue: any[] = [];\r\n    private sources: RtmpSource[] = [];\r\n    private currentSource: string;\r\n    private cb: Callbacks;\r\n    private swf: SWFPlayer;\r\n    private initTimeout: number;\r\n    private videoHeight: number;\r\n    private videoWidth: number;\r\n\r\n    constructor(\r\n        callbacks: Callbacks,\r\n        swfPath: string,\r\n        timeout: number,\r\n        onInit: () => void,\r\n        canPublish: boolean\r\n    ) {\r\n        const id = findUniqueName();\r\n        if (!id) {\r\n            throw new Error(\"can't get id\");\r\n        }\r\n\r\n        this.cb = callbacks;\r\n        this.canPublish = canPublish;\r\n\r\n        this.initTimeout = window.setTimeout(() => {\r\n            if (this.state === PlayerState.UNDEF) {\r\n                this.queue.forEach((entry) => {\r\n                    if (entry.onFail) {\r\n                        entry.onFail();\r\n                    }\r\n                });\r\n                this.queue = [];\r\n                updateFails(swfFails + 1);\r\n                callbacks.onError('timeout');\r\n            }\r\n        }, timeout);\r\n\r\n        this.id = id;\r\n        window[id] = {\r\n            onLog: (...args): void => {\r\n                args.unshift('RtmpPlayer:handler.onLog');\r\n                logger.log.apply(this, args);\r\n            },\r\n\r\n            onPreInit: (): void => {\r\n                // logger.log('RtmpSource.handler.onPreInit')\r\n            },\r\n\r\n            onInit: (version: string | number): void => {\r\n                logger.log('RtmpPlayer:handler.onInit ' + version);\r\n                updateFails(0);\r\n                if (version >= 1) {\r\n                    this.state = PlayerState.STOP;\r\n                    clearTimeout(this.initTimeout);\r\n                    setTimeout(() => {\r\n                        if (this.state) {\r\n                            this.queue.forEach((entry) => entry.cmd());\r\n                            this.queue = [];\r\n                        }\r\n                    }, 0);\r\n\r\n                    onInit();\r\n                } else {\r\n                    // incompatible version\r\n                    callbacks.onError('incompatible');\r\n                }\r\n            },\r\n\r\n            onConnect: (): void => {\r\n                logger.log('RtmpPlayer:handler.onConnect');\r\n            },\r\n\r\n            onPlay: (stream: string): void => {\r\n                logger.log('RtmpPlayer:handler.onPlay', stream);\r\n                this.state = PlayerState.PLAY;\r\n                callbacks.onPlayStart(stream);\r\n            },\r\n\r\n            onStop: (stream): void => {\r\n                logger.log('RtmpPlayer:handler.onStop', stream);\r\n                this.state = PlayerState.STOP;\r\n                callbacks.onPlayStop();\r\n            },\r\n\r\n            onPublish: (): void => {\r\n                this.publishState = 2;\r\n                callbacks.onPublishStart();\r\n            },\r\n\r\n            onUnpublish: (): void => {\r\n                this.publishState = 0;\r\n                callbacks.onPublishStop();\r\n            },\r\n\r\n            onVideoSize: (width: number, height: number): void => {\r\n                logger.log('RtmpPlayer:handler.onVideoSize', width, height);\r\n                this.videoHeight = height;\r\n                this.videoWidth = width;\r\n\r\n                this.sendPlayInfo();\r\n            },\r\n\r\n            onCameraStatus: (value: number): void => {\r\n                logger.log('RtmpPlayer:handler.onCameraStatus', value);\r\n                this.cameraState = value;\r\n                if (value === 1) {\r\n                    callbacks.onCameraOn();\r\n                } else if (value === 0) {\r\n                    callbacks.onCameraOff();\r\n                } else {\r\n                    callbacks.onCameraDenied();\r\n                }\r\n            }\r\n        };\r\n\r\n        const flashvars = `handler=${id}`;\r\n        this.swf = buildFlashObject(id, swfPath, flashvars);\r\n        this.el = [this.swf];\r\n    }\r\n\r\n    public play(sourceSet: SourceSet): void {\r\n        this.sources = sourceSet.rtmp ? sourceSet.rtmp.slice() : [];\r\n        this.playNext();\r\n    }\r\n\r\n    public stop(): void {\r\n        this.eorq(() => this.swf.stop());\r\n    }\r\n\r\n    public hasCamera(): Promise<boolean | undefined> {\r\n        return new Promise((resolve) => {\r\n            this.eorq(\r\n                () => {\r\n                    resolve(this.swf.hasCamera());\r\n                },\r\n                () => {\r\n                    resolve(undefined);\r\n                }\r\n            );\r\n        });\r\n    }\r\n\r\n    public startCamera(params: CameraConfig): Promise<any> {\r\n        if (typeof params !== 'object') {\r\n            params = { position: params };\r\n        }\r\n\r\n        if (!params.position) {\r\n            params.position = CameraPosition.TopLeft;\r\n        }\r\n\r\n        return new Promise((_resolve, reject) => {\r\n            this.eorq(\r\n                () => {\r\n                    this.swf.startCamera(params);\r\n                },\r\n                () => {\r\n                    reject();\r\n                }\r\n            );\r\n        });\r\n    }\r\n\r\n    public stopCamera(): void {\r\n        this.eorq(() => this.swf.stopCamera());\r\n    }\r\n\r\n    public publish(targetSet: TargetSet): boolean {\r\n        if (targetSet.rtmp && targetSet.rtmp.length > 0) {\r\n            const app = targetSet.rtmp[0].app;\r\n            const stream = targetSet.rtmp[0].stream;\r\n\r\n            this.publishState = 1;\r\n\r\n            this.eorq(() => this.swf.publish(app, stream));\r\n            return true;\r\n        }\r\n        return false;\r\n    }\r\n\r\n    public unpublish(): void {\r\n        this.publishState = -1;\r\n        this.eorq(() => this.swf.unpublish());\r\n    }\r\n\r\n    public destroy(): HTMLVideoElement {\r\n        clearTimeout(this.initTimeout);\r\n\r\n        if (this.state === PlayerState.PLAY) {\r\n            this.stop();\r\n        }\r\n\r\n        if (this.publishState !== 0) {\r\n            this.cb.onPublishStop();\r\n        }\r\n\r\n        if (this.cameraState !== 0) {\r\n            this.cb.onCameraOff();\r\n        }\r\n\r\n        window[this.id] = null;\r\n\r\n        return null;\r\n    }\r\n\r\n    public setVolume(volume: number): void {\r\n        this.eorq(() => this.swf.setVolume(volume));\r\n    }\r\n\r\n    private eorq(cmd: () => void, onFail?: () => void): void {\r\n        if (this.state !== PlayerState.UNDEF) {\r\n            cmd();\r\n        } else {\r\n            this.queue.push({ cmd, onFail });\r\n        }\r\n    }\r\n\r\n    private playNext(): void {\r\n        const source = this.sources.shift();\r\n        if (source) {\r\n            this.currentSource = source.stream;\r\n            this.eorq(() => this.swf.play(source.app, source.stream));\r\n        } else {\r\n            this.cb.onError('no_source');\r\n        }\r\n    }\r\n\r\n    private sendPlayInfo(): void {\r\n        this.cb.onPlayInfo({\r\n            width: this.videoWidth,\r\n            height: this.videoHeight,\r\n\r\n            quality: 'good',\r\n            volume: this.swf.getVolume(),\r\n            paused: false,\r\n            name: this.name,\r\n            source: this.currentSource\r\n        });\r\n    }\r\n}\r\n","import { WebRTCPlayer } from './webrtc-player';\r\n\r\nimport { isWebRTCSupported, browser } from 'detectrtc';\r\nimport { Callbacks } from '../../callbacks';\r\nimport { IPlayer } from '../../iplayer';\r\nimport { PlayerFactory } from '../../player-factory';\r\n\r\nexport class WebRTCPlayerFactory implements PlayerFactory {\r\n    public readonly format = 'webrtc';\r\n\r\n    public isSupported(): boolean {\r\n        return isWebRTCSupported && browser.name !== 'Edge'; //disable for edge as webrtc is currently broken there\r\n    }\r\n    public create(\r\n        callbacks: Callbacks,\r\n        video: HTMLVideoElement\r\n    ): Promise<IPlayer> {\r\n        console.log('called create on WebRTCPlayer');\r\n\r\n        if (!video) {\r\n            video = document.createElement('video');\r\n            video.muted = false;\r\n            video.autoplay = true;\r\n        }\r\n\r\n        video.crossOrigin = 'anonymous';\r\n        video.controls = false;\r\n        video.style.width = '100%';\r\n        video.style.height = '100%';\r\n\r\n        const player = new WebRTCPlayer(video);\r\n\r\n        return Promise.resolve(player);\r\n    }\r\n}\r\n","import { IPlayer } from '../../iplayer';\r\nimport { SourceSet } from 'vchat-core';\r\nimport { QualityLevel } from '../../quality-level';\r\n\r\n// import 'webrtc-adapter';\r\n\r\nexport class WebRTCPlayer implements IPlayer {\r\n    public el: HTMLElement[];\r\n    public readonly name = 'WebRTC';\r\n    public readonly canPublish? = false;\r\n\r\n    private _peerConnection: RTCPeerConnection;\r\n    private _closingConnection: boolean;\r\n    private _videoElement: HTMLVideoElement;\r\n    private _socket: WebSocket;\r\n\r\n    constructor(video: HTMLVideoElement) {\r\n        this._videoElement = video;\r\n        video.id = 'webRTCVideo';\r\n        this.el = [video];\r\n    }\r\n\r\n    public play(sourceSet: SourceSet): void {\r\n        const webRtcSource = sourceSet.webrtc[0];\r\n        this._openSignalingConnection(webRtcSource.stream);\r\n    }\r\n\r\n    public stop(): void {\r\n        this._closeDataConnection();\r\n        this._closeSignalingConnection();\r\n    }\r\n\r\n    public destroy(): HTMLVideoElement {\r\n        this._closeDataConnection();\r\n        this._closeSignalingConnection();\r\n        return this._videoElement;\r\n    }\r\n\r\n    public setVolume(volume: number): void {\r\n        this._videoElement.volume = volume;\r\n    }\r\n\r\n    public close(): void {\r\n        // this.closing = true;\r\n        // this.noop.active = false;\r\n        if (this._socket) {\r\n            this._socket.close();\r\n        }\r\n    }\r\n\r\n    private _closeSignalingConnection(): void {\r\n        if (this._socket) {\r\n            this._socket.close();\r\n            this._socket = null;\r\n        }\r\n    }\r\n\r\n    private _openDataConnection(): void {\r\n        const peerConnection = new RTCPeerConnection({\r\n            iceServers: [{ urls: 'stun:stun.l.google.com:19302' }]\r\n        });\r\n\r\n        peerConnection.ontrack = this._attachStreamToVideo.bind(this);\r\n        peerConnection.onconnectionstatechange = this._peerConnectionStateChanged.bind(\r\n            this\r\n        );\r\n        // peerConnection.onicegatheringstatechange = this._iceGatheringStateChanged.bind(this);\r\n        peerConnection.onicecandidate = this._iceCandidate.bind(this);\r\n        // peerConnection.onicecandidateerror = this._iceCandidateError.bind(this);\r\n        // peerConnection.onnegotiationneeded = this._negotiationNeeded.bind(this);\r\n        // peerConnection.onsignalingstatechange = this._signalingStateChanged.bind(this);\r\n        // peerConnection.onstatsended = this._statsEnded.bind(this);\r\n\r\n        this._peerConnection = peerConnection;\r\n    }\r\n\r\n    private _attachStreamToVideo(event: RTCTrackEvent): void {\r\n        console.log('attaching stream');\r\n        this._videoElement.id = 'Playing_web_RTC';\r\n        this._videoElement.autoplay = true;\r\n\r\n        console.log(event);\r\n        this._videoElement.srcObject = event.streams[0];\r\n    }\r\n\r\n    private _peerConnectionStateChanged(_ev: Event): void {\r\n        console.log('PEER CONNECTION STATE CHANGED');\r\n    }\r\n\r\n    private _iceCandidate(ev: RTCPeerConnectionIceEvent): void {\r\n        if (ev.candidate != null) {\r\n            this._sendWebRtcIceCandidate(ev.candidate);\r\n        } else {\r\n            this._sendWebRtcNoMoreCandidates();\r\n        }\r\n    }\r\n\r\n    private _sendWebRtcIceCandidate(candidate: RTCIceCandidate): void {\r\n        this._dispatchCommand('CMDS_WEBRTC_ICE_CANDIDATE', {\r\n            // eslint-disable-next-line @typescript-eslint/camelcase\r\n            ice_candidate: candidate.candidate,\r\n            // eslint-disable-next-line @typescript-eslint/camelcase\r\n            ice_candidate_sdpMLineIndex: candidate.sdpMLineIndex,\r\n            // eslint-disable-next-line @typescript-eslint/camelcase\r\n            ice_candidate_sdpMid: candidate.sdpMid\r\n        });\r\n    }\r\n\r\n    private _changeStreamQuality(quality: QualityLevel): void {\r\n        let substream = 0;\r\n\r\n        switch (quality) {\r\n            case 'low':\r\n                substream = 2;\r\n                break;\r\n            case 'medium':\r\n                substream = 1;\r\n                break;\r\n            case 'good':\r\n                substream = 0;\r\n                break;\r\n        }\r\n\r\n        this._dispatchCommand('CMDS_WEBRTC_CHANGE_QUALITY', {\r\n            substream: substream\r\n            // temporal: 1\r\n        });\r\n    }\r\n\r\n    private _sendWebRtcNoMoreCandidates(): void {\r\n        this._dispatchCommand('CMDS_WEBRTC_ICE_NO_MORE_CANDIDATES', {});\r\n    }\r\n\r\n    private _openSignalingConnection(signalingUrl: string): void {\r\n        const socket = new WebSocket(signalingUrl);\r\n        socket.onopen = (ev): void => {\r\n            this._onopen(ev);\r\n        };\r\n        socket.onmessage = this._onmessage.bind(this);\r\n        socket.onerror = this._onerror.bind(this);\r\n        socket.onclose = this._onclose.bind(this);\r\n        this._socket = socket;\r\n    }\r\n\r\n    private _onopen(event: Event): void {\r\n        console.log('webrtc - onOpen', event);\r\n        this._openDataConnection();\r\n        this._requestChat();\r\n    }\r\n\r\n    private _requestChat(): void {\r\n        this._dispatchCommand('CMDS_WEBRTC_START');\r\n    }\r\n\r\n    private _dispatchCommand(action: string, params: any = {}): void {\r\n        const jsonData = JSON.stringify({ action, params });\r\n        this._socket.send(jsonData);\r\n    }\r\n\r\n    private _onmessage(event: MessageEvent): void {\r\n        console.log('webrtc - onMessage', event.data);\r\n        const data = JSON.parse(event.data);\r\n        switch (data.action) {\r\n            case 'CMDC_WEBRTC_OFFER':\r\n                this._handleWebRtcOffer(data.params.jsepSdp);\r\n                break;\r\n            case 'CMDP_NOOP':\r\n                // this is a keep alive event,do nothing\r\n                break;\r\n            default:\r\n                console.log('no handler for ' + data.action);\r\n                break;\r\n        }\r\n        console.log(data);\r\n    }\r\n\r\n    private async _handleWebRtcOffer(sdp: string): Promise<void> {\r\n        await this._peerConnection.setRemoteDescription(\r\n            new RTCSessionDescription({ type: 'offer', sdp })\r\n        );\r\n        const answer = await this._peerConnection.createAnswer();\r\n        await this._peerConnection.setLocalDescription(\r\n            new RTCSessionDescription(answer)\r\n        );\r\n        const answerForServer = this._peerConnection.localDescription;\r\n        this._sendWebRtcAnswer(answerForServer);\r\n    }\r\n\r\n    private _sendWebRtcAnswer(answer: RTCSessionDescription): void {\r\n        this._dispatchCommand('CMDS_WEBRTC_JSEPANSWER', {\r\n            jsepType: answer.type,\r\n            jsepSdp: answer.sdp\r\n        });\r\n    }\r\n\r\n    private _onerror(event: Event): void {\r\n        console.log('webrtc - onError', event);\r\n        this._peerConnection.close();\r\n    }\r\n\r\n    private _onclose(_event: CloseEvent): void {\r\n        this._closeDataConnection();\r\n    }\r\n\r\n    private _closeDataConnection(): void {\r\n        if (this._peerConnection) {\r\n            this._peerConnection.close();\r\n            this._peerConnection = null;\r\n        }\r\n    }\r\n}\r\n","'use strict';\r\n\r\n// Last Updated On: 2019-01-10 5:32:55 AM UTC\r\n\r\n// ________________\r\n// DetectRTC v1.3.9\r\n\r\n// Open-Sourced: https://github.com/muaz-khan/DetectRTC\r\n\r\n// --------------------------------------------------\r\n// Muaz Khan     - www.MuazKhan.com\r\n// MIT License   - www.WebRTC-Experiment.com/licence\r\n// --------------------------------------------------\r\n\r\n(function() {\r\n\r\n    var browserFakeUserAgent = 'Fake/5.0 (FakeOS) AppleWebKit/123 (KHTML, like Gecko) Fake/12.3.4567.89 Fake/123.45';\r\n\r\n    var isNodejs = typeof process === 'object' && typeof process.versions === 'object' && process.versions.node && /*node-process*/ !process.browser;\r\n    if (isNodejs) {\r\n        var version = process.versions.node.toString().replace('v', '');\r\n        browserFakeUserAgent = 'Nodejs/' + version + ' (NodeOS) AppleWebKit/' + version + ' (KHTML, like Gecko) Nodejs/' + version + ' Nodejs/' + version\r\n    }\r\n\r\n    (function(that) {\r\n        if (typeof window !== 'undefined') {\r\n            return;\r\n        }\r\n\r\n        if (typeof window === 'undefined' && typeof global !== 'undefined') {\r\n            global.navigator = {\r\n                userAgent: browserFakeUserAgent,\r\n                getUserMedia: function() {}\r\n            };\r\n\r\n            /*global window:true */\r\n            that.window = global;\r\n        } else if (typeof window === 'undefined') {\r\n            // window = this;\r\n        }\r\n\r\n        if (typeof location === 'undefined') {\r\n            /*global location:true */\r\n            that.location = {\r\n                protocol: 'file:',\r\n                href: '',\r\n                hash: ''\r\n            };\r\n        }\r\n\r\n        if (typeof screen === 'undefined') {\r\n            /*global screen:true */\r\n            that.screen = {\r\n                width: 0,\r\n                height: 0\r\n            };\r\n        }\r\n    })(typeof global !== 'undefined' ? global : window);\r\n\r\n    /*global navigator:true */\r\n    var navigator = window.navigator;\r\n\r\n    if (typeof navigator !== 'undefined') {\r\n        if (typeof navigator.webkitGetUserMedia !== 'undefined') {\r\n            navigator.getUserMedia = navigator.webkitGetUserMedia;\r\n        }\r\n\r\n        if (typeof navigator.mozGetUserMedia !== 'undefined') {\r\n            navigator.getUserMedia = navigator.mozGetUserMedia;\r\n        }\r\n    } else {\r\n        navigator = {\r\n            getUserMedia: function() {},\r\n            userAgent: browserFakeUserAgent\r\n        };\r\n    }\r\n\r\n    var isMobileDevice = !!(/Android|webOS|iPhone|iPad|iPod|BB10|BlackBerry|IEMobile|Opera Mini|Mobile|mobile/i.test(navigator.userAgent || ''));\r\n\r\n    var isEdge = navigator.userAgent.indexOf('Edge') !== -1 && (!!navigator.msSaveOrOpenBlob || !!navigator.msSaveBlob);\r\n\r\n    var isOpera = !!window.opera || navigator.userAgent.indexOf(' OPR/') >= 0;\r\n    var isFirefox = typeof window.InstallTrigger !== 'undefined';\r\n    var isSafari = /^((?!chrome|android).)*safari/i.test(navigator.userAgent);\r\n    var isChrome = !!window.chrome && !isOpera;\r\n    var isIE = typeof document !== 'undefined' && !!document.documentMode && !isEdge;\r\n\r\n    // this one can also be used:\r\n    // https://www.websocket.org/js/stuff.js (DetectBrowser.js)\r\n\r\n    function getBrowserInfo() {\r\n        var nVer = navigator.appVersion;\r\n        var nAgt = navigator.userAgent;\r\n        var browserName = navigator.appName;\r\n        var fullVersion = '' + parseFloat(navigator.appVersion);\r\n        var majorVersion = parseInt(navigator.appVersion, 10);\r\n        var nameOffset, verOffset, ix;\r\n\r\n        // both and safri and chrome has same userAgent\r\n        if (isSafari && !isChrome && nAgt.indexOf('CriOS') !== -1) {\r\n            isSafari = false;\r\n            isChrome = true;\r\n        }\r\n\r\n        // In Opera, the true version is after 'Opera' or after 'Version'\r\n        if (isOpera) {\r\n            browserName = 'Opera';\r\n            try {\r\n                fullVersion = navigator.userAgent.split('OPR/')[1].split(' ')[0];\r\n                majorVersion = fullVersion.split('.')[0];\r\n            } catch (e) {\r\n                fullVersion = '0.0.0.0';\r\n                majorVersion = 0;\r\n            }\r\n        }\r\n        // In MSIE version <=10, the true version is after 'MSIE' in userAgent\r\n        // In IE 11, look for the string after 'rv:'\r\n        else if (isIE) {\r\n            verOffset = nAgt.indexOf('rv:');\r\n            if (verOffset > 0) { //IE 11\r\n                fullVersion = nAgt.substring(verOffset + 3);\r\n            } else { //IE 10 or earlier\r\n                verOffset = nAgt.indexOf('MSIE');\r\n                fullVersion = nAgt.substring(verOffset + 5);\r\n            }\r\n            browserName = 'IE';\r\n        }\r\n        // In Chrome, the true version is after 'Chrome' \r\n        else if (isChrome) {\r\n            verOffset = nAgt.indexOf('Chrome');\r\n            browserName = 'Chrome';\r\n            fullVersion = nAgt.substring(verOffset + 7);\r\n        }\r\n        // In Safari, the true version is after 'Safari' or after 'Version' \r\n        else if (isSafari) {\r\n            verOffset = nAgt.indexOf('Safari');\r\n\r\n            browserName = 'Safari';\r\n            fullVersion = nAgt.substring(verOffset + 7);\r\n\r\n            if ((verOffset = nAgt.indexOf('Version')) !== -1) {\r\n                fullVersion = nAgt.substring(verOffset + 8);\r\n            }\r\n\r\n            if (navigator.userAgent.indexOf('Version/') !== -1) {\r\n                fullVersion = navigator.userAgent.split('Version/')[1].split(' ')[0];\r\n            }\r\n        }\r\n        // In Firefox, the true version is after 'Firefox' \r\n        else if (isFirefox) {\r\n            verOffset = nAgt.indexOf('Firefox');\r\n            browserName = 'Firefox';\r\n            fullVersion = nAgt.substring(verOffset + 8);\r\n        }\r\n\r\n        // In most other browsers, 'name/version' is at the end of userAgent \r\n        else if ((nameOffset = nAgt.lastIndexOf(' ') + 1) < (verOffset = nAgt.lastIndexOf('/'))) {\r\n            browserName = nAgt.substring(nameOffset, verOffset);\r\n            fullVersion = nAgt.substring(verOffset + 1);\r\n\r\n            if (browserName.toLowerCase() === browserName.toUpperCase()) {\r\n                browserName = navigator.appName;\r\n            }\r\n        }\r\n\r\n        if (isEdge) {\r\n            browserName = 'Edge';\r\n            fullVersion = navigator.userAgent.split('Edge/')[1];\r\n            // fullVersion = parseInt(navigator.userAgent.match(/Edge\\/(\\d+).(\\d+)$/)[2], 10).toString();\r\n        }\r\n\r\n        // trim the fullVersion string at semicolon/space/bracket if present\r\n        if ((ix = fullVersion.search(/[; \\)]/)) !== -1) {\r\n            fullVersion = fullVersion.substring(0, ix);\r\n        }\r\n\r\n        majorVersion = parseInt('' + fullVersion, 10);\r\n\r\n        if (isNaN(majorVersion)) {\r\n            fullVersion = '' + parseFloat(navigator.appVersion);\r\n            majorVersion = parseInt(navigator.appVersion, 10);\r\n        }\r\n\r\n        return {\r\n            fullVersion: fullVersion,\r\n            version: majorVersion,\r\n            name: browserName,\r\n            isPrivateBrowsing: false\r\n        };\r\n    }\r\n\r\n    // via: https://gist.github.com/cou929/7973956\r\n\r\n    function retry(isDone, next) {\r\n        var currentTrial = 0,\r\n            maxRetry = 50,\r\n            interval = 10,\r\n            isTimeout = false;\r\n        var id = window.setInterval(\r\n            function() {\r\n                if (isDone()) {\r\n                    window.clearInterval(id);\r\n                    next(isTimeout);\r\n                }\r\n                if (currentTrial++ > maxRetry) {\r\n                    window.clearInterval(id);\r\n                    isTimeout = true;\r\n                    next(isTimeout);\r\n                }\r\n            },\r\n            10\r\n        );\r\n    }\r\n\r\n    function isIE10OrLater(userAgent) {\r\n        var ua = userAgent.toLowerCase();\r\n        if (ua.indexOf('msie') === 0 && ua.indexOf('trident') === 0) {\r\n            return false;\r\n        }\r\n        var match = /(?:msie|rv:)\\s?([\\d\\.]+)/.exec(ua);\r\n        if (match && parseInt(match[1], 10) >= 10) {\r\n            return true;\r\n        }\r\n        return false;\r\n    }\r\n\r\n    function detectPrivateMode(callback) {\r\n        var isPrivate;\r\n\r\n        try {\r\n\r\n            if (window.webkitRequestFileSystem) {\r\n                window.webkitRequestFileSystem(\r\n                    window.TEMPORARY, 1,\r\n                    function() {\r\n                        isPrivate = false;\r\n                    },\r\n                    function(e) {\r\n                        isPrivate = true;\r\n                    }\r\n                );\r\n            } else if (window.indexedDB && /Firefox/.test(window.navigator.userAgent)) {\r\n                var db;\r\n                try {\r\n                    db = window.indexedDB.open('test');\r\n                    db.onerror = function() {\r\n                        return true;\r\n                    };\r\n                } catch (e) {\r\n                    isPrivate = true;\r\n                }\r\n\r\n                if (typeof isPrivate === 'undefined') {\r\n                    retry(\r\n                        function isDone() {\r\n                            return db.readyState === 'done' ? true : false;\r\n                        },\r\n                        function next(isTimeout) {\r\n                            if (!isTimeout) {\r\n                                isPrivate = db.result ? false : true;\r\n                            }\r\n                        }\r\n                    );\r\n                }\r\n            } else if (isIE10OrLater(window.navigator.userAgent)) {\r\n                isPrivate = false;\r\n                try {\r\n                    if (!window.indexedDB) {\r\n                        isPrivate = true;\r\n                    }\r\n                } catch (e) {\r\n                    isPrivate = true;\r\n                }\r\n            } else if (window.localStorage && /Safari/.test(window.navigator.userAgent)) {\r\n                try {\r\n                    window.localStorage.setItem('test', 1);\r\n                } catch (e) {\r\n                    isPrivate = true;\r\n                }\r\n\r\n                if (typeof isPrivate === 'undefined') {\r\n                    isPrivate = false;\r\n                    window.localStorage.removeItem('test');\r\n                }\r\n            }\r\n\r\n        } catch (e) {\r\n            isPrivate = false;\r\n        }\r\n\r\n        retry(\r\n            function isDone() {\r\n                return typeof isPrivate !== 'undefined' ? true : false;\r\n            },\r\n            function next(isTimeout) {\r\n                callback(isPrivate);\r\n            }\r\n        );\r\n    }\r\n\r\n    var isMobile = {\r\n        Android: function() {\r\n            return navigator.userAgent.match(/Android/i);\r\n        },\r\n        BlackBerry: function() {\r\n            return navigator.userAgent.match(/BlackBerry|BB10/i);\r\n        },\r\n        iOS: function() {\r\n            return navigator.userAgent.match(/iPhone|iPad|iPod/i);\r\n        },\r\n        Opera: function() {\r\n            return navigator.userAgent.match(/Opera Mini/i);\r\n        },\r\n        Windows: function() {\r\n            return navigator.userAgent.match(/IEMobile/i);\r\n        },\r\n        any: function() {\r\n            return (isMobile.Android() || isMobile.BlackBerry() || isMobile.iOS() || isMobile.Opera() || isMobile.Windows());\r\n        },\r\n        getOsName: function() {\r\n            var osName = 'Unknown OS';\r\n            if (isMobile.Android()) {\r\n                osName = 'Android';\r\n            }\r\n\r\n            if (isMobile.BlackBerry()) {\r\n                osName = 'BlackBerry';\r\n            }\r\n\r\n            if (isMobile.iOS()) {\r\n                osName = 'iOS';\r\n            }\r\n\r\n            if (isMobile.Opera()) {\r\n                osName = 'Opera Mini';\r\n            }\r\n\r\n            if (isMobile.Windows()) {\r\n                osName = 'Windows';\r\n            }\r\n\r\n            return osName;\r\n        }\r\n    };\r\n\r\n    // via: http://jsfiddle.net/ChristianL/AVyND/\r\n    function detectDesktopOS() {\r\n        var unknown = '-';\r\n\r\n        var nVer = navigator.appVersion;\r\n        var nAgt = navigator.userAgent;\r\n\r\n        var os = unknown;\r\n        var clientStrings = [{\r\n            s: 'Windows 10',\r\n            r: /(Windows 10.0|Windows NT 10.0)/\r\n        }, {\r\n            s: 'Windows 8.1',\r\n            r: /(Windows 8.1|Windows NT 6.3)/\r\n        }, {\r\n            s: 'Windows 8',\r\n            r: /(Windows 8|Windows NT 6.2)/\r\n        }, {\r\n            s: 'Windows 7',\r\n            r: /(Windows 7|Windows NT 6.1)/\r\n        }, {\r\n            s: 'Windows Vista',\r\n            r: /Windows NT 6.0/\r\n        }, {\r\n            s: 'Windows Server 2003',\r\n            r: /Windows NT 5.2/\r\n        }, {\r\n            s: 'Windows XP',\r\n            r: /(Windows NT 5.1|Windows XP)/\r\n        }, {\r\n            s: 'Windows 2000',\r\n            r: /(Windows NT 5.0|Windows 2000)/\r\n        }, {\r\n            s: 'Windows ME',\r\n            r: /(Win 9x 4.90|Windows ME)/\r\n        }, {\r\n            s: 'Windows 98',\r\n            r: /(Windows 98|Win98)/\r\n        }, {\r\n            s: 'Windows 95',\r\n            r: /(Windows 95|Win95|Windows_95)/\r\n        }, {\r\n            s: 'Windows NT 4.0',\r\n            r: /(Windows NT 4.0|WinNT4.0|WinNT|Windows NT)/\r\n        }, {\r\n            s: 'Windows CE',\r\n            r: /Windows CE/\r\n        }, {\r\n            s: 'Windows 3.11',\r\n            r: /Win16/\r\n        }, {\r\n            s: 'Android',\r\n            r: /Android/\r\n        }, {\r\n            s: 'Open BSD',\r\n            r: /OpenBSD/\r\n        }, {\r\n            s: 'Sun OS',\r\n            r: /SunOS/\r\n        }, {\r\n            s: 'Linux',\r\n            r: /(Linux|X11)/\r\n        }, {\r\n            s: 'iOS',\r\n            r: /(iPhone|iPad|iPod)/\r\n        }, {\r\n            s: 'Mac OS X',\r\n            r: /Mac OS X/\r\n        }, {\r\n            s: 'Mac OS',\r\n            r: /(MacPPC|MacIntel|Mac_PowerPC|Macintosh)/\r\n        }, {\r\n            s: 'QNX',\r\n            r: /QNX/\r\n        }, {\r\n            s: 'UNIX',\r\n            r: /UNIX/\r\n        }, {\r\n            s: 'BeOS',\r\n            r: /BeOS/\r\n        }, {\r\n            s: 'OS/2',\r\n            r: /OS\\/2/\r\n        }, {\r\n            s: 'Search Bot',\r\n            r: /(nuhk|Googlebot|Yammybot|Openbot|Slurp|MSNBot|Ask Jeeves\\/Teoma|ia_archiver)/\r\n        }];\r\n        for (var i = 0, cs; cs = clientStrings[i]; i++) {\r\n            if (cs.r.test(nAgt)) {\r\n                os = cs.s;\r\n                break;\r\n            }\r\n        }\r\n\r\n        var osVersion = unknown;\r\n\r\n        if (/Windows/.test(os)) {\r\n            if (/Windows (.*)/.test(os)) {\r\n                osVersion = /Windows (.*)/.exec(os)[1];\r\n            }\r\n            os = 'Windows';\r\n        }\r\n\r\n        switch (os) {\r\n            case 'Mac OS X':\r\n                if (/Mac OS X (10[\\.\\_\\d]+)/.test(nAgt)) {\r\n                    osVersion = /Mac OS X (10[\\.\\_\\d]+)/.exec(nAgt)[1];\r\n                }\r\n                break;\r\n            case 'Android':\r\n                if (/Android ([\\.\\_\\d]+)/.test(nAgt)) {\r\n                    osVersion = /Android ([\\.\\_\\d]+)/.exec(nAgt)[1];\r\n                }\r\n                break;\r\n            case 'iOS':\r\n                if (/OS (\\d+)_(\\d+)_?(\\d+)?/.test(nAgt)) {\r\n                    osVersion = /OS (\\d+)_(\\d+)_?(\\d+)?/.exec(nVer);\r\n                    osVersion = osVersion[1] + '.' + osVersion[2] + '.' + (osVersion[3] | 0);\r\n                }\r\n                break;\r\n        }\r\n\r\n        return {\r\n            osName: os,\r\n            osVersion: osVersion\r\n        };\r\n    }\r\n\r\n    var osName = 'Unknown OS';\r\n    var osVersion = 'Unknown OS Version';\r\n\r\n    function getAndroidVersion(ua) {\r\n        ua = (ua || navigator.userAgent).toLowerCase();\r\n        var match = ua.match(/android\\s([0-9\\.]*)/);\r\n        return match ? match[1] : false;\r\n    }\r\n\r\n    var osInfo = detectDesktopOS();\r\n\r\n    if (osInfo && osInfo.osName && osInfo.osName != '-') {\r\n        osName = osInfo.osName;\r\n        osVersion = osInfo.osVersion;\r\n    } else if (isMobile.any()) {\r\n        osName = isMobile.getOsName();\r\n\r\n        if (osName == 'Android') {\r\n            osVersion = getAndroidVersion();\r\n        }\r\n    }\r\n\r\n    var isNodejs = typeof process === 'object' && typeof process.versions === 'object' && process.versions.node;\r\n\r\n    if (osName === 'Unknown OS' && isNodejs) {\r\n        osName = 'Nodejs';\r\n        osVersion = process.versions.node.toString().replace('v', '');\r\n    }\r\n\r\n    var isCanvasSupportsStreamCapturing = false;\r\n    var isVideoSupportsStreamCapturing = false;\r\n    ['captureStream', 'mozCaptureStream', 'webkitCaptureStream'].forEach(function(item) {\r\n        if (typeof document === 'undefined' || typeof document.createElement !== 'function') {\r\n            return;\r\n        }\r\n\r\n        if (!isCanvasSupportsStreamCapturing && item in document.createElement('canvas')) {\r\n            isCanvasSupportsStreamCapturing = true;\r\n        }\r\n\r\n        if (!isVideoSupportsStreamCapturing && item in document.createElement('video')) {\r\n            isVideoSupportsStreamCapturing = true;\r\n        }\r\n    });\r\n\r\n    var regexIpv4Local = /^(192\\.168\\.|169\\.254\\.|10\\.|172\\.(1[6-9]|2\\d|3[01]))/,\r\n        regexIpv4 = /([0-9]{1,3}(\\.[0-9]{1,3}){3})/,\r\n        regexIpv6 = /[a-f0-9]{1,4}(:[a-f0-9]{1,4}){7}/;\r\n\r\n    // via: https://github.com/diafygi/webrtc-ips\r\n    function DetectLocalIPAddress(callback, stream) {\r\n        if (!DetectRTC.isWebRTCSupported) {\r\n            return;\r\n        }\r\n\r\n        var isPublic = true,\r\n            isIpv4 = true;\r\n        getIPs(function(ip) {\r\n            if (!ip) {\r\n                callback(); // Pass nothing to tell that ICE-gathering-ended\r\n            } else if (ip.match(regexIpv4Local)) {\r\n                isPublic = false;\r\n                callback('Local: ' + ip, isPublic, isIpv4);\r\n            } else if (ip.match(regexIpv6)) { //via https://ourcodeworld.com/articles/read/257/how-to-get-the-client-ip-address-with-javascript-only\r\n                isIpv4 = false;\r\n                callback('Public: ' + ip, isPublic, isIpv4);\r\n            } else {\r\n                callback('Public: ' + ip, isPublic, isIpv4);\r\n            }\r\n        }, stream);\r\n    }\r\n\r\n    function getIPs(callback, stream) {\r\n        if (typeof document === 'undefined' || typeof document.getElementById !== 'function') {\r\n            return;\r\n        }\r\n\r\n        var ipDuplicates = {};\r\n\r\n        var RTCPeerConnection = window.RTCPeerConnection || window.mozRTCPeerConnection || window.webkitRTCPeerConnection;\r\n\r\n        if (!RTCPeerConnection) {\r\n            var iframe = document.getElementById('iframe');\r\n            if (!iframe) {\r\n                return;\r\n            }\r\n            var win = iframe.contentWindow;\r\n            RTCPeerConnection = win.RTCPeerConnection || win.mozRTCPeerConnection || win.webkitRTCPeerConnection;\r\n        }\r\n\r\n        if (!RTCPeerConnection) {\r\n            return;\r\n        }\r\n\r\n        var peerConfig = null;\r\n\r\n        if (DetectRTC.browser === 'Chrome' && DetectRTC.browser.version < 58) {\r\n            // todo: add support for older Opera\r\n            peerConfig = {\r\n                optional: [{\r\n                    RtpDataChannels: true\r\n                }]\r\n            };\r\n        }\r\n\r\n        var servers = {\r\n            iceServers: [{\r\n                urls: 'stun:stun.l.google.com:19302'\r\n            }]\r\n        };\r\n\r\n        var pc = new RTCPeerConnection(servers, peerConfig);\r\n\r\n        if (stream) {\r\n            if (pc.addStream) {\r\n                pc.addStream(stream);\r\n            } else if (pc.addTrack && stream.getTracks()[0]) {\r\n                pc.addTrack(stream.getTracks()[0], stream);\r\n            }\r\n        }\r\n\r\n        function handleCandidate(candidate) {\r\n            if (!candidate) {\r\n                callback(); // Pass nothing to tell that ICE-gathering-ended\r\n                return;\r\n            }\r\n\r\n            var match = regexIpv4.exec(candidate);\r\n            if (!match) {\r\n                return;\r\n            }\r\n            var ipAddress = match[1];\r\n            var isPublic = (candidate.match(regexIpv4Local)),\r\n                isIpv4 = true;\r\n\r\n            if (ipDuplicates[ipAddress] === undefined) {\r\n                callback(ipAddress, isPublic, isIpv4);\r\n            }\r\n\r\n            ipDuplicates[ipAddress] = true;\r\n        }\r\n\r\n        // listen for candidate events\r\n        pc.onicecandidate = function(event) {\r\n            if (event.candidate && event.candidate.candidate) {\r\n                handleCandidate(event.candidate.candidate);\r\n            } else {\r\n                handleCandidate(); // Pass nothing to tell that ICE-gathering-ended\r\n            }\r\n        };\r\n\r\n        // create data channel\r\n        if (!stream) {\r\n            try {\r\n                pc.createDataChannel('sctp', {});\r\n            } catch (e) {}\r\n        }\r\n\r\n        // create an offer sdp\r\n        if (DetectRTC.isPromisesSupported) {\r\n            pc.createOffer().then(function(result) {\r\n                pc.setLocalDescription(result).then(afterCreateOffer);\r\n            });\r\n        } else {\r\n            pc.createOffer(function(result) {\r\n                pc.setLocalDescription(result, afterCreateOffer, function() {});\r\n            }, function() {});\r\n        }\r\n\r\n        function afterCreateOffer() {\r\n            var lines = pc.localDescription.sdp.split('\\n');\r\n\r\n            lines.forEach(function(line) {\r\n                if (line && line.indexOf('a=candidate:') === 0) {\r\n                    handleCandidate(line);\r\n                }\r\n            });\r\n        }\r\n    }\r\n\r\n    var MediaDevices = [];\r\n\r\n    var audioInputDevices = [];\r\n    var audioOutputDevices = [];\r\n    var videoInputDevices = [];\r\n\r\n    if (navigator.mediaDevices && navigator.mediaDevices.enumerateDevices) {\r\n        // Firefox 38+ seems having support of enumerateDevices\r\n        // Thanks @xdumaine/enumerateDevices\r\n        navigator.enumerateDevices = function(callback) {\r\n            var enumerateDevices = navigator.mediaDevices.enumerateDevices();\r\n            if (enumerateDevices && enumerateDevices.then) {\r\n                navigator.mediaDevices.enumerateDevices().then(callback).catch(function() {\r\n                    callback([]);\r\n                });\r\n            } else {\r\n                callback([]);\r\n            }\r\n        };\r\n    }\r\n\r\n    // Media Devices detection\r\n    var canEnumerate = false;\r\n\r\n    /*global MediaStreamTrack:true */\r\n    if (typeof MediaStreamTrack !== 'undefined' && 'getSources' in MediaStreamTrack) {\r\n        canEnumerate = true;\r\n    } else if (navigator.mediaDevices && !!navigator.mediaDevices.enumerateDevices) {\r\n        canEnumerate = true;\r\n    }\r\n\r\n    var hasMicrophone = false;\r\n    var hasSpeakers = false;\r\n    var hasWebcam = false;\r\n\r\n    var isWebsiteHasMicrophonePermissions = false;\r\n    var isWebsiteHasWebcamPermissions = false;\r\n\r\n    // http://dev.w3.org/2011/webrtc/editor/getusermedia.html#mediadevices\r\n    function checkDeviceSupport(callback) {\r\n        if (!canEnumerate) {\r\n            if (callback) {\r\n                callback();\r\n            }\r\n            return;\r\n        }\r\n\r\n        if (!navigator.enumerateDevices && window.MediaStreamTrack && window.MediaStreamTrack.getSources) {\r\n            navigator.enumerateDevices = window.MediaStreamTrack.getSources.bind(window.MediaStreamTrack);\r\n        }\r\n\r\n        if (!navigator.enumerateDevices && navigator.enumerateDevices) {\r\n            navigator.enumerateDevices = navigator.enumerateDevices.bind(navigator);\r\n        }\r\n\r\n        if (!navigator.enumerateDevices) {\r\n            if (callback) {\r\n                callback();\r\n            }\r\n            return;\r\n        }\r\n\r\n        MediaDevices = [];\r\n\r\n        audioInputDevices = [];\r\n        audioOutputDevices = [];\r\n        videoInputDevices = [];\r\n\r\n        hasMicrophone = false;\r\n        hasSpeakers = false;\r\n        hasWebcam = false;\r\n\r\n        isWebsiteHasMicrophonePermissions = false;\r\n        isWebsiteHasWebcamPermissions = false;\r\n\r\n        // to prevent duplication\r\n        var alreadyUsedDevices = {};\r\n\r\n        navigator.enumerateDevices(function(devices) {\r\n            devices.forEach(function(_device) {\r\n                var device = {};\r\n                for (var d in _device) {\r\n                    try {\r\n                        if (typeof _device[d] !== 'function') {\r\n                            device[d] = _device[d];\r\n                        }\r\n                    } catch (e) {}\r\n                }\r\n\r\n                if (alreadyUsedDevices[device.deviceId + device.label + device.kind]) {\r\n                    return;\r\n                }\r\n\r\n                // if it is MediaStreamTrack.getSources\r\n                if (device.kind === 'audio') {\r\n                    device.kind = 'audioinput';\r\n                }\r\n\r\n                if (device.kind === 'video') {\r\n                    device.kind = 'videoinput';\r\n                }\r\n\r\n                if (!device.deviceId) {\r\n                    device.deviceId = device.id;\r\n                }\r\n\r\n                if (!device.id) {\r\n                    device.id = device.deviceId;\r\n                }\r\n\r\n                if (!device.label) {\r\n                    device.isCustomLabel = true;\r\n\r\n                    if (device.kind === 'videoinput') {\r\n                        device.label = 'Camera ' + (videoInputDevices.length + 1);\r\n                    } else if (device.kind === 'audioinput') {\r\n                        device.label = 'Microphone ' + (audioInputDevices.length + 1);\r\n                    } else if (device.kind === 'audiooutput') {\r\n                        device.label = 'Speaker ' + (audioOutputDevices.length + 1);\r\n                    } else {\r\n                        device.label = 'Please invoke getUserMedia once.';\r\n                    }\r\n\r\n                    if (typeof DetectRTC !== 'undefined' && DetectRTC.browser.isChrome && DetectRTC.browser.version >= 46 && !/^(https:|chrome-extension:)$/g.test(location.protocol || '')) {\r\n                        if (typeof document !== 'undefined' && typeof document.domain === 'string' && document.domain.search && document.domain.search(/localhost|127.0./g) === -1) {\r\n                            device.label = 'HTTPs is required to get label of this ' + device.kind + ' device.';\r\n                        }\r\n                    }\r\n                } else {\r\n                    // Firefox on Android still returns empty label\r\n                    if (device.kind === 'videoinput' && !isWebsiteHasWebcamPermissions) {\r\n                        isWebsiteHasWebcamPermissions = true;\r\n                    }\r\n\r\n                    if (device.kind === 'audioinput' && !isWebsiteHasMicrophonePermissions) {\r\n                        isWebsiteHasMicrophonePermissions = true;\r\n                    }\r\n                }\r\n\r\n                if (device.kind === 'audioinput') {\r\n                    hasMicrophone = true;\r\n\r\n                    if (audioInputDevices.indexOf(device) === -1) {\r\n                        audioInputDevices.push(device);\r\n                    }\r\n                }\r\n\r\n                if (device.kind === 'audiooutput') {\r\n                    hasSpeakers = true;\r\n\r\n                    if (audioOutputDevices.indexOf(device) === -1) {\r\n                        audioOutputDevices.push(device);\r\n                    }\r\n                }\r\n\r\n                if (device.kind === 'videoinput') {\r\n                    hasWebcam = true;\r\n\r\n                    if (videoInputDevices.indexOf(device) === -1) {\r\n                        videoInputDevices.push(device);\r\n                    }\r\n                }\r\n\r\n                // there is no 'videoouput' in the spec.\r\n                MediaDevices.push(device);\r\n\r\n                alreadyUsedDevices[device.deviceId + device.label + device.kind] = device;\r\n            });\r\n\r\n            if (typeof DetectRTC !== 'undefined') {\r\n                // to sync latest outputs\r\n                DetectRTC.MediaDevices = MediaDevices;\r\n                DetectRTC.hasMicrophone = hasMicrophone;\r\n                DetectRTC.hasSpeakers = hasSpeakers;\r\n                DetectRTC.hasWebcam = hasWebcam;\r\n\r\n                DetectRTC.isWebsiteHasWebcamPermissions = isWebsiteHasWebcamPermissions;\r\n                DetectRTC.isWebsiteHasMicrophonePermissions = isWebsiteHasMicrophonePermissions;\r\n\r\n                DetectRTC.audioInputDevices = audioInputDevices;\r\n                DetectRTC.audioOutputDevices = audioOutputDevices;\r\n                DetectRTC.videoInputDevices = videoInputDevices;\r\n            }\r\n\r\n            if (callback) {\r\n                callback();\r\n            }\r\n        });\r\n    }\r\n\r\n    var DetectRTC = window.DetectRTC || {};\r\n\r\n    // ----------\r\n    // DetectRTC.browser.name || DetectRTC.browser.version || DetectRTC.browser.fullVersion\r\n    DetectRTC.browser = getBrowserInfo();\r\n\r\n    detectPrivateMode(function(isPrivateBrowsing) {\r\n        DetectRTC.browser.isPrivateBrowsing = !!isPrivateBrowsing;\r\n    });\r\n\r\n    // DetectRTC.isChrome || DetectRTC.isFirefox || DetectRTC.isEdge\r\n    DetectRTC.browser['is' + DetectRTC.browser.name] = true;\r\n\r\n    // -----------\r\n    DetectRTC.osName = osName;\r\n    DetectRTC.osVersion = osVersion;\r\n\r\n    var isNodeWebkit = typeof process === 'object' && typeof process.versions === 'object' && process.versions['node-webkit'];\r\n\r\n    // --------- Detect if system supports WebRTC 1.0 or WebRTC 1.1.\r\n    var isWebRTCSupported = false;\r\n    ['RTCPeerConnection', 'webkitRTCPeerConnection', 'mozRTCPeerConnection', 'RTCIceGatherer'].forEach(function(item) {\r\n        if (isWebRTCSupported) {\r\n            return;\r\n        }\r\n\r\n        if (item in window) {\r\n            isWebRTCSupported = true;\r\n        }\r\n    });\r\n    DetectRTC.isWebRTCSupported = isWebRTCSupported;\r\n\r\n    //-------\r\n    DetectRTC.isORTCSupported = typeof RTCIceGatherer !== 'undefined';\r\n\r\n    // --------- Detect if system supports screen capturing API\r\n    var isScreenCapturingSupported = false;\r\n    if (DetectRTC.browser.isChrome && DetectRTC.browser.version >= 35) {\r\n        isScreenCapturingSupported = true;\r\n    } else if (DetectRTC.browser.isFirefox && DetectRTC.browser.version >= 34) {\r\n        isScreenCapturingSupported = true;\r\n    } else if (DetectRTC.browser.isEdge && DetectRTC.browser.version >= 17) {\r\n        isScreenCapturingSupported = true; // navigator.getDisplayMedia\r\n    } else if (DetectRTC.osName === 'Android' && DetectRTC.browser.isChrome) {\r\n        isScreenCapturingSupported = true;\r\n    }\r\n\r\n    if (!/^(https:|chrome-extension:)$/g.test(location.protocol || '')) {\r\n        var isNonLocalHost = typeof document !== 'undefined' && typeof document.domain === 'string' && document.domain.search && document.domain.search(/localhost|127.0./g) === -1;\r\n        if (isNonLocalHost && (DetectRTC.browser.isChrome || DetectRTC.browser.isEdge || DetectRTC.browser.isOpera)) {\r\n            isScreenCapturingSupported = false;\r\n        } else if (DetectRTC.browser.isFirefox) {\r\n            isScreenCapturingSupported = false;\r\n        }\r\n    }\r\n    DetectRTC.isScreenCapturingSupported = isScreenCapturingSupported;\r\n\r\n    // --------- Detect if WebAudio API are supported\r\n    var webAudio = {\r\n        isSupported: false,\r\n        isCreateMediaStreamSourceSupported: false\r\n    };\r\n\r\n    ['AudioContext', 'webkitAudioContext', 'mozAudioContext', 'msAudioContext'].forEach(function(item) {\r\n        if (webAudio.isSupported) {\r\n            return;\r\n        }\r\n\r\n        if (item in window) {\r\n            webAudio.isSupported = true;\r\n\r\n            if (window[item] && 'createMediaStreamSource' in window[item].prototype) {\r\n                webAudio.isCreateMediaStreamSourceSupported = true;\r\n            }\r\n        }\r\n    });\r\n    DetectRTC.isAudioContextSupported = webAudio.isSupported;\r\n    DetectRTC.isCreateMediaStreamSourceSupported = webAudio.isCreateMediaStreamSourceSupported;\r\n\r\n    // ---------- Detect if SCTP/RTP channels are supported.\r\n\r\n    var isRtpDataChannelsSupported = false;\r\n    if (DetectRTC.browser.isChrome && DetectRTC.browser.version > 31) {\r\n        isRtpDataChannelsSupported = true;\r\n    }\r\n    DetectRTC.isRtpDataChannelsSupported = isRtpDataChannelsSupported;\r\n\r\n    var isSCTPSupportd = false;\r\n    if (DetectRTC.browser.isFirefox && DetectRTC.browser.version > 28) {\r\n        isSCTPSupportd = true;\r\n    } else if (DetectRTC.browser.isChrome && DetectRTC.browser.version > 25) {\r\n        isSCTPSupportd = true;\r\n    } else if (DetectRTC.browser.isOpera && DetectRTC.browser.version >= 11) {\r\n        isSCTPSupportd = true;\r\n    }\r\n    DetectRTC.isSctpDataChannelsSupported = isSCTPSupportd;\r\n\r\n    // ---------\r\n\r\n    DetectRTC.isMobileDevice = isMobileDevice; // \"isMobileDevice\" boolean is defined in \"getBrowserInfo.js\"\r\n\r\n    // ------\r\n    var isGetUserMediaSupported = false;\r\n    if (navigator.getUserMedia) {\r\n        isGetUserMediaSupported = true;\r\n    } else if (navigator.mediaDevices && navigator.mediaDevices.getUserMedia) {\r\n        isGetUserMediaSupported = true;\r\n    }\r\n\r\n    if (DetectRTC.browser.isChrome && DetectRTC.browser.version >= 46 && !/^(https:|chrome-extension:)$/g.test(location.protocol || '')) {\r\n        if (typeof document !== 'undefined' && typeof document.domain === 'string' && document.domain.search && document.domain.search(/localhost|127.0./g) === -1) {\r\n            isGetUserMediaSupported = 'Requires HTTPs';\r\n        }\r\n    }\r\n\r\n    if (DetectRTC.osName === 'Nodejs') {\r\n        isGetUserMediaSupported = false;\r\n    }\r\n    DetectRTC.isGetUserMediaSupported = isGetUserMediaSupported;\r\n\r\n    var displayResolution = '';\r\n    if (screen.width) {\r\n        var width = (screen.width) ? screen.width : '';\r\n        var height = (screen.height) ? screen.height : '';\r\n        displayResolution += '' + width + ' x ' + height;\r\n    }\r\n    DetectRTC.displayResolution = displayResolution;\r\n\r\n    function getAspectRatio(w, h) {\r\n        function gcd(a, b) {\r\n            return (b == 0) ? a : gcd(b, a % b);\r\n        }\r\n        var r = gcd(w, h);\r\n        return (w / r) / (h / r);\r\n    }\r\n\r\n    DetectRTC.displayAspectRatio = getAspectRatio(screen.width, screen.height).toFixed(2);\r\n\r\n    // ----------\r\n    DetectRTC.isCanvasSupportsStreamCapturing = isCanvasSupportsStreamCapturing;\r\n    DetectRTC.isVideoSupportsStreamCapturing = isVideoSupportsStreamCapturing;\r\n\r\n    if (DetectRTC.browser.name == 'Chrome' && DetectRTC.browser.version >= 53) {\r\n        if (!DetectRTC.isCanvasSupportsStreamCapturing) {\r\n            DetectRTC.isCanvasSupportsStreamCapturing = 'Requires chrome flag: enable-experimental-web-platform-features';\r\n        }\r\n\r\n        if (!DetectRTC.isVideoSupportsStreamCapturing) {\r\n            DetectRTC.isVideoSupportsStreamCapturing = 'Requires chrome flag: enable-experimental-web-platform-features';\r\n        }\r\n    }\r\n\r\n    // ------\r\n    DetectRTC.DetectLocalIPAddress = DetectLocalIPAddress;\r\n\r\n    DetectRTC.isWebSocketsSupported = 'WebSocket' in window && 2 === window.WebSocket.CLOSING;\r\n    DetectRTC.isWebSocketsBlocked = !DetectRTC.isWebSocketsSupported;\r\n\r\n    if (DetectRTC.osName === 'Nodejs') {\r\n        DetectRTC.isWebSocketsSupported = true;\r\n        DetectRTC.isWebSocketsBlocked = false;\r\n    }\r\n\r\n    DetectRTC.checkWebSocketsSupport = function(callback) {\r\n        callback = callback || function() {};\r\n        try {\r\n            var starttime;\r\n            var websocket = new WebSocket('wss://echo.websocket.org:443/');\r\n            websocket.onopen = function() {\r\n                DetectRTC.isWebSocketsBlocked = false;\r\n                starttime = (new Date).getTime();\r\n                websocket.send('ping');\r\n            };\r\n            websocket.onmessage = function() {\r\n                DetectRTC.WebsocketLatency = (new Date).getTime() - starttime + 'ms';\r\n                callback();\r\n                websocket.close();\r\n                websocket = null;\r\n            };\r\n            websocket.onerror = function() {\r\n                DetectRTC.isWebSocketsBlocked = true;\r\n                callback();\r\n            };\r\n        } catch (e) {\r\n            DetectRTC.isWebSocketsBlocked = true;\r\n            callback();\r\n        }\r\n    };\r\n\r\n    // -------\r\n    DetectRTC.load = function(callback) {\r\n        callback = callback || function() {};\r\n        checkDeviceSupport(callback);\r\n    };\r\n\r\n    // check for microphone/camera support!\r\n    if (typeof checkDeviceSupport === 'function') {\r\n        // checkDeviceSupport();\r\n    }\r\n\r\n    if (typeof MediaDevices !== 'undefined') {\r\n        DetectRTC.MediaDevices = MediaDevices;\r\n    } else {\r\n        DetectRTC.MediaDevices = [];\r\n    }\r\n\r\n    DetectRTC.hasMicrophone = hasMicrophone;\r\n    DetectRTC.hasSpeakers = hasSpeakers;\r\n    DetectRTC.hasWebcam = hasWebcam;\r\n\r\n    DetectRTC.isWebsiteHasWebcamPermissions = isWebsiteHasWebcamPermissions;\r\n    DetectRTC.isWebsiteHasMicrophonePermissions = isWebsiteHasMicrophonePermissions;\r\n\r\n    DetectRTC.audioInputDevices = audioInputDevices;\r\n    DetectRTC.audioOutputDevices = audioOutputDevices;\r\n    DetectRTC.videoInputDevices = videoInputDevices;\r\n\r\n    // ------\r\n    var isSetSinkIdSupported = false;\r\n    if (typeof document !== 'undefined' && typeof document.createElement === 'function' && 'setSinkId' in document.createElement('video')) {\r\n        isSetSinkIdSupported = true;\r\n    }\r\n    DetectRTC.isSetSinkIdSupported = isSetSinkIdSupported;\r\n\r\n    // -----\r\n    var isRTPSenderReplaceTracksSupported = false;\r\n    if (DetectRTC.browser.isFirefox && typeof mozRTCPeerConnection !== 'undefined' /*&& DetectRTC.browser.version > 39*/ ) {\r\n        /*global mozRTCPeerConnection:true */\r\n        if ('getSenders' in mozRTCPeerConnection.prototype) {\r\n            isRTPSenderReplaceTracksSupported = true;\r\n        }\r\n    } else if (DetectRTC.browser.isChrome && typeof webkitRTCPeerConnection !== 'undefined') {\r\n        /*global webkitRTCPeerConnection:true */\r\n        if ('getSenders' in webkitRTCPeerConnection.prototype) {\r\n            isRTPSenderReplaceTracksSupported = true;\r\n        }\r\n    }\r\n    DetectRTC.isRTPSenderReplaceTracksSupported = isRTPSenderReplaceTracksSupported;\r\n\r\n    //------\r\n    var isRemoteStreamProcessingSupported = false;\r\n    if (DetectRTC.browser.isFirefox && DetectRTC.browser.version > 38) {\r\n        isRemoteStreamProcessingSupported = true;\r\n    }\r\n    DetectRTC.isRemoteStreamProcessingSupported = isRemoteStreamProcessingSupported;\r\n\r\n    //-------\r\n    var isApplyConstraintsSupported = false;\r\n\r\n    /*global MediaStreamTrack:true */\r\n    if (typeof MediaStreamTrack !== 'undefined' && 'applyConstraints' in MediaStreamTrack.prototype) {\r\n        isApplyConstraintsSupported = true;\r\n    }\r\n    DetectRTC.isApplyConstraintsSupported = isApplyConstraintsSupported;\r\n\r\n    //-------\r\n    var isMultiMonitorScreenCapturingSupported = false;\r\n    if (DetectRTC.browser.isFirefox && DetectRTC.browser.version >= 43) {\r\n        // version 43 merely supports platforms for multi-monitors\r\n        // version 44 will support exact multi-monitor selection i.e. you can select any monitor for screen capturing.\r\n        isMultiMonitorScreenCapturingSupported = true;\r\n    }\r\n    DetectRTC.isMultiMonitorScreenCapturingSupported = isMultiMonitorScreenCapturingSupported;\r\n\r\n    DetectRTC.isPromisesSupported = !!('Promise' in window);\r\n\r\n    // version is generated by \"grunt\"\r\n    DetectRTC.version = '1.3.9';\r\n\r\n    if (typeof DetectRTC === 'undefined') {\r\n        window.DetectRTC = {};\r\n    }\r\n\r\n    var MediaStream = window.MediaStream;\r\n\r\n    if (typeof MediaStream === 'undefined' && typeof webkitMediaStream !== 'undefined') {\r\n        MediaStream = webkitMediaStream;\r\n    }\r\n\r\n    if (typeof MediaStream !== 'undefined' && typeof MediaStream === 'function') {\r\n        DetectRTC.MediaStream = Object.keys(MediaStream.prototype);\r\n    } else DetectRTC.MediaStream = false;\r\n\r\n    if (typeof MediaStreamTrack !== 'undefined') {\r\n        DetectRTC.MediaStreamTrack = Object.keys(MediaStreamTrack.prototype);\r\n    } else DetectRTC.MediaStreamTrack = false;\r\n\r\n    var RTCPeerConnection = window.RTCPeerConnection || window.mozRTCPeerConnection || window.webkitRTCPeerConnection;\r\n\r\n    if (typeof RTCPeerConnection !== 'undefined') {\r\n        DetectRTC.RTCPeerConnection = Object.keys(RTCPeerConnection.prototype);\r\n    } else DetectRTC.RTCPeerConnection = false;\r\n\r\n    window.DetectRTC = DetectRTC;\r\n\r\n    if (typeof module !== 'undefined' /* && !!module.exports*/ ) {\r\n        module.exports = DetectRTC;\r\n    }\r\n\r\n    if (typeof define === 'function' && define.amd) {\r\n        define('DetectRTC', [], function() {\r\n            return DetectRTC;\r\n        });\r\n    }\r\n})();\n","// shim for using process in browser\nvar process = module.exports = {};\n\n// cached from whatever global is present so that test runners that stub it\n// don't break things.  But we need to wrap it in a try catch in case it is\n// wrapped in strict mode code which doesn't define any globals.  It's inside a\n// function because try/catches deoptimize in certain engines.\n\nvar cachedSetTimeout;\nvar cachedClearTimeout;\n\nfunction defaultSetTimout() {\n    throw new Error('setTimeout has not been defined');\n}\nfunction defaultClearTimeout () {\n    throw new Error('clearTimeout has not been defined');\n}\n(function () {\n    try {\n        if (typeof setTimeout === 'function') {\n            cachedSetTimeout = setTimeout;\n        } else {\n            cachedSetTimeout = defaultSetTimout;\n        }\n    } catch (e) {\n        cachedSetTimeout = defaultSetTimout;\n    }\n    try {\n        if (typeof clearTimeout === 'function') {\n            cachedClearTimeout = clearTimeout;\n        } else {\n            cachedClearTimeout = defaultClearTimeout;\n        }\n    } catch (e) {\n        cachedClearTimeout = defaultClearTimeout;\n    }\n} ())\nfunction runTimeout(fun) {\n    if (cachedSetTimeout === setTimeout) {\n        //normal enviroments in sane situations\n        return setTimeout(fun, 0);\n    }\n    // if setTimeout wasn't available but was latter defined\n    if ((cachedSetTimeout === defaultSetTimout || !cachedSetTimeout) && setTimeout) {\n        cachedSetTimeout = setTimeout;\n        return setTimeout(fun, 0);\n    }\n    try {\n        // when when somebody has screwed with setTimeout but no I.E. maddness\n        return cachedSetTimeout(fun, 0);\n    } catch(e){\n        try {\n            // When we are in I.E. but the script has been evaled so I.E. doesn't trust the global object when called normally\n            return cachedSetTimeout.call(null, fun, 0);\n        } catch(e){\n            // same as above but when it's a version of I.E. that must have the global object for 'this', hopfully our context correct otherwise it will throw a global error\n            return cachedSetTimeout.call(this, fun, 0);\n        }\n    }\n\n\n}\nfunction runClearTimeout(marker) {\n    if (cachedClearTimeout === clearTimeout) {\n        //normal enviroments in sane situations\n        return clearTimeout(marker);\n    }\n    // if clearTimeout wasn't available but was latter defined\n    if ((cachedClearTimeout === defaultClearTimeout || !cachedClearTimeout) && clearTimeout) {\n        cachedClearTimeout = clearTimeout;\n        return clearTimeout(marker);\n    }\n    try {\n        // when when somebody has screwed with setTimeout but no I.E. maddness\n        return cachedClearTimeout(marker);\n    } catch (e){\n        try {\n            // When we are in I.E. but the script has been evaled so I.E. doesn't  trust the global object when called normally\n            return cachedClearTimeout.call(null, marker);\n        } catch (e){\n            // same as above but when it's a version of I.E. that must have the global object for 'this', hopfully our context correct otherwise it will throw a global error.\n            // Some versions of I.E. have different rules for clearTimeout vs setTimeout\n            return cachedClearTimeout.call(this, marker);\n        }\n    }\n\n\n\n}\nvar queue = [];\nvar draining = false;\nvar currentQueue;\nvar queueIndex = -1;\n\nfunction cleanUpNextTick() {\n    if (!draining || !currentQueue) {\n        return;\n    }\n    draining = false;\n    if (currentQueue.length) {\n        queue = currentQueue.concat(queue);\n    } else {\n        queueIndex = -1;\n    }\n    if (queue.length) {\n        drainQueue();\n    }\n}\n\nfunction drainQueue() {\n    if (draining) {\n        return;\n    }\n    var timeout = runTimeout(cleanUpNextTick);\n    draining = true;\n\n    var len = queue.length;\n    while(len) {\n        currentQueue = queue;\n        queue = [];\n        while (++queueIndex < len) {\n            if (currentQueue) {\n                currentQueue[queueIndex].run();\n            }\n        }\n        queueIndex = -1;\n        len = queue.length;\n    }\n    currentQueue = null;\n    draining = false;\n    runClearTimeout(timeout);\n}\n\nprocess.nextTick = function (fun) {\n    var args = new Array(arguments.length - 1);\n    if (arguments.length > 1) {\n        for (var i = 1; i < arguments.length; i++) {\n            args[i - 1] = arguments[i];\n        }\n    }\n    queue.push(new Item(fun, args));\n    if (queue.length === 1 && !draining) {\n        runTimeout(drainQueue);\n    }\n};\n\n// v8 likes predictible objects\nfunction Item(fun, array) {\n    this.fun = fun;\n    this.array = array;\n}\nItem.prototype.run = function () {\n    this.fun.apply(null, this.array);\n};\nprocess.title = 'browser';\nprocess.browser = true;\nprocess.env = {};\nprocess.argv = [];\nprocess.version = ''; // empty string to avoid regexp issues\nprocess.versions = {};\n\nfunction noop() {}\n\nprocess.on = noop;\nprocess.addListener = noop;\nprocess.once = noop;\nprocess.off = noop;\nprocess.removeListener = noop;\nprocess.removeAllListeners = noop;\nprocess.emit = noop;\nprocess.prependListener = noop;\nprocess.prependOnceListener = noop;\n\nprocess.listeners = function (name) { return [] }\n\nprocess.binding = function (name) {\n    throw new Error('process.binding is not supported');\n};\n\nprocess.cwd = function () { return '/' };\nprocess.chdir = function (dir) {\n    throw new Error('process.chdir is not supported');\n};\nprocess.umask = function() { return 0; };\n"],"sourceRoot":""}